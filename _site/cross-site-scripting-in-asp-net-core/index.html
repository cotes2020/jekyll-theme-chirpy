<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cross Site Scripting (XSS) in ASP .NET Core | Programming With Wolfgang</title><meta name="generator" content="Jekyll v4.1.0" /><meta property="og:title" content="Cross Site Scripting (XSS) in ASP .NET Core" /><meta name="author" content="Wolfgang Ofner" /><meta property="og:locale" content="en_US" /><meta name="description" content="Cross Site Scripting (XSS) is an attack where attackers inject code into a website which is then executed. XSS is on place seven of the OWASP Top 10 list of 2017 but could be easily avoided. In this post, I will talk about the concepts of cross site scripting and how you can protect your application against these attacks." /><meta property="og:description" content="Cross Site Scripting (XSS) is an attack where attackers inject code into a website which is then executed. XSS is on place seven of the OWASP Top 10 list of 2017 but could be easily avoided. In this post, I will talk about the concepts of cross site scripting and how you can protect your application against these attacks." /><link rel="canonical" href="http://0.0.0.0:4000/cross-site-scripting-in-asp-net-core/" /><meta property="og:url" content="http://0.0.0.0:4000/cross-site-scripting-in-asp-net-core/" /><meta property="og:site_name" content="Programming With Wolfgang" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-06-17T09:42:15+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Cross Site Scripting (XSS) in ASP .NET Core" /><meta name="twitter:site" content="@wolfgang_ofner" /><meta name="twitter:creator" content="@Wolfgang Ofner" /><meta name="google-site-verification" content="xxsPm-h6A0B6a0QMgqXO80PU4DbMt4Dq06p-SGzB3TU" /> <script type="application/ld+json"> {"url":"http://0.0.0.0:4000/cross-site-scripting-in-asp-net-core/","@type":"BlogPosting","headline":"Cross Site Scripting (XSS) in ASP .NET Core","dateModified":"2020-06-17T09:42:15+02:00","datePublished":"2020-06-17T09:42:15+02:00","author":{"@type":"Person","name":"Wolfgang Ofner"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/cross-site-scripting-in-asp-net-core/"},"description":"Cross Site Scripting (XSS) is an attack where attackers inject code into a website which is then executed. XSS is on place seven of the OWASP Top 10 list of 2017 but could be easily avoided. In this post, I will talk about the concepts of cross site scripting and how you can protect your application against these attacks.","@context":"https://schema.org"}</script><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <script src="/assets/js/post.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/author/wolfgang-small.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Programming With Wolfgang</a></div><div class="site-subtitle font-italic">Let's talk programming</div></div></div><div class="d-flex justify-content-center"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span></div><ul class="nav flex-column mt-3"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/wolfgangofner" target="_blank" > <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/wolfgang_ofner" target="_blank" > <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/wolfgangofner" target="_blank" > <i class="fab fa-linkedin"></i> </a> <a href=" javascript:window.open('mailto:' + ['wolfgang','programmingwithwolfgang.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="d-sm-none row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Cross Site Scripting (XSS) in ASP .NET Core</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><div style="visibility:hidden;"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel">Cancel</span></div></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Cross Site Scripting (XSS) in ASP .NET Core</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Jun 17, 2020, 9:42 AM +0200" > Jun 17 <i class="unloaded">2020-06-17T09:42:15+02:00</i> </span> by <span class="author"> Wolfgang Ofner </span></div></div><div class="post-content"><p>Cross Site Scripting (XSS) is an attack where attackers inject code into a website which is then executed. XSS is on place seven of the <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/" target="_blank" rel="noopener noreferrer">OWASP Top 10 list of 2017</a> but could be easily avoided. In this post, I will talk about the concepts of cross site scripting and how you can protect your application against these attacks.</p><h2 id="what-is-cross-site-scripting">What is Cross Site Scripting</h2><p>Cross site scripting is the injection of malicious code in a web application, usually, Javascript but could also be CSS or HTML. When attackers manage to inject code into your web application, this code often gets also saved in a database. This means every user could be affected by this. For example, if an attacker manages to inject Javascript into the product name on Amazon. Every user who opens the infected product would load the malicious code.</p><h2 id="consequences-of-xss-attacks">Consequences of XSS Attacks</h2><p>There are many possible consequences for your users if your website got attacked by cross site scripting:</p><ul><li>Attackers could read your cookies and therefore gain access to your private accounts like social media or bank<li>Users may be redirected to malicious sites<li>Attackers could modify the layout of the website to lure users into unintentional actions<li>Users could be annoyed which will lead to damage to your reputation and probably a loss of revenue<li>Often used in combination with other attacks like <a href="https://www.programmingwithwolfgang.com/cross-site-request-forgery-csrf-in-asp-net-core/">cross site request forgery (CSRF)</a></ul><h2 id="best-practices-against-cross-site-scripting-attacks">Best Practices against Cross Site Scripting Attacks</h2><p>Preventing XSS attacks is pretty simple if you follow these best practices:</p><ul><li>Validate every user input, either reject or sanitize unknown character, for example, &lt; or &gt; which can be used to create <script> tags</script><li>Test every input from an external source<li>Use HttpOnly for cookies so it is not readable by Javascript (therefore an attacker can’t use Javascript to read your cookies)<li>Use markdown instead of HTML editors</ul><h2 id="cross-site-scripting-in-asp-net-core">Cross Site Scripting in ASP .NET Core</h2><p>ASP .NET Core Is already pretty safe out of the box due to automatically encoding HTML, for example &lt; gets encoded into &amp;lt. Let’s have a look at two examples where XSS attacks can happen and how to prevent them. You can find the code for the demo on <a href="https://github.com/WolfgangOfner/MVC-XssDemo" target="_blank" rel="noopener noreferrer">Github</a>.</p><h3 id="asp-net-core-31-demo">ASP .NET Core 3.1 Demo</h3><p>XSS can occur when you display text which a user entered. ASP .NET Core automatically encodes text when you use @Model, but displays the code as it if if you use @Html.Raw.</p><h4 id="preventing-xss-attacks-in-forms">Preventing XSS Attacks in forms</h4><p>The following code creates a form where the user can enter his user name. The input is displayed once in a safe way and once in an unsafe way.</p><div class="language-csharp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="n">@model</span> <span class="n">Customer</span>

<span class="p">&lt;</span><span class="n">div</span> <span class="n">asp</span><span class="p">-</span><span class="n">validation</span><span class="p">-</span><span class="n">summary</span><span class="p">=</span><span class="s">"All"</span><span class="p">&gt;&lt;/</span><span class="n">div</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="n">form</span> <span class="n">asp</span><span class="p">-</span><span class="n">action</span><span class="p">=</span><span class="s">"Index"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="err">="</span><span class="nc">form</span><span class="p">-</span><span class="k">group</span><span class="s">"&gt;
</span>        <span class="p">&lt;</span><span class="n">label</span> <span class="n">asp</span><span class="p">-</span><span class="k">for</span><span class="p">=</span><span class="s">"UserName"</span><span class="p">&gt;</span><span class="n">Please</span> <span class="n">enter</span> <span class="n">your</span> <span class="n">user</span> <span class="n">name</span><span class="p">&lt;/</span><span class="n">label</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="p">=</span><span class="s">"text"</span> <span class="k">class</span><span class="err">="</span><span class="nc">form</span><span class="p">-</span><span class="n">control</span><span class="s">" asp-for="</span><span class="n">UserName</span><span class="s">" value="</span><span class="n">User</span><span class="s">"&gt;
</span>    <span class="p">&lt;/</span><span class="n">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">button</span> <span class="n">type</span><span class="p">=</span><span class="s">"submit"</span> <span class="k">class</span><span class="err">="</span><span class="nc">mt</span><span class="p">-</span><span class="n">md</span><span class="p">-</span><span class="m">1</span> <span class="n">btn</span> <span class="n">btn</span><span class="p">-</span><span class="n">primary</span><span class="s">"&gt;Submit&lt;/button&gt;
</span><span class="p">&lt;/</span><span class="n">form</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>

<span class="nf">@if</span> <span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">Model</span><span class="p">.</span><span class="n">UserName</span><span class="p">))</span>
<span class="p">{</span>
    <span class="p">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="err">="</span><span class="nc">row</span><span class="s">"&gt;
</span>        <span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="n">Safe</span> <span class="n">output</span><span class="p">:</span> <span class="err">@</span><span class="p">(</span><span class="n">Model</span><span class="p">.</span><span class="n">UserName</span><span class="p">)&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="n">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="err">="</span><span class="nc">row</span><span class="s">"&gt;
</span>        <span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="n">Unsafe</span> <span class="n">output</span><span class="p">:</span> <span class="n">@Html</span><span class="p">.</span><span class="nf">Raw</span><span class="p">(</span><span class="n">Model</span><span class="p">.</span><span class="n">UserName</span><span class="p">)&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="n">div</span><span class="p">&gt;</span>
<span class="p">}</span>  
</pre></table></code></div></div><p>When a user enters his user name everything is fine. But when an attacker enters Javascript, the Javascript will be executed when the text is rendered inside the unsafe output</p><p>tag. When you enter the following code as your name:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="nx">attacked</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;)</span><span class="o">&lt;</span><span class="sr">/script&gt; </span><span class="err"> 
</span></pre></table></code></div></div><p>and click submit, an alert windows will be displayed.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/06/The-injected-code-got-executed.jpg"><img loading="lazy" src="/assets/img/posts/2020/06/The-injected-code-got-executed.jpg" alt="The injected code got executed causing Cross Site Scripting" /></a><p> The injected code got executed</p></div><p>When you click on OK, the text will be rendered into the safe output line and nothing will be displayed in the unsafe output line because the browser interprets the Javascript.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/06/The-Javascript-is-displayed-as-text-in-the-safe-output-line.jpg"><img loading="lazy" src="/assets/img/posts/2020/06/The-Javascript-is-displayed-as-text-in-the-safe-output-line.jpg" alt="The Javascript is displayed as text in the safe output line, no Cross Site Scripting possible" /></a><p> The Javascript is displayed as text in the safe output line</p></div><h4 id="preventing-xss-attacks-in-query-parameters">Preventing XSS Attacks in Query Parameters</h4><p>Another way to inject code is through query parameters. If your application ready query parameters but doesn’t sanitize them, Javascript in it will be executed. The following code contains two forms. When you click on the button a query parameter will be read and printed to an alert box.</p><div class="language-csharp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="n">@using</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encodings</span><span class="p">.</span><span class="n">Web</span>

<span class="n">@model</span> <span class="n">Customer</span>
<span class="n">@inject</span> <span class="n">JavaScriptEncoder</span> <span class="n">JavaScriptEncoder</span>

<span class="p">&lt;</span><span class="n">h2</span><span class="p">&gt;</span><span class="n">Unsafe</span> <span class="n">Javascript</span><span class="p">&lt;/</span><span class="n">h2</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">form</span> <span class="n">asp</span><span class="p">-</span><span class="n">action</span><span class="p">=</span><span class="s">"JavascriptAttack"</span><span class="p">&gt;</span>
    <span class="n">@Html</span><span class="p">.</span><span class="nf">HiddenFor</span><span class="p">(</span><span class="n">m</span> <span class="p">=&gt;</span> <span class="n">m</span><span class="p">.</span><span class="n">UserId</span><span class="p">)</span>
    <span class="p">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="err">="</span><span class="nc">form</span><span class="p">-</span><span class="k">group</span><span class="s">"&gt;
</span>        <span class="p">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="p">=</span><span class="s">"userName"</span><span class="p">&gt;</span><span class="n">Please</span> <span class="n">enter</span> <span class="n">your</span> <span class="n">user</span> <span class="n">id</span><span class="p">&lt;/</span><span class="n">label</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="p">=</span><span class="s">"text"</span> <span class="k">class</span><span class="err">="</span><span class="nc">form</span><span class="p">-</span><span class="n">control</span><span class="s">" id="</span><span class="n">userName</span><span class="s">" name="</span><span class="n">userName</span><span class="s">" value="</span><span class="n">User</span><span class="s">"&gt;
</span>    <span class="p">&lt;/</span><span class="n">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">button</span> <span class="n">type</span><span class="p">=</span><span class="s">"submit"</span> <span class="k">class</span><span class="err">="</span><span class="nc">mt</span><span class="p">-</span><span class="n">md</span><span class="p">-</span><span class="m">1</span> <span class="n">btn</span> <span class="n">btn</span><span class="p">-</span><span class="n">primary</span><span class="s">" onclick="</span><span class="nf">alert</span><span class="p">(</span><span class="err">'</span><span class="n">Saving</span> <span class="n">user</span> <span class="n">name</span> <span class="k">for</span> <span class="n">account</span> <span class="n">with</span> <span class="n">id</span><span class="p">:</span> <span class="n">@Context</span><span class="p">.</span><span class="n">Request</span><span class="p">.</span><span class="n">Query</span><span class="p">[</span><span class="s">"userId"</span><span class="p">]</span><span class="err">'</span><span class="p">);</span><span class="s">"&gt;Submit&lt;/button&gt;
</span><span class="p">&lt;/</span><span class="n">form</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>
<span class="p">&lt;</span><span class="n">h2</span><span class="p">&gt;</span><span class="n">Safe</span> <span class="n">Javascript</span><span class="p">&lt;/</span><span class="n">h2</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">form</span> <span class="n">asp</span><span class="p">-</span><span class="n">action</span><span class="p">=</span><span class="s">"JavascriptAttack"</span><span class="p">&gt;</span>
    <span class="n">@Html</span><span class="p">.</span><span class="nf">HiddenFor</span><span class="p">(</span><span class="n">m</span> <span class="p">=&gt;</span> <span class="n">m</span><span class="p">.</span><span class="n">UserId</span><span class="p">)</span>
    <span class="p">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="err">="</span><span class="nc">form</span><span class="p">-</span><span class="k">group</span><span class="s">"&gt;
</span>        <span class="p">&lt;</span><span class="n">label</span> <span class="k">for</span><span class="p">=</span><span class="s">"userName2"</span><span class="p">&gt;</span><span class="n">Please</span> <span class="n">enter</span> <span class="n">your</span> <span class="n">user</span> <span class="n">id</span><span class="p">&lt;/</span><span class="n">label</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="p">=</span><span class="s">"text"</span> <span class="k">class</span><span class="err">="</span><span class="nc">form</span><span class="p">-</span><span class="n">control</span><span class="s">" id="</span><span class="n">userName2</span><span class="s">" name="</span><span class="n">userName2</span><span class="s">" value="</span><span class="n">User</span><span class="s">"&gt;
</span>    <span class="p">&lt;/</span><span class="n">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">button</span> <span class="n">type</span><span class="p">=</span><span class="s">"submit"</span> <span class="k">class</span><span class="err">="</span><span class="nc">mt</span><span class="p">-</span><span class="n">md</span><span class="p">-</span><span class="m">1</span> <span class="n">btn</span> <span class="n">btn</span><span class="p">-</span><span class="n">primary</span><span class="s">" onclick="</span><span class="nf">alert</span><span class="p">(</span><span class="err">'</span><span class="n">Saving</span> <span class="n">user</span> <span class="n">name</span> <span class="k">for</span> <span class="n">account</span> <span class="n">with</span> <span class="n">id</span><span class="p">:</span> <span class="n">@JavaScriptEncoder</span><span class="p">.</span><span class="nf">Encode</span><span class="p">(</span><span class="n">Context</span><span class="p">.</span><span class="n">Request</span><span class="p">.</span><span class="n">Query</span><span class="p">[</span><span class="s">"UserId"</span><span class="p">])</span><span class="err">'</span><span class="p">);</span><span class="s">"&gt;Submit&lt;/button&gt;
</span><span class="p">&lt;/</span><span class="n">form</span><span class="p">&gt;</span>
</pre></table></code></div></div><p>The first submit button will execute Javascript whereas the second one uses the JavaScriptEncode to encode the text first. To simulate an attack replace the value of the UserId with the following code and click enter:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">%</span><span class="mi">27</span><span class="p">);</span><span class="nx">alert</span><span class="p">(</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="nx">You</span> <span class="nx">got</span> <span class="nx">attacked</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;);</span><span class="c1">//  </span>
</pre></table></code></div></div><p>Click the submit button of the unsafe form and you will see two Javascript alerts. The first one saying “Saving user name for account with id: ” and then a second one saying “You got attacked”.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/06/The-Javascript-got-executed.jpg"><img loading="lazy" src="/assets/img/posts/2020/06/The-Javascript-got-executed.jpg" alt="The Javascript got executed Cross Site Scripting" /></a><p> The Javascript got executed</p></div><p>When you click the submit button of the safe form, you will see the Javascript as text.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/06/The-Javascript-is-displayed-as-text-and-not-executed.jpg"><img loading="lazy" src="/assets/img/posts/2020/06/The-Javascript-is-displayed-as-text-and-not-executed.jpg" alt="The Javascript is displayed as text and not executed and no Cross Site Scripting" /></a><p> The Javascript is displayed as text and not executed</p></div><p>In reality, an attacker wouldn’t display an alert box but try to access your cookies or redirect you to a malicious website.</p><h2 id="conclusion">Conclusion</h2><p>This post showed what cross site scripting attacks are and how they can be executed. ASP .NET Core makes it very easy to prevent these attacks and to offer a great user experience to your users.</p><p>You can find the code for the demo on <a href="https://github.com/WolfgangOfner/MVC-XssDemo" target="_blank" rel="noopener noreferrer">Github</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/asp.net/'>ASP.NET</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/net-core-3.1/" class="post-tag no-text-decoration">NET Core 3.1</a> <a href="/tags/asp.net-core-mvc/" class="post-tag no-text-decoration">ASP.NET Core MVC</a> <a href="/tags/c%23/" class="post-tag no-text-decoration">C#</a> <a href="/tags/javascript/" class="post-tag no-text-decoration">Javascript</a> <a href="/tags/owasp-top-10/" class="post-tag no-text-decoration">OWASP Top 10</a> <a href="/tags/security/" class="post-tag no-text-decoration">Security</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Cross Site Scripting (XSS) in ASP .NET Core - Programming With Wolfgang&url=http://0.0.0.0:4000/cross-site-scripting-in-asp-net-core/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Cross Site Scripting (XSS) in ASP .NET Core - Programming With Wolfgang&u=http://0.0.0.0:4000/cross-site-scripting-in-asp-net-core/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Cross Site Scripting (XSS) in ASP .NET Core - Programming With Wolfgang&url=http://0.0.0.0:4000/cross-site-scripting-in-asp-net-core/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=http://0.0.0.0:4000/cross-site-scripting-in-asp-net-core/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/document-your-microservice-with-swagger/">Document your Microservice with Swagger</a><li><a href="/how-i-learned-programming-part-3/">How I learned programming - Part 3</a></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/xunit/">xUnit</a> <a class="post-tag" href="/tags/mediatr/">MediatR</a> <a class="post-tag" href="/tags/cqrs/">CQRS</a> <a class="post-tag" href="/tags/docker-compose/">docker compose</a> <a class="post-tag" href="/tags/swagger/">Swagger</a> <a class="post-tag" href="/tags/scrum/">Scrum</a> <a class="post-tag" href="/tags/ci/">CI</a> <a class="post-tag" href="/tags/agile/">Agile</a> <a class="post-tag" href="/tags/rabbitmq/">RabbitMQ</a> <a class="post-tag" href="/tags/mvc/">MVC</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/cross-site-request-forgery-csrf-in-asp-net-core/"><div class="card-body"> <span class="timeago small" > Jun 15 <i class="unloaded">2020-06-15T08:42:05+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cross Site Request Forgery (CSRF) in ASP .NET Core</h3><div class="text-muted small"><p> Cross Site Request Forgery, also known as session riding is an exploit where attackers trick users to send requests that they don’t know about and don’t want to do. It was on the OWASP Top 10 every...</p></div></div></a></div><div class="card"> <a href="/set-up-docker-compose-for-asp-net-core-3-1-microservices/"><div class="card-body"> <span class="timeago small" > Apr 24 <i class="unloaded">2020-04-24T11:04:16+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Set up Docker-Compose for ASP .NET Core 3.1 Microservices</h3><div class="text-muted small"><p> In my last post, I described how to dockerize my microservices. To start the whole application, you have to start both microservices and RabbitMq. Today, I will add a docker-compose file which is a...</p></div></div></a></div><div class="card"> <a href="/proxy-pattern-in-net-core/"><div class="card-body"> <span class="timeago small" > Jun 27 <i class="unloaded">2020-06-27T18:25:18+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Proxy Pattern in .NET Core</h3><div class="text-muted small"><p> The proxy pattern belongs to the group of structural patterns and is often used for cross cutting-concerns. Proxies can be used to control access, logging, and security features. Another advantage ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/cross-site-request-forgery-csrf-in-asp-net-core/" class="btn btn-outline-primary"><p>Cross Site Request Forgery (CSRF) in ASP .NET Core</p></a> <a href="/azure-pipelines-task-library-encoding-problem/" class="btn btn-outline-primary"><p>Azure Pipelines Task Library Encoding Problem</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//programmingwithwolfgang.disqus.com/embed.js', disqusConfig: function () { this.page.url = 'http://0.0.0.0:4000/cross-site-scripting-in-asp-net-core/'; this.page.identifier = '/cross-site-scripting-in-asp-net-core/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://twitter.com/wolfgang_ofner">Wolfgang Ofner</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/xunit/">xUnit</a> <a class="post-tag" href="/tags/mediatr/">MediatR</a> <a class="post-tag" href="/tags/cqrs/">CQRS</a> <a class="post-tag" href="/tags/docker-compose/">docker compose</a> <a class="post-tag" href="/tags/swagger/">Swagger</a> <a class="post-tag" href="/tags/scrum/">Scrum</a> <a class="post-tag" href="/tags/ci/">CI</a> <a class="post-tag" href="/tags/agile/">Agile</a> <a class="post-tag" href="/tags/rabbitmq/">RabbitMQ</a> <a class="post-tag" href="/tags/mvc/">MVC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://0.0.0.0:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
