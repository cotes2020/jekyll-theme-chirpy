---
title: μ–Έλ¦¬μ–Ό μ—”μ§„ 5 λ©€ν‹°ν”λ μ΄ κ³µμ‹ λ¬Έμ„ μ½κΈ°
layout: post
author: littley
date: 2023-08-21 00:00:00 +0900
categories: [UnrealEngine, Multiplay]
tags: [UE5]
toc: true
toc_sticky: true
---

## μ–Έλ¦¬μ–Ό λ©€ν‹°ν”λ μ΄ μ„λ²„

μ–Έλ¦¬μ–Ό λ©€ν‹°λ” **ν΄λΌμ΄μ–ΈνΈ-μ„λ²„** λ¨λΈμ„ μ‚¬μ©ν•λ‹¤. ν• μ„λ²„κ°€ κ²μ„μ **νΈμ¤νΈ** μ—­ν• μ„ ν•κ³  νΈμ¤νΈμ— μ—°κ²°λ ν”λ μ΄μ–΄λ” **ν΄λΌμ΄μ–ΈνΈ** μ—­ν• μ„ ν•λ‹¤. μ‹¤μ  κ²μ„ μ¤ν…μ΄νΈλ” μ„λ²„μ—μ„ μ΅°μ •ν•λ©°, μ΄ λ• μ„λ²„λ¥Ό **κ¶ν• μλ” νΈμ¤νΈ(authoritative host)** λΌκ³  ν•λ‹¤. ν”λ μ΄μ–΄λ” **μμ¨ ν”„λ΅μ‹(autonomous proxy)**λ΅ ν°μ„ μ μ–΄ν•λ‹¤. μ„λ²„λ” μ—°κ²°λ κ° ν΄λΌμ΄μ–ΈνΈμ λ³€κ²½μ‚¬ν•­μ„ **λ¦¬ν”λ¦¬μΌ€μ΄νΈ(replicate)** ν•΄μ„ μ—°κ²°λ κ° ν΄λΌμ΄μ–ΈνΈμ μ‹¤μ  κ²μ„ μ¤ν…μ΄νΈλ¥Ό μ‹λ®¬λ μ΄μ… ν•λ‹¤. μ΄λ•, ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ—μ„ μ‹¤μ λ΅ ν”λ μ΄λκ³  μλ” κ²μ„μ— μ•„μ£Ό κ°€κΉμ΄ κ·Όμ‚¬κ°’μ„ λ³΄κ² λλ‹¤.

### λ¦¬μ¨ μ„λ²„μ™€ λ°λ””μΌ€μ΄ν‹°λ“ μ„λ²„

**λ¦¬μ¨ μ„λ²„**λ” μμ‹ μ λ¨Έμ‹ μ—μ„ κ²μ„μ„ νΈμ¤ν…ν•λ©΄μ„ μ„λ²„ μ—­ν• μ„ ν•λ” ν΄λΌμ΄μ–ΈνΈλ‹¤. λ‹¤λ¥Έ ν΄λΌμ΄μ–ΈνΈλ“¤μ€  μ΄ ν΄λΌμ΄μ–ΈνΈμ μΈμ¤ν„΄μ¤μ—μ„ κ²μ„μ„ ν”λ μ΄ν•λ‹¤. νΈμ¤ν…ν•λ” ν΄λΌμ΄μ–ΈνΈ(μ¦‰ λ¦¬μ¨ μ„λ²„)κ°€ κ¶ν• μλ” νΈμ¤νΈκ°€ λλ‹¤. 

λ°λ©΄ **λ°λ””μΌ€μ΄ν‹°μ¤ μ„λ²„(dedicated server)λ”** ν—¤λ“λ¦¬μ¤, μ¦‰ ν”λ μ΄ν•λ” ν΄λΌμ΄μ–ΈνΈκ°€ μ—†λ” ν•νƒλ΅ κµ¬μ„±λλ‹¤. κ° ν”λ μ΄μ–΄λ” μ›κ²© ν΄λΌμ΄μ–ΈνΈλ΅ μ°Έμ—¬ν•λ‹¤. DS μ„λ²„λ” λΉ„μ£Όμ–Όμ„ λ λ”λ§ν•μ§€ μ•κ³ , λ΅μ»¬ ν”λ μ΄μ–΄κ°€ μ΅΄μ¬ν•μ§€ μ•λ”λ‹¤.

ν›„μμ κ²½μ° μ—¬λ¬ μ¥μ μ„ κ°–λ”λ°,

- λ” μ‘μ€ κ·λ¨
- νΈμ¤νΈ ν΄λΌμ΄μ–ΈνΈμ—κ²λ§ μ£Όμ–΄μ§€λ” μ΄μ μ΄ μ—†μ
- μ„λ²„κ°€ κ²μ„ν”λ μ΄ λ΅μ§ λ° ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° λ°›λ” μ •λ³΄λ¥Ό μ΅°μ •ν•λ” λ° μ§‘μ¤‘ν•  μ μμ

μ „μλ” μΊμ£Όμ–Ό λ©€ν‹°ν”λ μ΄μ–΄ λ° ν‘λ™ κ²μ„μ— μ ν•©ν•κ³ , ν›„μλ” λ€κ·λ¨ νΉμ€ κ²½μ κ²μ„μ— μ ν•©ν•λ‹¤.

### μ„λ²„ κ²μ„ν”λ μ΄ νλ¦„

κ²μ„ν”λ μ΄ μƒνƒμ™€ νλ¦„μ€ μΌλ°μ μΌλ΅ `GameMode` μ•΅ν„°λ¥Ό ν†µν•΄ κµ¬λ™λλ‹¤. μ„λ²„μ—λ§ μ΄ μ•΅ν„°μ μ ν¨ μ‚¬λ³Έμ΄ μ €μ¥λλ‹¤(ν΄λΌμ—λ” X). 

μ΄ μƒνƒλ¥Ό ν΄λΌμ΄μ–ΈνΈμ—κ² μ•λ¦¬λ” μ•΅ν„°λ” `GameState`μ΄λ‹¤. `GameState`λ” κ° ν΄λΌμ΄μ–ΈνΈμ—κ² λ¦¬ν”λ¦¬μΌ€μ΄νΈ λλ„λ΅ λ§ν‚Ήλμ–΄ μλ‹¤. ν΄λΌμ΄μ–ΈνΈλ” μ΄ `GameState` μ•΅ν„°μ— λ€ν• μ‚¬λ³Έμ„ μ¶”μ •ν•μ—¬ μ €μ¥ν•κ³ , μ‚¬λ³Έμ„ ν† λ€λ΅ κ²μ„μ μΌλ°μ μΈ μƒνƒλ¥Ό μ•λ‹¤. 

---

## λ¦¬ν”λ¦¬μΌ€μ΄μ…

λ¦¬ν”λ¦¬μΌ€μ΄μ…μ μ£Όμ—­μ€ μ•΅ν„°λ‹¤. μ„λ²„λ” μ•΅ν„° λ©λ΅μ„ μ μ§€ν•κ³ , ν΄λΌμ΄μ–ΈνΈλ“¤μ΄ κ° μ—‘ν„°μ— λ€ν• μ¶”μ •μΉλ¥Ό μ μ§€ν•  μ μλ„λ΅ μ£ΌκΈ°μ μΈ μ—…λ°μ΄νΈλ¥Ό ν•λ‹¤. μ•΅ν„°μ μ—…λ°μ΄νΈ λ°©μ‹μ€ λ‹¤μ λ‘ κ°€μ§€λ‹¤.

- ν”„λ΅νΌν‹° μ—…λ°μ΄νΈ(`UPROPERTY`λ¥Ό μ΄μ©ν• λ¦¬ν”λ¦¬μΌ€μ΄νΈ)
- **RPC(Remote Procedure Call)**

λ‘μ κ°€μ¥ ν° μ°¨μ΄μ μ€ μ „μλ” **λ³€κ²½λ  λ• λ§λ‹¤ μλ™μΌλ΅ λ¦¬ν”λ¦¬μΌ€μ΄νΈ**λλ” λ°λ©΄, ν›„μλ” **μ‹¤ν–‰λ  λ•λ§ λ¦¬ν”λ¦¬μΌ€μ΄νΈ** λλ‹¤λ” κ²ƒμ΄λ‹¤. μ „μμ μ£Όμ” μμ‹λ΅λ” μμ£Ό λ³€ν™”ν•λ” μ”μ†μΈ μ²΄λ ¥μ„ λ“¤ μ μκ³ , ν›„μμ κ²½μ°μ—λ” νΉμ • μ„μΉμ—μ„λ§ νΈμ¶λλ” μ΄ν™νΈ λ“±μ΄ μλ‹¤.

### ν”„λ΅νΌν‹° λ¦¬ν”λ¦¬μΌ€μ΄μ…

κ° μ•΅ν„°μ—λ” `Replicated` μ§€μ •μλ¥Ό ν¬ν•¨ν•λ” λ¨λ“  ν”„λ΅νΌν‹° λ©λ΅μ΄ μ μ§€λλ‹¤. μ„λ²„λ” λ¦¬ν”λ¦¬μΌ€μ΄νΈλ ν”„λ΅νΌν‹°μ κ°’μ΄ λ³€ν•  λ•λ§λ‹¤ κ° ν΄λΌμ΄μ–ΈνΈμ— μ—…λ°μ΄νΈλ¥Ό μ „μ†΅ν•κ³ , ν΄λΌμ΄μ–ΈνΈλ” μ΄λ¥Ό μ•΅ν„°μ λ΅μ»¬ λ²„μ „μ— μ μ©ν•λ‹¤. ν΄λΌμ΄μ–ΈνΈλ” ν”„λ΅νΌν‹° μ—…λ°μ΄νΈλ¥Ό μ„λ²„λ‚ λ‹¤λ¥Έ ν΄λΌμ΄μ–ΈνΈλ΅ μ λ€ μ „μ†΅ν•μ§€ μ•λ”λ‹¤.

> π’΅ ν΄λΌμ΄μ–ΈνΈμ—μ„ λ¦¬ν”λ¦¬μΌ€μ΄νΈλ λ³€μμ κ°’μ„ λ°”κΎΈλ” κ²ƒμ€ λΉ„μ¶”μ²μ΄λ‹¤. λ‹¤μμ— μ„λ²„κ°€ λ³€ν™”λ¥Ό κ°μ§€ν•κ³  μ—…λ°μ΄νΈλ¥Ό μ „μ†΅ν•  λ• κΉμ§€ μ„λ²„μ κ°’κ³Ό ν΄λΌμ΄μ–ΈνΈμ κ°’μ΄ λ‹¬λΌμ§€κΈ° λ•λ¬Έμ΄λ‹¤.

ν”„λ΅νΌν‹° λ¦¬ν”λ¦¬μΌ€μ΄μ…μ€ **μ‹ λΆ°μ„±**μ΄ μ¤‘μ”ν•λ‹¤. ν΄λΌμ΄μ–ΈνΈμ μ•΅ν„° ν”„λ΅νΌν‹° κ°’μ€ μ„λ²„μ κ°’μ„ ν•­μƒ λ°μν•λ‹¤λ” μλ―Έμ§€λ§, ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ— μλ” ν”„λ΅νΌν‹°μ **κ°λ³„ λ³€κ²½μ‚¬ν•­μ— λ€ν• λ¨λ“  μ•λ¦Ό**μ„ λ°›μ§€λ” λ»ν•  μλ„ μλ‹¤.

μ¦‰ νΉμ •ν• μ •μ ν”„λ΅νΌν‹°κ°€ μ„λ²„μ—μ„ 100, 200, 300 μμΌλ΅ λ§¤μ° λΉ λ¥΄κ² λ³€κ²½λμ—λ‹¤λ©΄, μµμΆ…μ μΌλ΅ ν΄λΌμ΄μ–ΈνΈ ν”„λ΅νΌν‹°μ—μ„λ„ κ°’μ΄ 300μΌλ΅ μ—…λ°μ΄νΈ λκ² μ§€λ§ **μ¤‘κ°„μ— 200μ΄μ—μμ„ μ•λ‹¤λ” λ³΄μ¥μ€ μ—†λ‹¤.**

### μμ‹ μ½”λ“

ν”„λ΅νΌν‹°κ°€ μ •μλλ” μ•΅ν„°μ ν—¤λ”μ—μ„ `UPROPERTY` μ„ μ–Έμ— `replicated` ν‚¤μ›λ“λ¥Ό λ„£μ–΄μ£Όμ–΄μ•Ό ν•λ‹¤.

```cpp
class ENGINE_API AActor : public UObject
{
    UPROPERTY( replicated )
    AActor * Owner;
};
```

λν• μ•΅ν„° ν΄λμ¤μ κµ¬ν„μ—μ„ `GetLifetimeReplicatedProps` ν•¨μλ¥Ό κµ¬ν„ν•΄μ£Όμ–΄μ•Ό ν•λ‹¤.

```cpp
void AActor::GetLifetimeReplicatedProps(TArray<FLifetimeProperty>& OutLifetimeProps) const
{
    DOREPLIFETIME( AActor, Owner );
}
```

μ•΅ν„°μ μƒμ„±μμ—μ„ ν”λκ·Έ μ„¤μ •μ΄ μ¬λ°”λ¥΄κ² λμ–΄ μλ”μ§€ ν™•μΈν•λ‹¤.

```cpp
AActor::AActor(const class FPostConstructInitializeProperties& PCIP) : Super(PCIP)
{
    bReplicates = true;
}
```

### λ„¤νΈμ›ν¬ μ—…λ°μ΄νΈ μµμ ν™”

μ•΅ν„°μ `NetUpdateFrequency` λ³€μ μ„¤μ •μ„ ν†µν•΄ μ—…λ°μ΄νΈ λΉλ„λ¥Ό λ°”κΏ€ μ μλ‹¤. μ΄ λ°©λ²•μ—λ” **λ°μ΄ν„° μ£Όλ„ν• λ„¤νΈμ›ν¬ μ—…λ°μ΄νΈ λΉλ„, μ μ‘ν• λ„¤νΈμ›ν¬ μ—…λ°μ΄νΈ λΉλ„** λ‘κ°€μ§€ λ°©μ‹μ΄ μλ‹¤.

- λ°μ΄ν„° μ£Όλ„ν• λ„¤νΈμ›ν¬ μ—…λ°μ΄νΈ
    
  μν… κ²μ„μ—μ„ ν”λ μ΄μ–΄κ°€ μ΅°μΆ…ν•λ” μ•΅ν„°μ²λΌ μ¤‘μ”ν•κ³  μμΈ΅ λ¶κ°€λ¥ν• κ²½μ° 10(0.1μ΄λ§λ‹¤ μ—…λ°μ΄νΈ), 
  ν‘λ ¥ κ²μ„μ—μ„ AI μ΅°μΆ… λ¬μ¤ν„°μ²λΌ μ΅°κΈ λλ¦¬κ² μ›€μ§μ΄λ” μΊλ¦­ν„°μ κ²½μ° 5(0.2μ΄λ§λ‹¤ μ—…λ°μ΄νΈ), 
  μ¤‘μ”ν•μ§€λ” μ•μ§€λ§ λ„¤νΈμ›ν¬λ¥Ό ν†µν•΄ λ™κΈ°ν™”λ¥Ό ν•΄μ•Ό ν•κ±°λ‚ μ„λ²„μΈ΅ λ΅μ§μ μ΅°μΆ…μ„ λ°›μ•„ λ¦¬ν”λ¦¬μΌ€μ΄μ…μ΄ ν•„μ”ν• κ²½μ°λ” 2(0.5μ΄λ§λ‹¤ μ—…λ°μ΄νΈ) μ •λ„λ΅ μ„¤μ •ν•λ‹¤.
    
- μ μ‘ν• λ„¤νΈμ›ν¬ μ—…λ°μ΄νΈ
    
  κΈ°λ³Έμ μΌλ΅ λΉ„ν™μ„±ν™” λμ–΄μμ–΄, μ½μ†” λ³€μ `net.UseAdaptiveNetUpdateFrequency`λ¥Ό 1λ΅ μ„¤μ •ν•λ©΄ ν™μ„±ν™”λλ‹¤.
  
  μ΄ κΈ°λ¥μ„ μΌλ©΄ μ—…λ°μ΄νΈκ°€ μ μλ―Έν•μ§€μ— λ”°λΌ κ°λ³„ μ•΅ν„°μ μ—…λ°μ΄νΈ λΉλ„λ¥Ό μ‹μ¤ν…μ΄ λ™μ μΌλ΅ μ μ‘μ‹ν‚¨λ‹¤. β€μ μλ―Έν•λ‹¤β€™λ” λ§μ€ μ•΅ν„°μ μ΄κΈ°ν™”, μ•΅ν„°μ— μ„λΈμ¤λΈμ νΈ μ¶”κ°€ λλ” μ κ±°, μ•΅ν„° νΉμ€ κ·Έ μ„λΈμ¤λΈμ νΈμ λ¦¬ν”λ¦¬μΌ€μ΄ν‹°λ“ ν”„λ΅νΌν‹° κ°’μ„ λ³€κ²½ν•κ±°λ‚ ν•λ” μ—…λ°μ΄νΈλ¥Ό λ§ν•λ‹¤. 
  
  κ° μ•΅ν„°μ— κ°€λ¥ν• μ—…λ°μ΄νΈ λΉ„μ¨ λ²”μ„λ” μ•΅ν„° μμ²΄μ λ³€μ λ‘λ΅ κ²°μ •λλ‹¤. ν•λ‚λ” μ•΅ν„°κ°€ μ΄λ‹Ή μµλ€ λ‡λ²κΉμ§€ μ—…λ°μ΄νΈλ¥Ό μ‹λ„ν• μ§€ κ²°μ •ν•λ” `NetUpdateFrequency`, λ‹¤λ¥Έ ν•λ‚λ” μ΄λ‹Ή μµμ† λ‡λ²κΉμ§€ μ—…λ°μ΄νΈλ¥Ό μ‹λ„ν• μ§€ κ²°μ •ν•λ” `MinNetUpdateFrequency`μ΄λ‹¤.
  

## RPC(Remote Procedure Call)

RPCλ” λ΅μ»¬μ—μ„ νΈμ¶λμ§€λ§ μ΄ λ΅μ»¬κ³Ό μ—°κ²°λμ–΄ μλ” μ›κ²©μ—μ„ μ‹¤ν–‰λλ” ν•¨μλ¥Ό λ§ν•λ‹¤. μ£Όλ΅ μ—°κ²°λ μƒλ€μ—κ² μ›ν•λ” ν”„λ΅νΌν‹°λ¥Ό μ¦‰κ°μ μΌλ΅ μ—…λ°μ΄νΈν•λ„λ΅ μ”μ²­ν•  λ• μ‚¬μ©ν•λ‹¤.

RPCλ¥Ό μ‚¬μ©ν•λ ¤λ©΄ ν•¨μλ¥Ό μ„ μ–Έν•  λ• ν‚¤μ›λ“λ¥Ό μ¶”κ°€ν•΄μ£ΌκΈ°λ§ ν•λ©΄ λλ‹¤. 

```cpp
// μ„λ²„μ—μ„ νΈμ¶λμ§€λ§ ν΄λΌμ΄μ–ΈνΈμ—μ„ μ‹¤ν–‰λλ” RPC ν•¨μ μ„ μ–Έ
UFUNCTION( Client )
void ServerRPCFuction();

// ν΄λΌμ΄μ–ΈνΈμ—μ„ νΈμ¶λμ§€λ§ μ„λ²„μ—μ„ μ‹¤ν–‰λλ” RPC ν•¨μ μ„ μ–Έ
UFUNCTION( Server )
void ServerRPCFunction();

// μ„λ²„μ—μ„ νΈμ¶ν• ν›„ μ„λ²„ λ° λ¨λ“  μ—°κ²°λ ν΄λΌμ΄μ–ΈνΈμ—μ„ μ‹¤ν–‰λλ” RPC ν•¨μ
UFUNCTION( NetMulticast )
void MulticastRPCFunction();
```

### RPC μ‘λ™ μ”κ±΄ λ° μ£Όμμ‚¬ν•­
RPCμ μ •μƒ μ‘λ™μ„ μ„ν•΄μ„λ” λ‡κ°€μ§€ μ”κ±΄μ„ μ¶©μ΅±ν•΄μ•Ό ν•λ‹¤.
1. λ¦¬ν”λ¦¬μΌ€μ΄νΈλλ” `Actor`μ—μ„ νΈμ¶λ  κ²ƒ.
2. μ„λ²„μ—μ„ νΈμ¶λκ³  ν΄λΌμ΄μ–ΈνΈμ—μ„ μ‹¤ν–‰λλ” `RPC`μ κ²½μ° ν•΄λ‹Ή μ•΅ν„°λ¥Ό μ‹¤μ λ΅ μ†μ ν•κ³  μλ” ν΄λΌμ΄μ–ΈνΈμ—μ„λ§ ν•¨μκ°€ μ‹¤ν–‰λ¨.
3. ν΄λΌμ΄μ–ΈνΈμ—μ„ νΈμ¶λκ³  μ„λ²„μ—μ„ μ‹¤ν–‰λλ” `RPC`μ κ²½μ° ν΄λΌμ΄μ–ΈνΈκ°€ ν•΄λ‹Ή μ•΅ν„°λ¥Ό μ†μ ν•κ³  μμ–΄μ•Ό ν•¨.
4. `Multicast RPC`λ” μμ™Έ:
  - μ„λ²„μ—μ„ νΈμ¶ν•λ©΄ μ„λ²„μ λ΅μ»¬ λ° μ—°κ²°λ λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ—μ„λ„ μ‹¤ν–‰λ¨.
  - ν΄λΌμ—μ„ νΈμ¶ν•λ©΄ λ΅μ»¬μ—μ„λ§ μ‹¤ν–‰λκ³ , μ„λ²„μ—μ„λ” μ‹¤ν–‰λμ§€ μ•μ

λν• κΈ°λ³Έμ μΌλ΅ RPCλ” λΉ„μ‹ λΆ°μ„±μ΄κΈ° λ•λ¬Έμ—(UDP λ°©μ‹), μ›κ²©μ—μ„ ν™•μ‹¤ν μ‹¤ν–‰λκ² ν•λ ¤λ©΄ `Reliable` ν‚¤μ›λ“λ¥Ό λ¶™μ—¬μ•Ό ν•λ‹¤.
```cpp
UFUNCTION( Client, Reliable )
void ClientRPCFunction();
```


# μ°Έκ³ 

[[UE5 λ¬Έμ„] μ „μ© μ„λ²„ κµ¬μ„±ν•κΈ°](https://docs.unrealengine.com/5.2/ko/setting-up-dedicated-servers-in-unreal-engine/)

[[UE5 λ¬Έμ„] μ•΅ν„°μ™€ κ·Έ μ ‘μ† μ†μ ](https://docs.unrealengine.com/5.2/ko/actors-and-their-owning-connections-in-unreal-engine/)

[[UE4 λ¬Έμ„] ν΄λΌμ΄μ–ΈνΈ-μ„λ²„ λ¨λΈ](https://docs.unrealengine.com/4.26/ko/InteractiveExperiences/Networking/Server/)

[[UE4 λ¬Έμ„] μ•΅ν„° λ¦¬ν”λ¦¬μΌ€μ΄μ…](https://docs.unrealengine.com/4.26/ko/InteractiveExperiences/Networking/Actors/)

[[Tistory] λ„¤νΈμ›ν‚Ήκ³Ό λ©€ν‹°ν”λ μ΄μ–΄](https://noooong1231.tistory.com/97)