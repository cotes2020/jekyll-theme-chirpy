---
title: "Backpropagation"
author: Kwon
date: 2022-05-13T00:00:00 +0900
categories: [background]
tags: [backpropagation]
math: true
mermaid: false
---

***
 
## Backpropagation

?°?´?„°ë¥? ? ˆ?´?–´?˜ ?…¸?“œ?“¤?„ ?†µê³¼ì‹œ?‚¤ë©´ì„œ ?„¤? •?œ weight?— ?”°?¼ ?˜ˆì¸? ê²°ê³¼ê°’ì„ ê³„ì‚°?•˜?Š” ê²ƒì„ **forward pass**?¼ê³? ?•œ?‹¤.

![Forward Pass](/posting_imgs/forward.png)

MLP?˜ ê²°ê³¼ê°’ì„ ë§Œë“¤?–´ ì£¼ëŠ” ?•„?ˆ˜? ?¸ ê³¼ì •?´ì§?ë§? ?´ê²ƒë§Œ?œ¼ë¡œëŠ” weightë¥? ê°œì„ ?•˜ë©´ì„œ ?•™?Šµ?„ ì§„í–‰?•  ?ˆ˜ê°? ?—†?‹¤.

?´ê²ƒì„ ê°??Š¥?•˜ê²? ?•´ì¤? ê²ƒì´ ë°”ë¡œ backpropagation(?˜¤ì°? ?—­? „?ŒŒ)?´?‹¤.

?—­? „?ŒŒ ?•Œê³ ë¦¬ì¦˜ì?? chain rule?„ ?†µ?•´ ê°? ?…¸?“œ?“¤?— predictionê³? target?˜ total errorë¥? ? „?‹¬?•˜?—¬ $\nabla W$ë¥? ê³„ì‚°?•  ?ˆ˜ ?ˆê²? ?•´ ì¤??‹¤.
?˜¤ì°? ?—­? „?ŒŒ?¼?Š” ?´ë¦„ì´ ë¶™ì?? ê²ƒë„ ?´ ?•Œë¬¸ì´?‹¤.

?´? ‡ê²? ê³„ì‚°?•œ $\nabla W$ë¥? ?‚¬?š©?•˜?—¬ ?‹¤?Œê³? ê°™ì´ weightë¥? ê°œì„ ?•œ?‹¤.

\\[W:=W-\alpha\nabla W\\]

??„¸?•œ ?‚´?š©??? [ê´?? ¨ ?¬?Š¤?Œ…](http:/qja1998.github.io/2022/04/18/dlZeroToAll-PyTorch-3/)?„ ì°¸ê³ ?•˜?

?œ„?—?„œ ?‚˜?™”?˜ ?„¤?Š¸?›Œ?¬?˜ ?¼ë¶?ë¶„ì„ ?–¼?„œ ?—­? „?ŒŒê°? ?–´?–»ê²? ? ?š©?˜?Š”ì§? ?™•?¸?•´ ë³´ì.

![Backpropagation ê³¼ì •](/posting_imgs/backward.png)

ë¨¼ì?? ìµœì¢… output?— ê°??¥ ê°?ê¹Œìš´ $\nabla W_3$ë¶??„° ê³„ì‚°?•œ?‹¤.

\\[\nabla w_3=\frac{\partial cost}{\partial W_3}=\frac{\partial cost}{\partial o_1}\frac{\partial o_1}{\partial y_1}\frac{\partial y_1}{\partial W_3}\\]

$\nabla W_3$?Š” chain rule?„ ?†µ?•´ ?œ„??? ê°™ì´ ë¯¸ë¶„?´ ë°”ë¡œ ?˜?Š” ?˜•?‹?œ¼ë¡? ?‘œ?˜„?•  ?ˆ˜ ?ˆ?‹¤. ?•œ ë²? ?” ê±°ìŠ¬?Ÿ¬ ?˜¬?¼ê°? ë³´ì.

?´ë²ˆì—?Š” $\nabla W_1$ê³? $\nabla W_2$ë¥? êµ¬í•  ì°¨ë???´?‹¤. ë¨¼ì?? $\nabla X_1$?„ êµ¬í•´ë³´ì.

\\[\frac{\partial cost}{\partial W_1}=\frac{\partial cost}{\partial y_1}\frac{\partial y_1}{\partial h_{z_2}}\frac{\partial h_{z_2}}{\partial z_2}\frac{\partial z_2}{\partial W_1}\\]

ë§ˆì°¬ê°?ì§?ë¡? chain rule?„ ?†µ?•´ ê³„ì‚°?•œ?‹¤. $\frac{\partial cost}{\partial y_1}$??? $\nabla X_3$?„ êµ¬í•  ?•Œ êµ¬í–ˆ?—ˆê¸? ?•Œë¬¸ì— ëª¨ë“  ?¸ë¯¸ë¶„?´ ê³„ì‚° ê°??Š¥?•˜?‹¤.

$\nabla W_2$?Š” ?—¬ê¸°ì„œ  $W_1$?„ $W_2ë¡? ë°”ê¿”ì£¼ê¸°ë§? ?•˜ë©? ?œ?‹¤.$

\\[\frac{\partial cost}{\partial W_2}=\frac{\partial cost}{\partial y_1}\frac{\partial y_1}{\partial h_{z_2}}\frac{\partial h_{z_2}}{\partial z_2}\frac{\partial z_2}{\partial W_2}\\]

ìµœì¢… output?´ ?—†?–´?„ forward ?„ì¤‘ì— ê³„ì‚°?•  ?ˆ˜ ?ˆ?Š” ?¸ë¯¸ë¶„?“¤??? forward passë¥? ?•˜ë©´ì„œ ë¯¸ë¦¬ ê³„ì‚°?•˜?—¬ ????¥?•´ ?‘ê³? ?‚¬?š©?•œ?‹¤.

?´ë²? ?˜ˆ? œ?—?„œ?Š” ?•„ì£? ê°„ë‹¨?•œ ?„¤?Š¸?›Œ?¬?— ????•´ ?‹¤ë¤˜ì??ë§? ?” ê¹Šê³  ?„“??? ?„¤?Š¸?›Œ?¬?— ????•´?„œ?„ ?˜‘ê°™ì´ ? ?š©?•  ?ˆ˜ ?ˆ?‹¤.