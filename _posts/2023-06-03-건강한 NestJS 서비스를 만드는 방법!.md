---
title: κ±΄κ°•ν• NestJS μ„λΉ„μ¤λ¥Ό λ§λ“λ” λ°©λ²•!
date: 2023-06-03 20:00:00 +0900
categories:
  - JavaScript
tags:
  - NextJS
  - NextJSμ„λΉ„μ¤
---

μ•λ…•ν•μ„Έμ” μ—¬λ¬λ¶„! π μ¤λμ€ λ‹¨μν•μ§€λ§ κµ‰μ¥ν μ¤‘μ”ν• μ£Όμ λ¥Ό λ‹¤λ£¨λ¬ μ™”μµλ‹λ‹¤. λ°”λ΅ NestJS μ•±μ—μ„ κ±΄κ°• κ²€μ‚¬λ¥Ό μ–΄λ–»κ² ν•λ”μ§€ μ•μ•„λ³΄λ” κ±°μ—μ”. ν•¨κ» ν•΄λ³΄μ‹¤λμ”? π

## λ§μ΄ν¬λ΅μ„λΉ„μ¤ μ•„ν‚¤ν…μ²μ μ£Όμ” κ΄€λ¦¬μκ°€ λμ–΄λ³΄μ! π€

μ°λ¦¬κ°€ λ§λ“λ” μ•±μ΄ μ μ‘λ™ν•κ³  μλ”μ§€, λλ” μ„λΉ„μ¤κ°€ μ¤€λΉ„λμ–΄ μλ”μ§€ ν™•μΈν•λ” κ²ƒμ€ κµ‰μ¥ν μ¤‘μ”ν• μΌμ΄μ£ . μ΄λ¬ν• κ±Έ ν™•μΈν•λ” μ—­ν• μ„ ν•λ” κ²ƒμ΄ λ°”λ΅ **μ—”λ“ν¬μΈνΈ(endpoint)** λΌλ” μΉκµ¬μΈλ°μ”, μ΄ μΉκµ¬λ¥Ό ν†µν•΄ μ„λΉ„μ¤μ **μƒμ΅΄ μ—¬λ¶€(liveness)**μ™€ **κ°€μ© μ—¬λ¶€(readiness)**λ¥Ό ν™•μΈν•  μ μμ–΄μ”! 

κ·ΈλΌ λ°”λ΅ μ΄ μ—”λ“ν¬μΈνΈλ¥Ό μ–΄λ–»κ² λ§λ“λ”μ§€ ν•λ² λ³΄λ¬ κ°€λ³ΌκΉμ”? πƒ

## μƒλ΅μ΄ ν”„λ΅μ νΈ, μƒλ΅μ΄ μ‹μ‘! π

NestJS ν”„λ΅μ νΈλ¥Ό λ§λ“¤λ ¤λ©΄ ν„°λ―Έλ„μ—μ„ μ•„λ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•΄μ•Ό ν•΄μ”! κ·ΈλΌ μƒλ΅μ΄ ν”„λ΅μ νΈκ°€ νƒ„μƒν•κ² μ£ ? π£

```bash
$ nest new our-nestjs
```

## λΉ λ¥΄κ² ν™•μΈν•λ” liveness μ—”λ“ν¬μΈνΈ λ§λ“¤κΈ°! β΅

μ΄μ  liveness μ—”λ“ν¬μΈνΈλ¥Ό λ§λ“¤μ–΄ λ³Ό κ±°μ—μ”. μ΄ μΉκµ¬λ” μ„λΉ„μ¤κ°€ **'μ‚΄μ•„μλ”μ§€'** λ¥Ό λΉ λ¥΄κ² ν™•μΈν•  μ μκ² ν•΄μ¤μ”! π 

λ¨Όμ € health λ¨λ“κ³Ό health μ»¨νΈλ΅¤λ¬λ¥Ό λ§λ“¤μ–΄μ•Όκ² μ£ ? μ•„λ λ…λ Ήμ–΄λ΅ λ‘ λ‹¤ λ§λ“¤μ–΄ λ΄…μ‹λ‹¤!

```bash
$ nest generate module health
$ nest generate controller health
```

μ΄μ  κΈ°λ³Έμ μΈ μ¤€λΉ„λ” λλ‚¬μ–΄μ”! μ»¨νΈλ΅¤λ¬μ—μ„ `/health`λ΅ λ“¤μ–΄μ¤λ” μ”μ²­μ„ μ²λ¦¬ν•λ„λ΅ μ½”λ“λ¥Ό μ‘μ„±ν•΄λ³ΌκΉμ”? 

```typescript
import { Controller, Get } from "@nestjs/common";

@Controller()
export class HealthController {
  @Get("health")
  checkHealth() {
    return "OK";
  }
}
```

## μ°°μ§€κ² λ§λ“λ” readiness μ—”λ“ν¬μΈνΈ! π’

μ΄λ²μ—λ” readiness μ—”λ“ν¬μΈνΈλ¥Ό λ§λ“¤ μ°¨λ΅€μ—μ”! μ΄ μΉκµ¬λ” μ„λΉ„μ¤κ°€ μ”μ²­μ„ μ μ²λ¦¬ν•  μ μλ” μƒνƒμΈμ§€ ν™•μΈν•΄μ¤€λ‹µλ‹λ‹¤. NestJSμ—μ„λ” μ΄ μ—”λ“ν¬μΈνΈλ¥Ό λ§λ“¤κΈ° μ„ν•΄ **@nestjs/terminus**λΌλ” ν¨ν‚¤μ§€λ¥Ό μ κ³µν•΄μ”! π„

```bash
$ npm i @nestjs/terminus
```

ν¨ν‚¤μ§€λ¥Ό μ„¤μΉν• ν›„, μ•„λμ™€ κ°™μ΄ μ½”λ“λ¥Ό μ‘μ„±ν•΄μ„ ν™ λ©”λ¨λ¦¬ μ‚¬μ©λ‰μ΄ 300MBκ°€ λ„λ”μ§€ ν™•μΈν•λ” μ—”λ“ν¬μΈνΈλ¥Ό λ§λ“¤μ–΄ λ³΄κ² μµλ‹λ‹¤!

```typescript
import { Controller, Get } from "@nestjs/common";
import { HealthCheck, HealthCheckService, MemoryHealthIndicator } from "@nestjs/terminus";

@Controller()
export class HealthController {
  constructor(
    private readonly health: HealthCheckService,
    private readonly memory: MemoryHealthIndicator
  ) {}

  @Get("health")
  checkHealth() {
    return "OK";
  }

  @Get("status")
  @HealthCheck()
  checkStatus() {
    return this.health.check([
      () => this.memory.checkHeap("memory_heap", 300 * 1024 * 1024),
    ]);
  }
}
```

μ΄μ  μ„λΉ„μ¤μ κ±΄κ°• μƒνƒλ¥Ό ν™•μΈν•λ” μ—”λ“ν¬μΈνΈκ°€ μ¤€λΉ„λμ–΄μ”! π‰ ν„°λ―Έλ„μ—μ„ curl λ…λ Ήμ–΄λ¥Ό μ΄μ©ν•΄ μ‘μ„±ν• μ—”λ“ν¬μΈνΈλ¥Ό νΈμ¶ν•λ©΄, κ±΄κ°• μƒνƒλ¥Ό ν™•μΈν•  μ μλ‹µλ‹λ‹¤! π„

## λ§λ¬΄λ¦¬ π

μ¤λμ€ NestJS μ•±μ—μ„ μ¤‘μ”ν• κ±΄κ°• κ²€μ‚¬ μ—”λ“ν¬μΈνΈλ¥Ό λ§λ“¤μ–΄ λ³΄μ•μ–΄μ”! μ΄μ  μ°λ¦¬μ μ•±μ΄ μ–Όλ§λ‚ κ±΄κ°•ν•μ§€ ν™•μΈν•  μ μκ² μ£ ? π¥° 

μ–΄λ ¤μ΄ λ¶€λ¶„μ΄ μμΌμ‹λ‹¤λ©΄ μ–Έμ λ“ μ§€ λ“κΈ€λ΅ μ§λ¬Έν•΄μ£Όμ„Έμ”! λ‹¤μμ— λ λ§λ‚μ”! π
