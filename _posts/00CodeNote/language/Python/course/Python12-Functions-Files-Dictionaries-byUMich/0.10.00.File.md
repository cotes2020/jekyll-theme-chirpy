
# File(æ–‡ä»¶) æ–¹æ³•

[toc]

---

# `with`

```py
with open('mydata.txt', 'r') as md:
    print(md.readlines())
    # ['1 2 3\n', '4 5 6\n']

1. not good for large data.

    for lin in fileref.readlines(): print(lin)

2. This option: iterating over the file itself while still iterating over each line in the file:

    for line in md: print(line)
    # 1 2 3
    #
    # 4 5 6
```


```py
with open('pi_digits.txt') as file_object:
    contents = file_object.read()
print(contents)
# print(contents.rstrip())  # remove the extra blank line

# 3.1415926535
#   8979323846
#   2643383279
# (one blank space)
```

The only difference between output and the original file is the extra blank line at the end of the output.
- The blank line appears: because `read()` **returns an empty string** when it reaches the end of the file; this empty string shows up as a blank line.
- to remove the extra blank line, use rstrip()


---

# `open()`

1. `file.variable=open(file.object)`: file å¯¹è±¡ä½¿ç”¨ open() æ¥åˆ›å»º
    - The variable `file.variable` now holds a reference to the `file object` returned by `open()`.
    - When finished with the file, close it by `close()`.

Forgetting to close() does not necessarily cause a runtime error in the kinds of programs you typically write in an introductory programing course. but for program that may run for days or weeks at a time that does a lot of file reading and writing.

```py
afile = open("/../foo.txt", "w")
...
afile.close()
```

> Note
> A common mistake:
> whether you are providing a `variable name` or a `string literal` as an input to the open function.
> `fileref = open("olympics.txt", "r")`: â€œolympics.txtâ€ is a string literal that should correspond to the name of a file on your computer.
> If put something without quotes, like `open(x, "r")`, it will be treated as a variable name. In this example, x should be a variable thatâ€™s already been bound to a string value like â€œolympics.txtâ€.

---

## `open()` æ–¹æ³•

ç”¨äºæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶è¿”å›æ–‡ä»¶å¯¹è±¡ï¼Œ
- åœ¨å¯¹æ–‡ä»¶è¿›è¡Œå¤„ç†è¿‡ç¨‹éƒ½éœ€è¦ä½¿ç”¨åˆ°è¿™ä¸ªå‡½æ•°ï¼Œ
- å¦‚æœè¯¥æ–‡ä»¶æ— æ³•è¢«æ‰“å¼€ï¼Œä¼šæŠ›å‡º OSErrorã€‚

`open(file, mode='r', buffering=-1, encoding=None, errors=None, newline=None, closefd=True, opener=None)`

- `file`: å¿…éœ€ï¼Œæ–‡ä»¶è·¯å¾„ï¼ˆç›¸å¯¹æˆ–è€…ç»å¯¹è·¯å¾„ï¼‰ã€‚
- `mode`: å¯é€‰ï¼Œæ–‡ä»¶æ‰“å¼€æ¨¡å¼
- buffering: è®¾ç½®ç¼“å†²
- encoding: ä¸€èˆ¬ä½¿ç”¨utf8
- errors: æŠ¥é”™çº§åˆ«
- newline: åŒºåˆ†æ¢è¡Œç¬¦
- closefd: ä¼ å…¥çš„fileå‚æ•°ç±»å‹
- opener:
- mode å‚æ•°æœ‰ï¼š

é»˜è®¤ä¸ºæ–‡æœ¬æ¨¡å¼ï¼Œå¦‚æœè¦ä»¥äºŒè¿›åˆ¶æ¨¡å¼æ‰“å¼€ï¼ŒåŠ ä¸Š `b` ã€‚

æ¨¡å¼	|  æè¿°
---|---
`t`	   |  æ–‡æœ¬æ¨¡å¼ (é»˜è®¤)ã€‚
`x`	   |  å†™æ¨¡å¼ï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™ä¼šæŠ¥é”™ã€‚
`b`	   |  äºŒè¿›åˆ¶æ¨¡å¼ã€‚
`+`	   |  æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œæ›´æ–°(`å¯è¯»å¯å†™`)ã€‚
`U`	   |  é€šç”¨æ¢è¡Œæ¨¡å¼ï¼ˆPython 3 ä¸æ”¯æŒï¼‰ã€‚
---|---
r	  | `åªè¯»`ã€‚æ–‡ä»¶çš„æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚è¿™æ˜¯é»˜è®¤æ¨¡å¼ã€‚
rb	| ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºåªè¯»ã€‚æ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚
r+	| `è¯»å†™`ã€‚æ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚
rb+	| ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚æ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚
---|---
w	  | `å†™å…¥`ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œ`åˆ›å»º`æ–°æ–‡ä»¶ã€‚
wb	| ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶åªç”¨äºå†™å…¥ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œ`åˆ›å»º`æ–°æ–‡ä»¶ã€‚
w+	| `è¯»å†™`ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œ`åˆ›å»º`æ–°æ–‡ä»¶ã€‚
wb+	| ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œ`åˆ›å»º`æ–°æ–‡ä»¶ã€‚
---|---
a	  | æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äº`è¿½åŠ `ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–°çš„å†…å®¹å°†ä¼šè¢«å†™å…¥åˆ°å·²æœ‰å†…å®¹ä¹‹åã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶è¿›è¡Œå†™å…¥ã€‚
ab	| ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äº`è¿½åŠ `ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–°çš„å†…å®¹å°†ä¼šè¢«å†™å…¥åˆ°å·²æœ‰å†…å®¹ä¹‹åã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶è¿›è¡Œå†™å…¥ã€‚
a+	| æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚æ–‡ä»¶æ‰“å¼€æ—¶ä¼šæ˜¯è¿½åŠ æ¨¡å¼ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ç”¨äºè¯»å†™ã€‚
ab+	| ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¿½åŠ ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ç”¨äºè¯»å†™ã€‚

---

# `file` å¯¹è±¡å¸¸ç”¨çš„å‡½æ•°ï¼š

## file.`close()`

å…³é—­ä¸€ä¸ªå·²æ‰“å¼€çš„æ–‡ä»¶ã€‚å…³é—­åçš„æ–‡ä»¶ä¸èƒ½å†è¿›è¡Œè¯»å†™æ“ä½œï¼Œ å¦åˆ™ä¼šè§¦å‘ ValueError é”™è¯¯ã€‚ close() æ–¹æ³•å…è®¸è°ƒç”¨å¤šæ¬¡ã€‚

å½“ file å¯¹è±¡ï¼Œè¢«å¼•ç”¨åˆ°æ“ä½œå¦å¤–ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼ŒPython ä¼šè‡ªåŠ¨å…³é—­ä¹‹å‰çš„ file å¯¹è±¡ã€‚ ä½¿ç”¨ close() æ–¹æ³•å…³é—­æ–‡ä»¶æ˜¯ä¸€ä¸ªå¥½çš„ä¹ æƒ¯ã€‚

```py
fo = open("runoob.txt", "wb")
...
fo.close()
```

## file.`flush()`

ç”¨æ¥åˆ·æ–°ç¼“å†²åŒºçš„ï¼Œå³å°†ç¼“å†²åŒºä¸­çš„æ•°æ®ç«‹åˆ»å†™å…¥æ–‡ä»¶ï¼ŒåŒæ—¶æ¸…ç©ºç¼“å†²åŒºï¼Œä¸éœ€è¦è¢«åŠ¨çš„ç­‰å¾…è¾“å‡ºç¼“å†²åŒºå†™å…¥ã€‚

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ–‡ä»¶å…³é—­åä¼šè‡ªåŠ¨åˆ·æ–°ç¼“å†²åŒºï¼Œä½†æœ‰æ—¶ä½ éœ€è¦åœ¨å…³é—­å‰åˆ·æ–°å®ƒï¼Œè¿™æ—¶å°±å¯ä»¥ä½¿ç”¨ flush() æ–¹æ³•ã€‚

```py
fo = open("runoob.txt", "wb")  # æ‰“å¼€æ–‡ä»¶
print ("æ–‡ä»¶åä¸º: ", fo.name)
fo.flush()   # åˆ·æ–°ç¼“å†²åŒº
fo.close()   # å…³é—­æ–‡ä»¶
```

### file.`fileno()`

è¿”å›ä¸€ä¸ªæ•´å‹çš„æ–‡ä»¶æè¿°ç¬¦(file descriptor FD æ•´å‹), å¯ç”¨äºåº•å±‚æ“ä½œç³»ç»Ÿçš„ I/O æ“ä½œã€‚å¯ä»¥ç”¨åœ¨å¦‚osæ¨¡å—çš„readæ–¹æ³•ç­‰ä¸€äº›åº•å±‚æ“ä½œä¸Šã€‚

```py
fo = open("runoob.txt", "wb")
print ("æ–‡ä»¶åä¸º: ", fo.name)   # æ–‡ä»¶åä¸º:  runoob.txt
fid = fo.fileno()
print ("æ–‡ä»¶æè¿°ç¬¦ä¸º: ", fid)    # æ–‡ä»¶æè¿°ç¬¦ä¸º:  3
fo.close()                     # å…³é—­æ–‡ä»¶
```

### file.`isatty()`

æ£€æµ‹æ–‡ä»¶æ˜¯å¦è¿æ¥åˆ°ä¸€ä¸ªç»ˆç«¯è®¾å¤‡ï¼Œå¦‚æœæ˜¯è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚

```py
fo = open("runoob.txt", "wb")
print ("æ–‡ä»¶åä¸º: ", fo.name)  # æ–‡ä»¶åä¸º:  runoob.txt
ret = fo.isatty()
print ("è¿”å›å€¼ : ", ret)      # è¿”å›å€¼ :  False
fo.close()                   # å…³é—­æ–‡ä»¶
```

### file.`next(iterator[,default])`

- Python 3 ä¸­çš„ File å¯¹è±¡ä¸æ”¯æŒ `next()` æ–¹æ³•ã€‚
- Python 3 çš„å†…ç½®å‡½æ•° `next()` é€šè¿‡è¿­ä»£å™¨è°ƒç”¨ `__next__()` æ–¹æ³•è¿”å›ä¸‹ä¸€é¡¹ã€‚
- åœ¨å¾ªç¯ä¸­ï¼Œ`next()`æ–¹æ³•ä¼šåœ¨æ¯æ¬¡å¾ªç¯ä¸­è°ƒç”¨ï¼Œè¯¥æ–¹æ³•è¿”å›æ–‡ä»¶çš„ä¸‹ä¸€è¡Œï¼Œå¦‚æœåˆ°è¾¾ç»“å°¾(EOF),åˆ™è§¦å‘ StopIteration

è¿”å›å€¼: è¿”å›æ–‡ä»¶ä¸‹ä¸€è¡Œã€‚

```py
# æ–‡ä»¶ runoob.txt çš„å†…å®¹å¦‚ä¸‹ï¼š
è¿™æ˜¯ç¬¬ä¸€è¡Œ
è¿™æ˜¯ç¬¬äºŒè¡Œ
è¿™æ˜¯ç¬¬ä¸‰è¡Œ
è¿™æ˜¯ç¬¬å››è¡Œ
è¿™æ˜¯ç¬¬äº”è¡Œ
# å¾ªç¯è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼š
fo = open("runoob.txt", "r")
print ("æ–‡ä»¶åä¸º: ", fo.name)
for index in range(5):
    line = next(fo)
    print ("ç¬¬ %d è¡Œ - %s" % (index, line))
fo.close()    # å…³é—­æ–‡ä»¶
# result
æ–‡ä»¶åä¸º:  runoob.txt
ç¬¬ 0 è¡Œ - è¿™æ˜¯ç¬¬ä¸€è¡Œ
ç¬¬ 1 è¡Œ - è¿™æ˜¯ç¬¬äºŒè¡Œ
ç¬¬ 2 è¡Œ - è¿™æ˜¯ç¬¬ä¸‰è¡Œ
ç¬¬ 3 è¡Œ - è¿™æ˜¯ç¬¬å››è¡Œ
ç¬¬ 4 è¡Œ - è¿™æ˜¯ç¬¬äº”è¡Œ
```

---

## Alternative File Reading Methods

generally either iterate through the lines returned by `readlines()` with a `for` loop,

or use `read()` to get all of the contents as a single string.

> Note
> A common error
> all these ways of `read()` the file contents, use up the file.
> After you call `readlines()`, call it again will get an empty list.

Check your Understanding

### Reading Line by Line:

```py
filename = 'pi_digits.txt'

with open(filename) as file_object:
    for line in file_object:
        print(line.rstrip())
```


### Making a List of Lines from a File

```py
filename = 'pi_digits.txt'

with open(filename) as file_object:
    lines = file_object.readlines()

for line in lines:
    print(line.rstrip())

```

### load Large Files: One Million Digits

```py
filename = 'pi_million_digits.txt'
with open(filename) as file_object:
    lines = file_object.readlines()

pi_string = ''
for line in lines:
    pi_string += line.strip()

print(f"{pi_string[:52]}...")
print(len(pi_string))

# 3.14159265358979323846264338327950288419716939937510...
# 1000002
```


### file.`read([n])` -> a string

ä»æ–‡ä»¶è¯»å–æŒ‡å®šçš„å­—èŠ‚æ•°, return a string of `n` characters
- åŒ…æ‹¬ "\n" å­—ç¬¦ã€‚
- æœªç»™å®šæˆ–ä¸ºè´Ÿ: è¯»å–æ‰€æœ‰ã€‚

```py
# æ–‡ä»¶ runoob.txt:
è¿™æ˜¯ç¬¬ä¸€è¡Œ
è¿™æ˜¯ç¬¬äºŒè¡Œ
è¿™æ˜¯ç¬¬ä¸‰è¡Œ
è¿™æ˜¯ç¬¬å››è¡Œ
è¿™æ˜¯ç¬¬äº”è¡Œ
# è¯»å–
fo = open("runoob.txt", "r+")
line = fo.read(10)
print (line)
fo.close()
# ç»“æœ
è¿™æ˜¯ç¬¬ä¸€è¡Œ
è¿™æ˜¯ç¬¬äºŒ
```

### file.`readline([n])`

è¯»å–æ•´è¡Œï¼ŒåŒ…æ‹¬ "\n" å­—ç¬¦ã€‚
- Read and return the next line of the file with all text up to and including the newline character.
- å¦‚æœæŒ‡å®šäº†ä¸€ä¸ªéè´Ÿæ•°çš„å‚æ•°: è¿”å›æŒ‡å®šå¤§å°çš„å­—èŠ‚æ•°ï¼ŒåŒ…æ‹¬ "\n" å­—ç¬¦ã€‚

```py

1. åº¦è¿‡åä¸ä¼šå†é‡å¤ï¼Œç›´æ¥æ¥ç€ä¸‹ä¸€ä¸ª

    # æ–‡ä»¶ runoob.txt:
    1:www.runoob.com
    2:www.runoob.com
    # è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼š
    fo = open("runoob.txt", "r+")
    line = fo.readline()
    line = fo.readline(5)
    print (line)
    fo.close()
    # ç»“æœ
    2:www
```

### file.`readlines([n])`  --> list

Returns a `list of strings`
- each representing a single line of the file.
- If `n` is not provided: all lines of the file are returned.
- If `n` is provided: `n` characters are read but `n` is rounded up so that an entire line is returned.
- Note Like `readline` `readlines` ignores the parameter n in the browser.

A `line` of a file: a sequence of characters up to and including a special character, "newline" character": `\n`.


è¯»å–æ‰€æœ‰è¡Œå¹¶è¿”å›åˆ—è¡¨
- è‹¥ç»™å®šsizeint>0ï¼Œè¿”å›æ€»å’Œå¤§çº¦ä¸ºsizeintå­—èŠ‚çš„è¡Œ, å®é™…è¯»å–å€¼å¯èƒ½æ¯” sizeint è¾ƒå¤§, å› ä¸ºéœ€è¦å¡«å……ç¼“å†²åŒºã€‚
- æ–¹æ³•ç”¨äºè¯»å–æ‰€æœ‰è¡Œ(ç›´åˆ°ç»“æŸç¬¦ EOF)å¹¶è¿”å›åˆ—è¡¨ï¼Œè¯¥åˆ—è¡¨å¯ä»¥ç”± Python çš„ for... in ... ç»“æ„è¿›è¡Œå¤„ç†ã€‚ å¦‚æœç¢°åˆ°ç»“æŸç¬¦ EOF åˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚
- å¦‚æœç¢°åˆ°ç»“æŸç¬¦ EOF åˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚

```py
1. for loop: iterates through each line of the file
   will contain the current line of the file as a "string of characters".

    for line in myFile.readlines():
        statement1
        statement2
        ...


2. split() method: break each line into a list.

     olypmicsfile = open("olypmics.txt", "r")

     for aline in olypmicsfile.readlines():
         values = aline.split(",")
         print(values)
     ['Name', 'Sex', 'Age', 'Team', 'Event', 'Medal\n']


     print(olypmicsfile)
     <openfile 'olypmics.txt', mode 'r'>
     for aline in olypmicsfile:
         values = aline.split(",")
         print(values)
     ['Name', 'Sex', 'Age', 'Team', 'Event', 'Medal\n']

     olypmicsfile.close()




3. result is a list!!!

    This summer I will be travelling.
    I will go to...
    Italy: Rome
    print(open("travel_plans2.txt").readlines(  ))

    ['This summer I will be travelling.\n', 'I will go to...\n', 'Italy: Rome\n']

  +  count = len(open(thefilepath).readlines(  ))

  +  count = 0
     for line in open(thefilepath).readlines(  ): count += 1

  +  count = 0
     thefile = open(thefilepath, 'rb')
     while 1:
         buffer = thefile.read(8192*1024)
         if not buffer: break
         count += buffer.count('\n')
     thefile.close(  )

```

---

## file.`seek(offset[, whence])`

ç§»åŠ¨æ–‡ä»¶è¯»å–æŒ‡é’ˆåˆ°æŒ‡å®šä½ç½®
- `offset`: å¼€å§‹çš„åç§»é‡ï¼Œä¹Ÿå°±æ˜¯ä»£è¡¨éœ€è¦ç§»åŠ¨åç§»çš„å­—èŠ‚æ•°ï¼Œå¦‚æœæ˜¯è´Ÿæ•°è¡¨ç¤ºä»å€’æ•°ç¬¬å‡ ä½å¼€å§‹ã€‚
- `whence`ï¼šå¯é€‰ï¼Œé»˜è®¤å€¼ä¸º 0ã€‚ç»™ offset å®šä¹‰ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºè¦ä»å“ªä¸ªä½ç½®å¼€å§‹åç§»ï¼›0 ä»£è¡¨ä»æ–‡ä»¶å¼€å¤´å¼€å§‹ç®—èµ·ï¼Œ1 ä»£è¡¨ä»å½“å‰ä½ç½®å¼€å§‹ç®—èµ·ï¼Œ2 ä»£è¡¨ä»æ–‡ä»¶æœ«å°¾ç®—èµ·ã€‚

```py

1.
    >>> f = open('workfile', 'rb+')
    >>> f.write(b'0123456789abcdef')
    16
    >>> f.seek(5)      # ç§»åŠ¨åˆ°æ–‡ä»¶çš„ç¬¬å…­ä¸ªå­—èŠ‚
    5
    >>> f.read(1)
    b'5'
    >>> f.seek(-3, 2)  # ç§»åŠ¨åˆ°æ–‡ä»¶å€’æ•°ç¬¬ä¸‰ä¸ªå­—èŠ‚
    13
    >>> f.read(1)
    b'd'

2.
    # æ–‡ä»¶ runoob.txt çš„å†…å®¹å¦‚ä¸‹ï¼š
    1:www.runoob.com
    2:www.runoob.com
    3:www.runoob.com
    4:www.runoob.com
    5:www.runoob.com
    # å¾ªç¯è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼š
    fo = open("runoob.txt", "r+")
    print ("æ–‡ä»¶åä¸º: ", fo.name)
    line = fo.readline()
    print ("è¯»å–çš„æ•°æ®ä¸º: %s" % (line))

    fo.seek(0, 0)         # é‡æ–°è®¾ç½®æ–‡ä»¶è¯»å–æŒ‡é’ˆåˆ°å¼€å¤´
    line = fo.readline()
    print ("è¯»å–çš„æ•°æ®ä¸º: %s" % (line))
    fo.close()
    # ç»“æœä¸ºï¼š
    æ–‡ä»¶åä¸º:  runoob.txt
    è¯»å–çš„æ•°æ®ä¸º: 1:www.runoob.com

    è¯»å–çš„æ•°æ®ä¸º: 1:www.runoob.com
```

### file.tell()
è¿”å›æ–‡ä»¶çš„å½“å‰ä½ç½®ï¼Œå³æ–‡ä»¶æŒ‡é’ˆå½“å‰ä½ç½®ã€‚

```py
# æ–‡ä»¶ runoob.txt çš„å†…å®¹å¦‚ä¸‹ï¼š
1:www.runoob.com
2:www.runoob.com
3:www.runoob.com
4:www.runoob.com
5:www.runoob.com
# å¾ªç¯è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼š
fo = open("runoob.txt", "r+")
print ("æ–‡ä»¶åä¸º: ", fo.name)
line = fo.readline()
print ("è¯»å–çš„æ•°æ®ä¸º: %s" % (line))

pos = fo.tell()        # è·å–å½“å‰æ–‡ä»¶ä½ç½®
print ("å½“å‰ä½ç½®: %d" % (pos))
fo.close()
# ç»“æœä¸ºï¼š
æ–‡ä»¶åä¸º:  runoob.txt
è¯»å–çš„æ•°æ®ä¸º: 1:www.runoob.com

å½“å‰ä½ç½®: 17
```

### file.truncate([size])

ä»æ–‡ä»¶çš„é¦–è¡Œé¦–å­—ç¬¦å¼€å§‹æˆªæ–­
- æˆªæ–­æ–‡ä»¶ä¸º size ä¸ªå­—ç¬¦ï¼Œæ—  size è¡¨ç¤ºä»å½“å‰ä½ç½®æˆªæ–­ï¼›
- æˆªæ–­ä¹‹ååé¢çš„æ‰€æœ‰å­—ç¬¦è¢«åˆ é™¤ï¼Œå…¶ä¸­ Widnows ç³»ç»Ÿä¸‹çš„æ¢è¡Œä»£è¡¨2ä¸ªå­—ç¬¦å¤§å°ã€‚

```py
# æ–‡ä»¶ runoob.txt çš„å†…å®¹å¦‚ä¸‹ï¼š
1:www.runoob.com
2:www.runoob.com
3:www.runoob.com
4:www.runoob.com
5:www.runoob.com

# å¾ªç¯è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼š
      fo = open("runoob.txt", "r+")
      print ("æ–‡ä»¶å: ", fo.name)
      line = fo.readline()
      print ("è¯»å–è¡Œ: %s" % (line))

      fo.truncate()
      line = fo.readlines()
      print ("è¯»å–è¡Œ: %s" % (line))
      fo.close()
      # ç»“æœä¸ºï¼š
      æ–‡ä»¶å:  runoob.txt
      è¯»å–è¡Œ: 1:www.runoob.com

      è¯»å–è¡Œ: ['2:www.runoob.com\n', '3:www.runoob.com\n', '4:www.runoob.com\n', '5:www.runoob.com\n']

# æˆªå– runoob.txt æ–‡ä»¶çš„10ä¸ªå­—èŠ‚ï¼š
      fo = open("runoob.txt", "r+")
      print ("æ–‡ä»¶åä¸º: ", fo.name)
      fo.truncate(10)    # æˆªå–10ä¸ªå­—èŠ‚
      str = fo.read()
      print ("è¯»å–æ•°æ®: %s" % (str))
      fo.close()
      # ç»“æœä¸ºï¼š
      æ–‡ä»¶åä¸º:  runoob.txt
      è¯»å–æ•°æ®: 1:www.runo
```

----

## `Write` Text Files

### (filename, "w") > file.`write(string)`: will overwrite

the `write` method takes one parameter, a string.
- the `write()` method can only accept a `string` as input.
- When invoked, the characters of the string will be added to the end of the file.

å‘æ–‡ä»¶ä¸­å†™å…¥æŒ‡å®šå­—ç¬¦ä¸²ã€‚è¿”å›çš„æ˜¯å†™å…¥çš„å­—ç¬¦é•¿åº¦ã€‚
- åœ¨æ–‡ä»¶å…³é—­å‰æˆ–ç¼“å†²åŒºåˆ·æ–°å‰ï¼Œå­—ç¬¦ä¸²å†…å®¹å­˜å‚¨åœ¨ç¼“å†²åŒºä¸­ï¼Œè¿™æ—¶åœ¨æ–‡ä»¶ä¸­æ˜¯çœ‹ä¸åˆ°å†™å…¥çš„å†…å®¹çš„ã€‚
- å¦‚æœæ–‡ä»¶æ‰“å¼€æ¨¡å¼å¸¦ `b`ï¼Œé‚£å†™å…¥æ–‡ä»¶å†…å®¹æ—¶ï¼Œ`str` (å‚æ•°)è¦ç”¨ encode æ–¹æ³•è½¬ä¸º bytes å½¢å¼ï¼Œå¦åˆ™æŠ¥é”™ï¼šTypeError: a bytes-like object is required, not 'str'ã€‚

```py
filename = "squared_numbers.txt"
outfile = open(filename, "w")

for number in range(1, 13):
    square = number * number
    outfile.write(str(square) + "\n")

outfile.close()

infile = open(filename, "r")
print(infile.read()[:12])
infile.close()
#
1
4
9
16
25
```


### file.writelines(sequence)

å‘æ–‡ä»¶å†™å…¥ä¸€ä¸ªåºåˆ—å­—ç¬¦ä¸²åˆ—è¡¨
- è¿™ä¸€åºåˆ—å­—ç¬¦ä¸²å¯ä»¥æ˜¯ç”±è¿­ä»£å¯¹è±¡äº§ç”Ÿçš„ï¼Œå¦‚ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ã€‚
- å¦‚æœéœ€è¦æ¢è¡Œåˆ™è¦åŠ å…¥æ¯è¡Œçš„æ¢è¡Œç¬¦ \nã€‚

```py
fo = open("test.txt", "w")
seq = ["èœé¸Ÿæ•™ç¨‹ 1\n", "èœé¸Ÿæ•™ç¨‹ 2"]
fo.writelines( seq )
fo.close()
# æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼š
$ cat test.txt
èœé¸Ÿæ•™ç¨‹ 1
èœé¸Ÿæ•™ç¨‹ 2
```


### (filename, "a") > file.`write(string)`: append contents

Python doesnâ€™t erase the contents of the file before returning the file object.
- Any lines you write to the file will be added at the end of the file.
- If the file doesnâ€™t exist yet, Python will create an empty file for you.

```py
filename = 'programming.txt'
with open(filename, 'a') as file_object:
    file_object.write("I love cat.\n")
    file_object.write("I love dog.\n")
```

---

# 10.12. ğŸ‘©â€ğŸ’» Tips on Handling Files

1. When naming files, not include spaces. While most operating systems can handle files with spaces in their names, not all can.

2. keep the suffixes in files names clear. txt, csc, exe.


---

# example:


1. Read in the contents of the file SP500.txt which has monthly data for 2016 and 2017 about the S&P 500 closing prices as well as some other financial indicators, including the â€œLong Term Interest Rateâ€, which is interest rate paid on 10-year U.S. government bonds.
Write a program that computes the average closing price (the second column, labeled SP500) and the highest long-term interest rate. Both should be computed only for the period from June 2016 through May 2017. Save the results in the variables mean_SP and max_interest.

```py
# Date      SP500   Dividend,Earnings,Consumer Price Index,Long Interest Rate,Real Price,Real Dividend,Real Earnings  PE10
# 1/1/2016  1918.6   43.55     86.5     236.92                  2.09            2023.23       45.93       91.22         24.21

file="SP500.txt"
meanls=[]
interestlst=[]
turn=5
with open(file) as a:
    for i in range(turn+1):
        print(a.readline())
    for line in a:
        wrds=line.split(",")
        turn+=1
        if turn==6:
            mean_SP=(float(wrds[1])/(turn-5))
            print(wrds[1],mean_SP)
            max_interest=wrds[5]
        elif turn>6 and turn<18:
            mean_SP=((mean_SP*(turn-6)+float(wrds[1]))/(turn-5))
            print(wrds[1],mean_SP)
            if wrds[5]>max_interest:
                max_interest= wrds[5]
        else: print(line)
    max_interest=float(max_interest)
       # meanlst.append(wrds[1])
       # interestlst.append(wrds[5])


# Data file: SP500.txt
Date,SP500,Dividend,Earnings,Consumer Price Index,Long Interest Rate,Real Price,Real Dividend,Real Earnings,PE10
1/1/2016,1918.6,43.55,86.5,236.92,2.09,2023.23,45.93,91.22,24.21
2/1/2016,1904.42,43.72,86.47,237.11,1.78,2006.62,46.06,91.11,24
3/1/2016,2021.95,43.88,86.44,238.13,1.89,2121.32,46.04,90.69,25.37
4/1/2016,2075.54,44.07,86.6,239.26,1.81,2167.27,46.02,90.43,25.92
5/1/2016,2065.55,44.27,86.76,240.23,1.81,2148.15,46.04,90.23,25.69
6/1/2016,2083.89,44.46,86.92,241.02,1.64,2160.13,46.09,90.1,25.84
7/1/2016,2148.9,44.65,87.64,240.63,1.5,2231.13,46.36,91,26.69
8/1/2016,2170.95,44.84,88.37,240.85,1.56,2251.95,46.51,91.66,26.95
9/1/2016,2157.69,45.03,89.09,241.43,1.63,2232.83,46.6,92.19,26.73
10/1/2016,2143.02,45.25,90.91,241.73,1.76,2214.89,46.77,93.96,26.53
11/1/2016,2164.99,45.48,92.73,241.35,2.14,2241.08,47.07,95.99,26.85
12/1/2016,2246.63,45.7,94.55,241.43,2.49,2324.83,47.29,97.84,27.87
1/1/2017,2275.12,45.93,96.46,242.84,2.43,2340.67,47.25,99.24,28.06
2/1/2017,2329.91,46.15,98.38,243.6,2.42,2389.52,47.33,100.89,28.66
3/1/2017,2366.82,46.38,100.29,243.8,2.48,2425.4,47.53,102.77,29.09
4/1/2017,2359.31,46.66,101.53,244.52,2.3,2410.56,47.67,103.74,28.9
5/1/2017,2395.35,46.94,102.78,244.73,2.3,2445.29,47.92,104.92,29.31
6/1/2017,2433.99,47.22,104.02,244.96,2.19,2482.48,48.16,106.09,29.75
7/1/2017,2454.1,47.54,105.04,244.79,2.32,2504.72,48.52,107.21,30
8/1/2017,2456.22,47.85,106.06,245.52,2.21,2499.4,48.69,107.92,29.91
9/1/2017,2492.84,48.17,107.08,246.82,2.2,2523.31,48.76,108.39,30.17
10/1/2017,2557,48.42,108.01,246.66,2.36,2589.89,49.05,109.4,30.92
11/1/2017,2593.61,48.68,108.95,246.67,2.35,2626.9,49.3,110.35,31.3
12/1/2017,2664.34,48.93,109.88,246.52,2.4,2700.13,49.59,111.36,32.09
```





.
