# Iteration

[toc]

## Iteration define

A `basic building block` of all programs is to be able to `repeat` some code over and over again.

> - updating the bank info of millions customers each night
> - sending email messages to thousands of people
> - programming involves instructing the computer to do many repetitive actions.

In computing, we refer to this `repetitive execution` as `iteration`.

---

# loop

`loop variables`: for `i` in [xxxx]

`while`
- *indefinite* Iteration: don't know how many times need to repeat. when it depends on something that happens during the execution.
- åœ¨ç»™å®šçš„åˆ¤æ–­æ¡ä»¶ä¸º true æ—¶æ‰§è¡Œå¾ªç¯ä½“ï¼Œå¦åˆ™é€€å‡ºå¾ªç¯ä½“ã€‚


`for`
- *definite* Iteration: whenever it will be known at the beginning of the iteration process how many times the block of code needs to be executed.
- é‡å¤æ‰§è¡Œè¯­å¥

You can rewrite any for-loop as a while-loop.

## Flow of Execution of the for Loop
As a program executes, the interpreter always keeps track of which statement is about to be executed. We call this the `control flow`, or the `flow of execution` of the program.


## `while`


```py
while conditionï¼š
    statements

# åŒæ ·éœ€è¦æ³¨æ„å†’å·å’Œç¼©è¿›
# åœ¨ Python ä¸­æ²¡æœ‰ do..while å¾ªç¯ã€‚
```

indefinite Iteration: don't know how many times need to repeat.


the flow of execution for a while statement:
- Evaluate the condition, yielding `False` or `True`.
- If the condition is `False`, exit the while statement and continue execution at the next statement.
- If the condition is `True`, execute each of the statements in the body and then go back to step 1.
  - ä»»ä½• éé›¶ã€æˆ–éç©ºï¼ˆnullï¼‰çš„å€¼ å‡ä¸º *true* ã€‚

æ‰§è¡Œè¯­å¥å¯ä»¥æ˜¯å•ä¸ªè¯­å¥æˆ–è¯­å¥å—ã€‚
- The body of the loop should change the value of one or more variables so that eventually the condition becomes False and the loop terminates.
- Otherwise the loop will repeat forever, `infinite loop`.



```py

0. ç®€å•è¯­å¥ç»„
   å¦‚æœ while å¾ªç¯ä½“ä¸­åªæœ‰ä¸€æ¡è¯­å¥ï¼Œå¯ä»¥å°†è¯¥è¯­å¥ä¸whileå†™åœ¨åŒä¸€è¡Œä¸­

    flag = 1
    while (flag): print ("Given flag is really true!")

1.

    def sumTo(aBound):
        """ Return the sum of 1+2+3 ... n """
        theSum  = 0
        aNumber = 1
        while aNumber <= aBound:
            theSum = theSum + aNumber
            aNumber = aNumber + 1
        return theSum

    print(sumTo(4))
    print(sumTo(1000))

2.

    count = 0
    while (count < 9):
       print 'The count is:', count
       count = count + 1
    print "Good bye!"
    # ç»“æœ:
    The count is: 0
    The count is: 1
    The count is: 2
    The count is: 3
    The count is: 4
    The count is: 5
    The count is: 6
    The count is: 7
    The count is: 8
    Good bye!


3. è®¾ç«‹èŒƒå›´çš„è¦åœ¨å‰é¢

    def stop_at_four(lst):
      turn=0
      nlist=[]
   #  while lst[turn] != 4 and turn < len(lst): error
      while turn < len(lst) and lst[turn] != 4:
        nlist.append(lst[turn])
        turn+=1
      return nlist

    def stop_at_four(input_list):
        output_list = []
        index = 0
        while index < len(input_list) and input_list[index] != 4:
            output_list.append(input_list[index])
            index += 1
        return output_list


4. while â€¦ else åœ¨å¾ªç¯æ¡ä»¶ä¸º false æ—¶æ‰§è¡Œ else è¯­å¥å—ï¼š

    count = 0
    while count < 5:
       count = count + 1
    else:
       print(count, " is more than 5")
```

---

## Other uses of `while`:

### 14.3 `listener` loop
get user input and repeats loop indefinitely, until a particular input is received.

```py
    theSum = 0
    x = -1
    while (x != 0):
        x = int(input("number to add up (enter 0 if no more numbers): "))
        theSum = theSum + x

    print(theSum)
```

### 14.3.1.1. `Sentinel Values`

Indefinite loops are much more common in the real world than definite loops.
  - selling ticket
  - unloads a plane
  - checkout line at the grocery, the clerks donâ€™t know in advance how many items there are. They just keep ringing up items as long as there are more on the conveyor belt.

if no option to set `while` to False, it would run forever.

`sentinel å®ˆå« value`: value used to signal the end of the loop.
- checkout line: use a price of zero to mean â€œthis is my last item.â€ In this program, zero is a `sentinel å®ˆå« value`.

```py
def checkout():
    total = 0
    count = 0
    moreItems = True    ###
    while moreItems:
        price = float(input('Enter price of item (0 when done): '))
        if price != 0:
            count = count + 1
            total = total + price
            print('Subtotal: $', total)
        else:
            moreItems = False   ###

    average = total / count
    print('Total items:', count)
    print('Total $', total)
    print('Average price per item: $', average)

checkout()
```

few problems with this program
- enter a negative number, it will be added to the total and count. Modify the code so that negative numbers give an error message instead (but donâ€™t end the loop) Hint: elif is your friend.
- If enter zero at the first time, error, try to divide by zero. Use an if/else statement outside the loop to avoid the division by zero and tell the user that you canâ€™t compute an average without data.
- doesnâ€™t display the amounts to two decimal places. Youâ€™ll be introduced to that in another chapter.

### 14.3.1.2. Validating Input
can also use a `while` loop when you want to `validate input`

```py

# Validating Input
def get_yes_or_no(message):
    valid_input = False
    # use not false to loop.
    while not valid_input:
        answer = input(message)
        answer = answer.upper() # convert to upper case
        if answer == 'Y' or answer == 'N':
            valid_input = True
        else:
            print('Please enter Y for yes or N for no.')
    return answer

# Validating Input
response = get_yes_or_no('Do you like lima beans? Y)es or N)o: ')

# give the output
if response == 'Y':
    print('Great! They are very healthy.')
else:
    print('Too bad. If cooked right, they are quite tasty.')
```



### continue å’Œ break ç”¨æ³•
* continue ç”¨äºè·³è¿‡è¯¥æ¬¡å¾ªç¯ï¼Œ
* break åˆ™æ˜¯ç”¨äºé€€å‡ºå¾ªç¯ï¼Œ
æ­¤å¤–"åˆ¤æ–­æ¡ä»¶"è¿˜å¯ä»¥æ˜¯ä¸ªå¸¸å€¼ï¼Œè¡¨ç¤ºå¾ªç¯å¿…å®šæˆç«‹ï¼Œå…·ä½“ç”¨æ³•å¦‚ä¸‹ï¼š

```py
i = 1
while i < 10:
    i += 1
    if i%2 > 0:     # éåŒæ•°æ—¶è·³è¿‡è¾“å‡º
        continue
    print i         # è¾“å‡ºåŒæ•°2ã€4ã€6ã€8ã€10

i = 1
while 1:            # å¾ªç¯æ¡ä»¶ä¸º1å¿…å®šæˆç«‹
    print i         # è¾“å‡º1~10
    i += 1
    if i > 10:      # å½“iå¤§äº10æ—¶è·³å‡ºå¾ªç¯
        break
```


### turtle

```py
import turtle
import random

# assume 90%, the turtle is in the window, 10%, the turtle has escaped.
def isInScreen(w, t):
    if random.random() > 0.1:
        return True
    else:
        return False

# find out the width and the height of the screen
def isInScreen(wn,t):
    leftBound = -(wn.window_width() / 2)
    rightBound = wn.window_width() / 2
    topBound = wn.window_height() / 2
    bottomBound = -(wn.window_height() / 2)

    turtleX = t.xcor()
    turtleY = t.ycor()

    stillIn = True
    if turtleX > rightBound or turtleX < leftBound:
        stillIn = False
    if turtleY > topBound or turtleY < bottomBound:
        stillIn = False

    return stillIn


t = turtle.Turtle()
wn = turtle.Screen()
t.shape('turtle')

while isInScreen(wn, t):
    coin = random.randrange(0, 2)
    if coin == 0:       # 0=heads
        t.left(90)
    else:               # 1=tails
        t.right(90)
    t.forward(50)

wn.exitonclick()

```

### assignment

Write a function called beginning that takes a list as input and contains a while loop that only stops once the element of the list is the string â€˜byeâ€™. What is returned is a list that contains up to the first 10 strings, regardless of where the loop stops. (i.e., if it stops on the 32nd element, the first 10 are returned. If â€œbyeâ€ is the 5th element, the first 4 are returned.) If you want to make this even more of a challenge, do this without slicing

```py
def beginning(a):
    print(a)
    n=0
    lst=[]
    while n!=10 and a[n]!="bye":
        lst=a[:n+1]
        n+=1
    print(lst)
    return lst
```

---


## `for` statement

use `for` statement to write programs that implement `iteration`.
- forå¾ªç¯å¯ä»¥éå†ä»»ä½•åºåˆ—çš„é¡¹ç›®ï¼Œå¦‚ä¸€ä¸ªåˆ—è¡¨æˆ–è€…ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚
- `for` statement is a `compound statement`. The level of indentation å‡¹è¿›,ç¼©æ ¼ of a (whole) compound statement is the indentation of its heading.

```py
  for loop/iterator.variable in iterable.sequence(string/list/tuple):
     loop body statements(s)

   # Python is unable to iterate over integers and floats.
   y = 18
   for z in y:
       print(z)
```

`iterator/loop variable` vs `iterable`:
- Each time the loop iterates, the value of the `iterator variable` will change to a different portion of the `iterable`.
  - The `iterable`: the object that you will parsing through in a for loop. Generally, does not change while the for loop is being executed.
  - The `iterator/loop variable`: the variable which stores a portion of the iterable when the for loop is being executed.


On each `iteration` or `pass` of the `loop`
- first a check is done to see if there are still more items to be processed.
- If there are none left (`terminating condition` of the loop), the loop has finished. Program execution continues at the next statement after the loop body.
- If there are items still to be processed, the loop variable is updated to refer to the next item in the list.
- At the end of each execution of the body of the loop, Python returns to the for statement, to see if there are more items to be handled.


iteration_vs_hardcoding

![iteration_vs_hardcoding](https://i.imgur.com/JbM8sGI.png)


1. type of sequence iteration: `iteration by item`

```py
      for letter in 'Python':
         print('current letter', letter)
      # result
      å½“å‰å­—æ¯ : P
      å½“å‰å­—æ¯ : y
      ...
```

2. perform `list traversal` using iteration by item

```py
      for fruit in ['banana', 'BigBlueberry', 'mango']:
         print('current fruit', fruit)
      #ç»“æœ:
      å½“å‰æ°´æœ : banana
      å½“å‰æ°´æœ : apple
      å½“å‰æ°´æœ : mango
```

3. Use the `range` Function to Generate a Sequence to Iterate

```py
      for _ in range(3):
          print("This line will execute three times")

      s = "python"
      for idx in range(len(s)):
          print(s[idx % 2])
      # result
      p
      y
      p
      y
      p
      y
```

4. é€šè¿‡ `åºåˆ—` ç´¢å¼•è¿­ä»£

```py
      fruits = ['banana', 'BigBlueberry',  'mango']
      for index in range(len(fruits)):
         print('current fruit', fruits[index])
```

5. The `Accumulator` Pattern, accumulating a value as we go.

The anatomy of the accumulation pattern includes:
    - `initializing` an â€œaccumulatorâ€ variable to an initial value (such as 0 if accumulating a sum)
    - `iterating` (e.g., traversing the items in a sequence)
    - `updating` the accumulator variable on each iteration (i.e., when processing each item in the sequence)

```py
accum = 0
for w in [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]:
    accum = accum + w
```

This pattern of iterating the updating of a variable: `accumulator pattern`.
the variable `accum`: the `accumulator` ç§¯èšè€….


### `for i in X: for j in Y:`

```py
for i in range(5):
    for j in range(3):
        print(i, j)
```

The `for i` iteration is the `outer iteration`

the `for j` iteration is the `inner iteration`.

Each pass through the outer iteration will result in the complete processing of the inner iteration from beginning to end.
- for each value of i, all values of j will occur.

### `for...else` è¯­å¥
for ä¸­çš„è¯­å¥å’Œæ™®é€šçš„æ²¡æœ‰åŒºåˆ«ï¼Œelse ä¸­çš„è¯­å¥ä¼šåœ¨å¾ªç¯æ­£å¸¸æ‰§è¡Œå®Œï¼ˆå³ for ä¸æ˜¯é€šè¿‡ break è·³å‡ºè€Œä¸­æ–­çš„ï¼‰çš„æƒ…å†µä¸‹æ‰§è¡Œ

```py
for num in range(10,20):  # è¿­ä»£ 10 åˆ° 20 ä¹‹é—´çš„æ•°å­—
   for i in range(2,num): # æ ¹æ®å› å­è¿­ä»£
      if num%i == 0:      # ç¡®å®šç¬¬ä¸€ä¸ªå› å­
         j=num/i          # è®¡ç®—ç¬¬äºŒä¸ªå› å­
         print '%d ç­‰äº %d * %d' % (num,i,j)
         break            # è·³å‡ºå½“å‰å¾ªç¯
   else:                  # å¾ªç¯çš„ else éƒ¨åˆ†
      print num, 'æ˜¯ä¸€ä¸ªè´¨æ•°'
#ç»“æœï¼š
10 ç­‰äº 2 * 5
11 æ˜¯ä¸€ä¸ªè´¨æ•°
12 ç­‰äº 2 * 6
13 æ˜¯ä¸€ä¸ªè´¨æ•°
14 ç­‰äº 2 * 7
15 ç­‰äº 3 * 5
16 ç­‰äº 2 * 8
17 æ˜¯ä¸€ä¸ªè´¨æ•°
18 ç­‰äº 2 * 9
19 æ˜¯ä¸€ä¸ªè´¨æ•°
```

---

## 14.6. ğŸ‘©â€ğŸ’» Infinite Loops
å¦‚æœæ¡ä»¶åˆ¤æ–­è¯­å¥æ°¸è¿œä¸º true ï¼Œå¾ªç¯å°†ä¼šæ— é™çš„æ‰§è¡Œä¸‹å».
- æ— é™å¾ªç¯ç”¨ `CTRL+C` æ¥ä¸­æ–­å¾ªç¯ã€‚

```py

while True:
    print("Will this stop?")

print("We have escaped.")


var = 1
while var == 1 :  # æ¡ä»¶æ°¸è¿œä¸ºtrueï¼Œå¾ªç¯æ— é™æ‰§è¡Œ
   num = raw_input("Enter a number  :")
   print "You entered: ", num
print "Good bye!"
```

how can you determine if your code is just talking a while or if it is stuck inside an infinite loop.
- add `print` statements to keep track of how your variables are changing as the program processes the instructions given to them.

---

## å¾ªç¯æ§åˆ¶è¯­å¥
æ§åˆ¶è¯­å¥
- `break`: ç»ˆæ­¢å¾ªç¯ï¼Œå¹¶ä¸”è·³å‡ºæ•´ä¸ªå¾ªç¯
- `continue`: ç»ˆæ­¢å½“å‰å¾ªç¯ï¼Œè·³å‡ºè¯¥æ¬¡å¾ªç¯ï¼Œæ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯ã€‚
- `pass`: passæ˜¯ç©ºè¯­å¥ï¼Œæ˜¯ä¸ºäº†ä¿æŒç¨‹åºç»“æ„çš„å®Œæ•´æ€§ã€‚


### `break` è¯­å¥

![while_and_break](https://i.imgur.com/3ZkgMf3.png)

- æ‰“ç ´äº†æœ€å°å°é—­foræˆ–whileå¾ªç¯ã€‚
- ç”¨æ¥ç»ˆæ­¢å¾ªç¯è¯­å¥ï¼Œå³å¾ªç¯æ¡ä»¶æ²¡æœ‰Falseæ¡ä»¶æˆ–è€…åºåˆ—è¿˜æ²¡è¢«å®Œå…¨é€’å½’å®Œï¼Œä¹Ÿä¼šåœæ­¢æ‰§è¡Œå¾ªç¯è¯­å¥ã€‚
- ç”¨åœ¨whileå’Œforå¾ªç¯ä¸­ã€‚
- å¦‚æœä½¿ç”¨åµŒå¥—å¾ªç¯ï¼Œbreakè¯­å¥å°†åœæ­¢æ‰§è¡Œæœ€æ·±å±‚çš„å¾ªç¯ï¼Œå¹¶å¼€å§‹æ‰§è¡Œä¸‹ä¸€è¡Œä»£ç 

```py
while True:
    print("this phrase will always print")
    break
    print("Does this phrase print?")

print("We are done with the while loop.")
#
this phrase will always print
We are done with the while loop.
```

---

### continue è¯­å¥

`break` è·³å‡ºæ•´ä¸ªå¾ªç¯ã€‚

`continue` è·³å‡ºæœ¬æ¬¡å¾ªç¯ï¼Œ
- *åˆ é™¤* çš„æ•ˆæœ, ä¸ºäº† *åˆ é™¤æ»¡è¶³å¾ªç¯æ¡ä»¶ä¸‹çš„æŸäº›ä¸éœ€è¦çš„æˆåˆ†*
- è·³è¿‡å½“å‰å¾ªç¯çš„å‰©ä½™è¯­å¥ï¼Œç„¶åç»§ç»­è¿›è¡Œä¸‹ä¸€è½®å¾ªç¯ã€‚
- ç”¨åœ¨whileå’Œforå¾ªç¯ä¸­ã€‚

![while_and_continue](https://i.imgur.com/Bt69iBd.png)


```py

1.

    for letter in 'Python':
       if letter == 'h':
          continue
       print 'å½“å‰å­—æ¯ :', letter
    #
    å½“å‰å­—æ¯ : P
    å½“å‰å­—æ¯ : y
    å½“å‰å­—æ¯ : t
    å½“å‰å­—æ¯ : o
    å½“å‰å­—æ¯ : n


2. åªæ‰“å°0-10ä¹‹é—´çš„å¥‡æ•°ï¼š

    n = 0
    while n < 10:
        n = n + 1
        if n % 2 == 0:    # å¦‚æœnæ˜¯å¶æ•°ï¼Œæ‰§è¡Œcontinueè¯­å¥
            continue      # print()è¯­å¥ä¸ä¼šæ‰§è¡Œ
        print(n)
```

---

### Python pass è¯­å¥

ç©ºè¯­å¥ï¼Œä¸ºäº†ä¿æŒç¨‹åºç»“æ„çš„å®Œæ•´æ€§ã€‚
- ä¸åšä»»ä½•äº‹æƒ…
- ä¸€èˆ¬ç”¨äºå ä½ç½®ã€‚

```py

1. åœ¨ Python ä¸­æœ‰æ—¶å€™ä¼šçœ‹åˆ°ä¸€ä¸ª def å‡½æ•°:
   è¯¥å¤„çš„ pass ä¾¿æ˜¯å æ®ä¸€ä¸ªä½ç½®ï¼Œ
   å› ä¸ºå¦‚æœå®šä¹‰ä¸€ä¸ªç©ºå‡½æ•°ç¨‹åºä¼šæŠ¥é”™ï¼Œ
   æ²¡æœ‰æƒ³å¥½å‡½æ•°çš„å†…å®¹, ç”¨ pass å¡«å……ï¼Œä½¿ç¨‹åºå¯ä»¥æ­£å¸¸è¿è¡Œã€‚

    def sample(n_samples):
        pass

2.

    for letter in 'Python':
       if letter == 'h':
          pass
          print 'è¿™æ˜¯ pass å—'
       print 'å½“å‰å­—æ¯ :', letter
    #ç»“æœï¼š
    å½“å‰å­—æ¯ : P
    å½“å‰å­—æ¯ : y
    å½“å‰å­—æ¯ : t
    è¿™æ˜¯ pass å—
    å½“å‰å­—æ¯ : h
    å½“å‰å­—æ¯ : o
    å½“å‰å­—æ¯ : n

```
