<?xml version="1.0" encoding="utf-8"?>

<feed xmlns="http://www.w3.org/2005/Atom" >
  <generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator>
  <link href="http://localhost:4000/tag/rl/feed.xml" rel="self" type="application/atom+xml" />
  <link href="http://localhost:4000/" rel="alternate" type="text/html" />
  <updated>2022-05-22T19:09:32+09:00</updated>
  <id>http://localhost:4000/tag/rl/feed.xml</id>

  
  
  

  
    <title type="html">Beanie in the wind | </title>
  

  
    <subtitle>Beanie &amp; Kaze&apos;s tech blog</subtitle>
  

  

  
    
      
    
      
    
  

  
  

  
    <entry>
      <title type="html">(ì‘ì„±ì¤‘) RecSys &amp;amp; RL - Top-ğ¾ Off-Policy Correction for a REINFORCE Recommender System</title>
      <link href="http://localhost:4000/RecSys-&-RL-Top-%F0%9D%90%BE-Off-Policy-Correction-for-a-REINFORCE-Recommender-System" rel="alternate" type="text/html" title="(ì‘ì„±ì¤‘) RecSys &amp; RL - Top-ğ¾ Off-Policy Correction for a REINFORCE Recommender System" />
      <published>2022-05-20T16:03:00+09:00</published>
      <updated>2022-05-20T16:03:00+09:00</updated>
      <id>http://localhost:4000/RecSys%20&amp;%20RL%20-%20Top-%F0%9D%90%BE%20Off-Policy%20Correction%20for%20a%20REINFORCE%20Recommender%20System</id>
      <content type="html" xml:base="http://localhost:4000/RecSys-&amp;-RL-Top-%F0%9D%90%BE-Off-Policy-Correction-for-a-REINFORCE-Recommender-System">&lt;p&gt;ì´ì „ì— ì½ì—ˆë˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A Deep Reinforcement Learning Framework for News Recommendation&lt;/code&gt; ë…¼ë¬¸ì€ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ ì½”ë“œë¥¼ ì°¾ê¸°ê°€ ì–´ë ¤ì› ë‹¤. ê·¸ë˜ì„œ ì•Œê³ ë¦¬ì¦˜ ì½”ë“œê°€ ê°™ì´ ìˆìœ¼ë©´ì„œ ì ë‹¹íˆ challengingí•œ ë…¼ë¬¸ì„ ë‹¤ì‹œ ì°¾ì•„ë³´ì•˜ê³  ì´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Top-ğ¾ Off-Policy Correction for a REINFORCE Recommender System&lt;/code&gt; ì´ ê°€ì¥ ê´œì°®ì•„ë³´ì—¬ ì½ì–´ë³´ì•˜ë‹¤. ì´í›„ ì—¬ëŸ¬ ìƒ˜í”Œ ì½”ë“œë¥¼ ì°¸ê³ í•˜ì—¬ public datasetìœ¼ë¡œ ì§ì ‘ êµ¬í˜„ê¹Œì§€ í•´ë³¼ ì˜ˆì •ì´ë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;ì£¼ìš”-contribution&quot;&gt;ì£¼ìš” Contribution&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;ì´ ë…¼ë¬¸ì˜ ì£¼ìš”í•œ ê¸°ì—¬ì ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;REINFORCE Recommender&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;Large, non-stationary state and action spaces&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Off-Policy Candidate Generation&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;RLì—ì„œ ì¶”ì²œì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ë°ì´í„°ì˜ ë¶€ì¡±ì´ íŠ¹íˆ ë¬¸ì œê°€ ëœë‹¤. ê³ ì „ì ì¸ RLì—ì„œëŠ” ì´ ë°ì´í„° ë¶€ì¡± ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ ë§ì€ ì–‘ì˜ training dataë¥¼ self-replayë‚˜ simulationì„ í†µí•´ ìˆ˜ì§‘í•˜ì˜€ë‹¤.
  í•˜ì§€ë§Œ ì¶”ì²œì‹œìŠ¤í…œ ë¬¸ì œì˜ ê²½ìš°, ë³µì¡í•˜ê²Œ ì–½í˜€ìˆëŠ” ì¶”ì²œì‹œìŠ¤í…œ í™˜ê²½ ë•Œë¬¸ì— simulationì„ í†µí•˜ì—¬ ë°ì´í„°ë¥¼ ì–»ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ë”°ë¼ì„œ rewardë¥¼ ê´€ì°°í•˜ëŠ” ê²ƒ ìì²´ê°€ ì‹¤ì œ ìœ ì €ì—ê²Œ ì‹¤ì œ ì¶”ì²œì„ ì œê³µí•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— íƒìƒ‰ë˜ì§€ ì•Šì€ ê³µê°„ì˜ state, action spaceì— ëŒ€í•˜ì—¬ rewardê°’ì„ ì‰½ê²Œ ì•Œì•„ë‚´ê¸° ì–´ë µë‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;
  Â &lt;/p&gt;

    &lt;p&gt;ë”°ë¼ì„œ ë³¸ ë…¼ë¬¸ì—ì„œëŠ”, &lt;strong&gt;ë‹¤ë¥¸ ì¶”ì²œì‹œìŠ¤í…œì´ë‚˜ ê³¼ê±°ì˜ policyì—ì„œ ì–»ì€ ìœ ì € feedbackì˜ ë¡œê·¸ë“¤ì„ í™œìš©í•˜ì—¬ Off-policy learningì„ ìˆ˜í–‰&lt;/strong&gt; í•œë‹¤. ì´ ë•Œ, ë‹¤ë¥¸ policyì—ì„œ ìˆ˜ì§‘í•˜ì˜€ê¸° ë•Œë¬¸ì— í•„ì—°ì ìœ¼ë¡œ ë°œìƒí•˜ëŠ” biasë¥¼ í•´ê²°í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í•™ìŠµí•œë‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Top-K Off-Policy Correction&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;ì‹¤ì œ ì¶”ì²œì‹œìŠ¤í…œ í™˜ê²½ì—ì„œëŠ” 1ê°œê°€ ì•„ë‹Œ ì—¬ëŸ¬ê°œì˜ ì¶”ì²œì„ ë™ì‹œì— ì œê³µí•´ì•¼ í•œë‹¤. ë”°ë¼ì„œ ë³¸ ë…¼ë¬¸ì—ì„œëŠ” top-K recommender systemì„ ìœ„í•œ ìƒˆë¡œìš´ top-K off-policy correctionì„ ì •ì˜í•œë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Benefits in Live Experiments&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;ì•„ì´í…œì— ëŒ€í•œ ìœ ì € ì„ í˜¸ë„ëŠ” ê³„ì† ë³€í•¨ -&amp;gt; ìœ ì € state ê°’ì´ ì§€ì†ì ìœ¼ë¡œ ë°”ë€ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;reinforce-recommender&quot;&gt;Reinforce Recommender&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;
&lt;h3 id=&quot;mdp-modeling&quot;&gt;MDP Modeling&lt;/h3&gt;
&lt;p&gt;ì¶”ì²œì‹œìŠ¤í…œì„ ê°•í™”í•™ìŠµ ì„¸íŒ…ì— ì í•©í•˜ê²Œ ë§ì¶°ë³´ì. ê°•í™”í•™ìŠµì„ ìœ„í•˜ì—¬ í™˜ê²½ì„ Markov Decision Process(MDP)ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;$S$ : ìœ ì € stateë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì—°ì†ì ì¸ state space&lt;/li&gt;
  &lt;li&gt;$A$ : ì¶”ì²œ ì•„ì´í…œ í›„ë³´êµ°ì„ í¬í•¨í•˜ê³  ìˆëŠ” discreteí•œ action space&lt;/li&gt;
  &lt;li&gt;$P$ : state transition probability ( $S \times A \times S \to \mathbb{R}$ )&lt;/li&gt;
  &lt;li&gt;$R$ : ë³´ìƒ í•¨ìˆ˜ ( $S \times A \to \mathbb{R}$ ), ì´ ë•Œ, $ r(s, a) $ ëŠ” ìœ ì € state sì—ì„œ action aë¥¼ í•  ë•Œ ë°”ë¡œ ì–»ì–´ì§€ëŠ” rewardë¥¼ ì˜ë¯¸í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;$ \rho_{0} $ : ì´ˆê¸° ìƒíƒœ ë¶„í¬&lt;/li&gt;
  &lt;li&gt;$ \gamma $ future rewardì— ëŒ€í•œ discount factor&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;policy-gradient&quot;&gt;Policy Gradient&lt;/h3&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;model-architecture&quot;&gt;Model Architecture&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;off-policy-correction&quot;&gt;Off-Policy Correction&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;top-k-recommendation&quot;&gt;Top-K Recommendation&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;exploration&quot;&gt;Exploration&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;experiment-results&quot;&gt;Experiment Results&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="RecSys" />
      
        <category term="RL" />
      
        <category term="paper" />
      

      
        <summary type="html">ì´ì „ì— ì½ì—ˆë˜ A Deep Reinforcement Learning Framework for News Recommendation ë…¼ë¬¸ì€ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ ì½”ë“œë¥¼ ì°¾ê¸°ê°€ ì–´ë ¤ì› ë‹¤. ê·¸ë˜ì„œ ì•Œê³ ë¦¬ì¦˜ ì½”ë“œê°€ ê°™ì´ ìˆìœ¼ë©´ì„œ ì ë‹¹íˆ challengingí•œ ë…¼ë¬¸ì„ ë‹¤ì‹œ ì°¾ì•„ë³´ì•˜ê³  ì´ Top-ğ¾ Off-Policy Correction for a REINFORCE Recommender System ì´ ê°€ì¥ ê´œì°®ì•„ë³´ì—¬ ì½ì–´ë³´ì•˜ë‹¤. ì´í›„ ì—¬ëŸ¬ ìƒ˜í”Œ ì½”ë“œë¥¼ ì°¸ê³ í•˜ì—¬ public datasetìœ¼ë¡œ ì§ì ‘ êµ¬í˜„ê¹Œì§€ í•´ë³¼ ì˜ˆì •ì´ë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Deep Q-Network(DQN) êµ¬í˜„</title>
      <link href="http://localhost:4000/Implement-DQN" rel="alternate" type="text/html" title="Deep Q-Network(DQN) êµ¬í˜„" />
      <published>2022-05-16T13:02:00+09:00</published>
      <updated>2022-05-16T13:02:00+09:00</updated>
      <id>http://localhost:4000/Implement%20DQN</id>
      <content type="html" xml:base="http://localhost:4000/Implement-DQN">&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;dqn-ì´ë€&quot;&gt;DQN ì´ë€?&lt;/h2&gt;
&lt;p&gt;Â 
ì´ì „ì— &lt;a href=&quot;&quot;&gt;(Reinforcement learning) Value Function Approximation í¬ìŠ¤íŒ…&lt;/a&gt;ì—ì„œ Value function approximationì— ëŒ€í•˜ì—¬ ë‹¤ë£¨ì—ˆë‹¤. ìš”ì•½í•˜ë©´ ê°•í™”í•™ìŠµì—ì„œ ê°„ë‹¨í•œ table í˜•íƒœë¡œ í•™ìŠµì„ í•˜ê²Œ ë˜ë©´ í•™ìŠµì´ ê·¹ë„ë¡œ ëŠë ¤ì§€ëŠ” ë¬¸ì œê°€ ìˆì–´ value functionì„ ë‹¤ì–‘í•˜ê²Œ ê·¼ì‚¬í•˜ì—¬ í™œìš©í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ëŸ¬í•œ approximatorë¡œ Neural Networkë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤. ì´ë²ˆ ê¸€ì—ì„œ ì†Œê°œí•  Deep Q-Networks(DQN)ì€ Q-learning ì•Œê³ ë¦¬ì¦˜ì˜ Q(Action-value) í•¨ìˆ˜ë¥¼ ë”¥ëŸ¬ë‹ìœ¼ë¡œ ê·¼ì‚¬í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ, DeepMindì—ì„œ ë°œí‘œí•œ &lt;a href=&quot;https://arxiv.org/pdf/1312.5602.pdf&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Playing Atari with Deep Reinforcement&lt;/code&gt;&lt;/a&gt; ë¼ëŠ” ì—°êµ¬ì—ì„œ ì œì•ˆë˜ì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ DQN ë…¼ë¬¸ì—ì„œëŠ” raw pixelì„ inputìœ¼ë¡œ ë°›ì•„, value function(â‰ˆfuture rewards)ë¥¼ outputìœ¼ë¡œ ë°˜í™˜í•˜ëŠ” Q-Learningì˜ parameterë¥¼ í•™ìŠµí•˜ëŠ” Convolutional Neural Network(CNN)ì„ ì‚¬ìš©í•˜ì˜€ë‹¤. ì¦‰, ê³ ì°¨ì›ì˜ sensory inputì„ í†µí•´ control policiesë¥¼ ë‹¤ì´ë ‰íŠ¸ë¡œ í•™ìŠµí•˜ëŠ” Deep learning modelì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ ì´ì „ì—ëŠ” ì™œ ê°•í™”í•™ìŠµì— ë”¥ëŸ¬ë‹ì„ í™œìš©í•˜ì§€ ëª»í–ˆì„ê¹Œ? ì‚¬ì‹¤ ë”¥ëŸ¬ë‹ê³¼ ê°•í™”í•™ìŠµì´ ê³ ì°¨ì›ì˜ ë°ì´í„°ë¥¼ í™œìš©í•˜ëŠ” ë°©ë²•ì€ ë¬´ì²™ ë‹¤ë¥´ë‹¤. ëª‡ê°€ì§€ ì˜ˆì‹œë¡œ&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Deep-Learning ê¸°ë°˜ ë°©ë²•ë“¤ì€ hand-labelled training datasetì„ í•„ìš”ë¡œ í•˜ì§€ë§Œ, Reinforcement Learningì—ì„œëŠ” ì˜¤ë¡œì§€ delayì™€ ë…¸ì´ì¦ˆê°€ í¬í•¨ëœ ìŠ¤ì¹¼ë¼ê°’ì¸ Rewardë§Œì„ í†µí•´ì„œ í•™ìŠµëœë‹¤. ë”ìš±ì´ë‚˜ ê·¸ reward ì¡°ì°¨ sparse, noisy, and delayí•œ ì„±ê²©ì„ ê°€ì§„ë‹¤.&lt;/li&gt;
  &lt;li&gt;Deep Learningì—ì„œëŠ” data sampleì´ i.i.dí•˜ë‹¤ëŠ” ê°€ì •ì´ ìˆë‹¤. í•˜ì§€ë§Œ, Reinforcement Learningì˜ ê²½ìš° í˜„ì¬ì˜ stateê°€ ì–´ë””ì¸ ì§€ì— ë”°ë¼ ê°€ëŠ¥í•œ ë‹¤ìŒ stateê°€ ê²°ì •ëœë‹¤. ì¦‰, ë…ë¦½ì ì´ì§€ ì•Šê³  ì¢…ì†ì ì´ë©°, stateê°„ì˜ correlation(ìƒê´€ê´€ê³„)ë˜í•œ í¬ë‹¤.&lt;/li&gt;
  &lt;li&gt;ì—ì´ì „íŠ¸ê°€ í•™ìŠµí•¨ì— ë”°ë¼ policyê°€ ë‹¬ë¼ì§€ë©´ì„œ, í•™ìŠµ ë°ì´í„°ì˜ ë¶„ì‚°(distribution) ìì²´ë„ ì‹œê°„ì— ë”°ë¼ ë³€í•œë‹¤. ë°˜ë©´ ë”¥ëŸ¬ë‹ì€ ê³ ì •ëœ ê¸°ë³¸ ë¶„ì‚°(fixed underlying distribution)ì„ ê°€ì •í•œë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì´ëŸ¬í•œ ê°•í™”í•™ìŠµì— ì´ìœ ë¡œ ë”¥ëŸ¬ë‹ ê¸°ë²•ì„ ì´ì „ì—ëŠ” ë°”ë¡œ ì ìš©í•˜ì§€ ëª»í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Playing Atari with Deep Reinforcement&lt;/code&gt; ë…¼ë¬¸ë„ ì˜ˆì™¸ì—†ì´ ì´ëŸ¬í•œ ë¬¸ì œì— ì§ë©´í–ˆëŠ”ë°, ë…¼ë¬¸ì—ì„œëŠ” ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•˜ì—¬ &lt;strong&gt;Experience replay&lt;/strong&gt; ì™€ &lt;strong&gt;Target network&lt;/strong&gt; ë¼ëŠ” ë°©ë²•ì„ ì œì•ˆí•˜ì˜€ë‹¤. ì´ ë‘ íŠ¹ì§•ì ì¸ ë°©ë²•ì„ í†µí•˜ì—¬ ì„±ê³µì ìœ¼ë¡œ ë”¥ëŸ¬ë‹ì„ ê°•í™”í•™ìŠµì— ì ìš©í•˜ì—¬ ê³ ì°¨ì› ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;experience-replay&quot;&gt;Experience replay&lt;/h3&gt;
&lt;p&gt;ë“¤ì–´ì˜¤ëŠ” ì…ë ¥ì„ ìˆœì„œëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ë°ì´í„° ê°„ì˜ ì—°ê´€ì„±ì´ ë„ˆë¬´ ì»¤ì§€ê²Œ ëœë‹¤. ë”°ë¼ì„œ ìµœê·¼ nê°œì˜ ë°ì´í„°ë¥¼ ê³„ì†í•´ì„œ ì €ì¥í•˜ê³ , ë„¤íŠ¸ì›Œí¬ë¥¼ í•™ìŠµí•  ë•ŒëŠ” ì €ì¥í•œ ë°ì´í„° ì¤‘ ëª‡ê°œë¥¼ ë¬´ì‘ìœ„ë¡œ ìƒ˜í”Œí•˜ì—¬ ì‚¬ìš©í•œë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;target-network&quot;&gt;Target network&lt;/h3&gt;
&lt;p&gt;Target network ì„¤ëª…ì€ &lt;a href=&quot;https://jsideas.net/dqn/&quot;&gt;https://jsideas.net/dqn/&lt;/a&gt;ì˜ ë‹¹ë‚˜ê·€ ì˜ˆì‹œê°€ ì´í•´í•˜ê¸° ì¢‹ì•˜ë‹¤. ì´ ë¸”ë¡œê·¸ì˜ ì„¤ëª…ì„ ì°¨ìš©í•˜ë©´&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ì¼ë°˜ì ì¸ Q Learningì€ ë‹¹ë‚˜ê·€ ë’¤ì— ì˜¬ë¼íƒ€ ë‚šì‹œëŒ€ë¡œ ë‹¹ê·¼ì„ ë“œë¦¬ìš°ê³  ë‹¹ë‚˜ê·€ê°€ ê³§ê²Œ ê±·ê¸°ë¥¼ ë°”ë¼ëŠ” ê²ƒê³¼ ê°™ë‹¤. ë‹¹ê·¼ì„ ë“  ì†ì„ ê³§ê²Œë§Œ ìœ ì§€í•˜ë©´ ë‹¹ë‚˜ê·€ê°€ ì§ì§„í•  ê²ƒì´ë¼ê³  ìƒê°í•˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ì˜ ì•ˆëœë‹¤. ë‹¹ë‚˜ê·€ì™€ ì‚¬ëŒ, ê·¸ë¦¬ê³  ë‚šì‹œëŒ€ì™€ ë‹¹ê·¼ì´ ëª¨ë‘ ì—°ê²°ë˜ì–´ ìˆê¸°ì—, ë‹¹ë‚˜ê·€ê°€ ì›€ì§ì´ë©´ ì˜¬ë¼íƒ„ ì‚¬ëŒë„ í”ë“¤ë¦¬ê³  ê·¸ì— ë”°ë¼ ë‹¹ê·¼ë„ í”ë“¤ë¦°ë‹¤. ê²°êµ­ ì˜ìƒì—ì„œì²˜ëŸ¼ ë‹¹ë‚˜ê·€ëŠ” ì§ì„ ìœ¼ë¡œ ì´ë™í•˜ëŠ”ë° ì‹¤íŒ¨í•œë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;ë‹¹ê·¼ì˜ ìœ„ì¹˜ë¥¼ Q í•¨ìˆ˜ì˜ íƒ€ê²Ÿ $(r+max_{aâ€™}Q(s^{â€˜}, a^{â€˜}))$ ìœ¼ë¡œ, ë‹¹ë‚˜ê·€ì˜ ì›€ì§ì„ì„ ì¶”ì •ì¹˜(Q)ë¡œ ëŒ€ì…í•´ë³´ë©´ ëœë‹¤. íƒ€ê²Ÿê³¼ ì¶”ì •ì¹˜ì˜ ì˜¤ì°¨ë¥¼ ì¤„ì—¬ì•¼í•˜ëŠ”ë°, Qì˜ ë³€í™”ì— ë”°ë¼ íƒ€ê²Ÿê³¼ ì¶”ì •ì¹˜ê°€ ëª¨ë‘ í•¨ê»˜ ë³€í™”í•˜ë©´ ì•ˆì •ì ì¸ í•™ìŠµ(ì´ë™)ì´ ì–´ë ¤ì›Œì§„ë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;DQNì—ì„œëŠ” ë‹¹ë‚˜ê·€ì™€ ë‹¹ê·¼ì„ ë¶„ë¦¬ì‹œí‚¤ëŠ” Fixed Q Targets ë°©ë²•ì„ ì‚¬ìš©í•´ì„œ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤. Qí•¨ìˆ˜ë¥¼ ì¶”ì •í•˜ëŠ” ë„¤íŠ¸ì›Œí¬(local network)ì™€ Targetì„ ì„¤ì •í•˜ëŠ”ë° ì‚¬ìš©í•˜ëŠ” ë„¤íŠ¸ì›Œí¬(target network)ë¡œ ì¶”ì •ê³¼ í‰ê°€ë¥¼ ë¶„ë¦¬í•œë‹¤. ë‹¹ë‚˜ê·€ ë“±ì—ì„œ ë‚´ë ¤ì„œ ë‚šì‹œëŒ€ë¥¼ ë“œë¦¬ìš°ë©´, ë‹¹ê·¼ì˜ ìœ„ì¹˜ëŠ” ë”ì´ìƒ ë‹¹ë‚˜ê·€ì˜ ì›€ì§ì„ì— ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ”ë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;ê·¸ë¦¬ê³  target networkì˜ ì—…ë°ì´íŠ¸ ì£¼ê¸°ë¥¼ local networkë³´ë‹¤ ë” ëŠë¦¬ê²Œ ë§Œë“¦ìœ¼ë¡œì¨ ëª©í‘œê°€ ìì£¼ íœ˜ì²­ì´ì§€ ì•Šë„ë¡ í•œë‹¤. DQN êµ¬í˜„ì—ì„œëŠ” local networkê°€ 4ë²ˆ ì—…ë°ì´íŠ¸ë  ë•Œ í•œë²ˆì”© target networkì˜ íŒŒë¼ë¯¸í„°ë¥¼ local networkì˜ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•´ soft updateí•œë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;dqn-êµ¬í˜„&quot;&gt;DQN êµ¬í˜„&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;h3 id=&quot;environment&quot;&gt;Environment&lt;/h3&gt;
&lt;p&gt;ë¨¼ì €, ì´ë²ˆ DQN êµ¬í˜„ì€ ì œê³µë°›ì€ 2ê°œì˜ GridWorld í™˜ê²½ì„ ê¸°ë°˜ìœ¼ë¡œ ì§„í–‰í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;p&gt;ë¨¼ì € ì²«ë²ˆì§¸ GridWorldëŠ” ê·¸ë¦¼ê³¼ ê°™ë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/dqn4.png&quot; width=&quot;50%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;ê·¸ë¦¼ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´ ì´ í™˜ê²½ì€ ë…¸ë€ ë™ê·¸ë¼ë¯¸, ë¹¨ê°„ ë„¤ëª¨, ë…¹ìƒ‰ ë„¤ëª¨ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤. ê°ê°ì„ ì‚´í´ë³´ë©´,&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ë…¸ë€ ë™ê·¸ë¼ë¯¸ : agentì˜ ì›€ì§ì„ì„ ë‚˜íƒ€ë‚¸ë‹¤.&lt;/li&gt;
  &lt;li&gt;ë¹¨ê°„ ë„¤ëª¨ : í­íƒ„ì´ ìœ„ì¹˜í•´ ìˆìœ¼ë©° agentê°€ í•´ë‹¹ ìœ„ì¹˜ë¡œ ê°€ë©´ reward -10ì„ ì–»ê³  ë‹¤ì‹œ episodeë¥¼ ì‹œì‘í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ì´ˆë¡ ë„¤ëª¨ : ë³´ë¬¼ì´ ìœ„ì¹˜í•´ ìˆìœ¼ë©° agentê°€ í•´ë‹¹ ìœ„ì¹˜ë¡œ ê°€ë©´ reward 20ì„ ì–»ê³  ë‹¤ì‹œ episodeë¥¼ ì‹œì‘í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ë¹¨ê°„ ë„¤ëª¨, ì´ˆë¡ ë„¤ëª¨ê°€ ì—†ëŠ” ê³µê°„ì„ ë…¸ë€ ë™ê·¸ë¼ë¯¸ê°€ íƒìƒ‰í•  ë•Œë§ˆë‹¤ reward -0.1ì„ ì–»ëŠ”ë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ë‘ë²ˆì§¸ GridWorldëŠ” ì²«ë²ˆì§¸ GridWorldì— ì£¼í™© ë„¤ëª¨ê°€ ì¶”ê°€ë˜ì—ˆë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/dqn5.png&quot; width=&quot;45%&quot; /&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;ì£¼í™© ë„¤ëª¨ : ìŒì‹ ìœ„ì¹˜í•´ ìˆìœ¼ë©° agentê°€ í•´ë‹¹ ìœ„ì¹˜ë¡œ ê°€ë©´ reward 10ì„ ì–»ê³  ë‹¤ì‹œ episodeë¥¼ ì‹œì‘í•œë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;dqn-class-êµ¬í˜„&quot;&gt;DQN class êµ¬í˜„&lt;/h3&gt;

&lt;p&gt;ì´ëŸ¬í•œ í™˜ê²½ì—ì„œ ì˜ ë™ì‘í•  ìˆ˜ ìˆëŠ” DQNì„ êµ¬í˜„í•´ë³´ì.
DQN êµ¬í˜„ì€ &lt;strong&gt;neural network ìƒì„±&lt;/strong&gt;, &lt;strong&gt;action ì„ íƒ&lt;/strong&gt;, &lt;strong&gt;experience replayë¥¼ ìœ„í•˜ì—¬ ì´ì „ experienceë¥¼ ë©”ëª¨ë¦¬ì— ì €ì¥&lt;/strong&gt;, &lt;strong&gt;ë©”ëª¨ë¦¬ì— í¬í•¨ëœ experienceë¥¼ ì´ìš©í•˜ì—¬ í•™ìŠµ&lt;/strong&gt;ì˜ ê³¼ì •ìœ¼ë¡œ ë‚˜ëˆ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;neural network ìƒì„±&lt;/strong&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_construct_network()&lt;/code&gt; í•¨ìˆ˜)&lt;/p&gt;

    &lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/dqn3.jpeg&quot; width=&quot;80%&quot; /&gt;
  &lt;/div&gt;

    &lt;p&gt;ì´ DQN ëª¨ë¸ì—ì„œ êµ¬í˜„í•œ neural networkëŠ” ìœ„ ë‹¤ì´ì–´ê·¸ë¨ê³¼ ë¹„ìŠ·í•˜ë‹¤. ë¨¼ì € input layerì—ì„œ n_features sizeì˜ ì…ë ¥ì„ ë°›ê³  24 í¬ê¸°ë¡œ ì¶œë ¥ì„ í•œë‹¤. ì´ ë•Œ, activation í•¨ìˆ˜ë¡œ relu í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤. ë˜í•œ Hidden layerì—ì„œëŠ” ì´ì „ ë ˆì´ì–´ì˜ ì¶œë ¥ì„ ì¸í’‹ìœ¼ë¡œ ë°›ì•„ 24 í¬ê¸°ë¡œ ì¶œë ¥ì„ í•œë‹¤. ì´ ë•Œë„ ë§ˆì°¬ê°€ì§€ë¡œ activation í•¨ìˆ˜ë¡œ reluë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤. ë§ˆì§€ë§‰ output layerì—ì„œëŠ” n_actions í¬ê¸°ë¡œ ì¶œë ¥ì„ í•˜ê³  ì´ ë•Œ, activation í•¨ìˆ˜ë¥¼ linearë¡œ ì„¤ì •í•˜ì˜€ë‹¤. ì´ë ‡ê²Œ êµ¬í˜„í•œ ëª¨ë¸ì˜ ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;relu&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;relu&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;linear&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;mse&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;ì´ ëª¨ë¸ì— n_features í¬ê¸°ì˜ state ë²¡í„°ê°€ ë“¤ì–´ì˜¤ë©´ ëª¨ë¸ì˜ predictionìœ¼ë¡œ ì–»ì€ ì˜ˆì¸¡ëœ reward ê°’ê³¼ true reward ê°’ì˜ ì—ëŸ¬ê°€ ì‘ì•„ì§€ë„ë¡ ë‚´ë¶€ weight ê°’ì„ ì¡°ì •í•œë‹¤. ì´ë¥¼ ê³„ì† ë°˜ë³µí•˜ë‹¤ë³´ë©´ ì˜ˆì¸¡ëœ rewardê°€ true rewardì™€ ê°™ì•„ì§€ëŠ” ë°©í–¥ìœ¼ë¡œ (ìµœì  policyë¥¼ ì°¾ëŠ” ë°©í–¥ìœ¼ë¡œ) í•™ìŠµë˜ê²Œ ëœë‹¤.&lt;/p&gt;

    &lt;p&gt;ì¢€ ë” êµ¬ì²´ì ìœ¼ë¡œ í•™ìŠµ ê³¼ì •ì„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;model.fit()&lt;/code&gt;ê³¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;model.predict()&lt;/code&gt; í•¨ìˆ˜ë¡œ ë‹¤ì‹œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤. ê°ê°ì„ ì‚´í´ë³´ë©´,&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;model.fit(state, true_reward, epochs=1, verbose)&lt;/code&gt;
        &lt;ul&gt;
          &lt;li&gt;ì£¼ì–´ì§„ stateì—ì„œ true rewardë¥¼ ì˜ˆì¸¡í•˜ë„ë¡ í•™ìŠµí•œë‹¤.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;model.predict(state)&lt;/code&gt;
        &lt;ul&gt;
          &lt;li&gt;unseen inputì— ëŒ€í•˜ì—¬ rewardë¥¼ ì˜ˆì¸¡í•œë‹¤.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;ì´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;model.fit()&lt;/code&gt;ê³¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;model.predict()&lt;/code&gt;ë¥¼ í•™ìŠµ ê³¼ì •ì—ì„œ í™œìš©í•˜ë©° ìµœì  policyë¥¼ ì°¾ì•„ë‚˜ê°”ë‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;action ì„ íƒ&lt;/strong&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;choose_action()&lt;/code&gt; í•¨ìˆ˜)
    &lt;ul&gt;
      &lt;li&gt;e_greedy í™•ë¥ ë¡œëŠ” random í•˜ê²Œ actionì„ ì„ íƒí•˜ê³ , 1 - (e-greedy) í™•ë¥ ë¡œëŠ” ëª¨ë¸ì—ì„œ ì˜ˆì¸¡í•œ rewardê°€ ê°€ì¥ í° actionì„ ì„ íƒí•œë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;experienceë¥¼ ë©”ëª¨ë¦¬ì— ì €ì¥&lt;/strong&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_transition()&lt;/code&gt; í•¨ìˆ˜)
    &lt;ul&gt;
      &lt;li&gt;experience replay ë°©ì‹ìœ¼ë¡œ experienceë¥¼ ì¬í™œìš© ìœ„í•˜ì—¬ í•™ìŠµì„ ë©”ëª¨ë¦¬ì— ì €ì¥í•´ë‘”ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ë©”ëª¨ë¦¬ì˜ experienceë¥¼ ì´ìš©í•˜ì—¬ í•™ìŠµ&lt;/strong&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;learn()&lt;/code&gt; í•¨ìˆ˜)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì´ ê³¼ì •ì„ í†µí•©í•˜ì—¬ êµ¬í˜„ëœ ì „ì²´ DQN Class ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;collections&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deque&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.optimizers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;EPISODES&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DeepQLearning&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
           &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;discount_factor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;e_greedy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;replace_target_iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;memory_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;discount_factor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;discount_factor&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deque&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memory_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_greedy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e_greedy&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace_target_iter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;replace_target_iter&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_construct_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_construct_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

       &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;relu&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;relu&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;linear&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;mse&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;store_transition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;choose_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# e_greedy í™•ë¥ ë¡œëŠ” random í•˜ê²Œ actionì„ ì„ íƒí•˜ê³ , 1 - (e-greedy) í™•ë¥ ë¡œëŠ” ëª¨ë¸ì—ì„œ ì˜ˆì¸¡í•œ rewardê°€ ê°€ì¥ í° actionì„ ì„ íƒí•œë‹¤.
&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

       &lt;span class=&quot;c1&quot;&gt;# e_greedy í™•ë¥ ë¡œ random í•˜ê²Œ actionì„ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_greedy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randrange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

       &lt;span class=&quot;c1&quot;&gt;#  1 - (e-greedy) í™•ë¥ ë¡œ ëª¨ë¸ì„ í†µí•´ ì˜ˆì¸¡í•œ rewardê°€ ê°€ì¥ í° actionì„ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;act_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;act_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# returns action
&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# ë©”ëª¨ë¦¬ì— ì €ì¥ëœ experienceì—ì„œ batch_sizeë§Œí¼ ëœë¤í•˜ê²Œ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;minibatch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# ì„ íƒëœ ê°ê°ì˜ experienceì— ëŒ€í•˜ì—¬ ëª¨ë¸ì´ ì‹¤ì œ experienceë¡œ ì–»ì€ reward ë°©í–¥ìœ¼ë¡œ ê°’ì„ ì˜ ì˜ˆì¸¡í•˜ë„ë¡ í•™ìŠµì„ ì§„í–‰
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;minibatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;
           &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
               &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;discount_factor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;target_f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;target_f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;
           &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;dqn-class-ì‹¤í–‰&quot;&gt;DQN Class ì‹¤í–‰&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;ì´ì œ ì´ë ‡ê²Œ êµ¬í˜„í•œ DQN Classë¥¼ í™œìš©í•˜ì—¬ í•™ìŠµì„ ì§„í–‰í•´ë³´ì•˜ë‹¤.
ì´ 300ê°œì˜ episodeì— ëŒ€í•˜ì—¬ DQNì„ í•™ìŠµì‹œí‚¤ê³  average episode returnì„ ê·¸ë ¤ë³´ì•˜ë‹¤.
ì´ ë•Œ, return ê°’ì´ ìƒˆë¡­ê²Œ í•™ìŠµì„ ëŒë¦´ ë•Œ ë§ˆë‹¤ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì— 300ê°œì˜ episodeë¡œ í•™ìŠµí•˜ëŠ” ê³¼ì • ì „ì²´ë¥¼ 5ë²ˆ ë°˜ë³µí•´ì„œ episode rewardì˜ min-max, meanë¥¼ ë‚˜ëˆ„ì–´ plotí•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Robot_Gridworld&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;env2&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Robot_Gridworld&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Robot_Gridworld2&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;deep_q_learning&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DeepQLearning&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;collections&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deque&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;return_value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.99&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;episode_return_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;global&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_value&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;reward_per_episode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;returns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deque&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;episode&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

       &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;step_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

       &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;return_value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dqn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choose_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;terminal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;return_value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_value&lt;/span&gt;

           &lt;span class=&quot;n&quot;&gt;step_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;dqn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store_transition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;terminal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

           &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
               &lt;span class=&quot;n&quot;&gt;dqn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;

           &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;terminal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
               &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot; {} End. Total steps : {}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;episode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
               &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;

           &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

       &lt;span class=&quot;n&quot;&gt;returns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;return_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;reward_per_episode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;returns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;episode_return_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reward_per_episode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;Game over.&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destroy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Robot_Gridworld&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

       &lt;span class=&quot;n&quot;&gt;dqn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DeepQLearning&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;discount_factor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;e_greedy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;replace_target_iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;memory_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;
                           &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


       &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;after&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#Basic module in tkinter
&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mainloop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#Basic module in tkinter
&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;mean_return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;episode_return_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;min_return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;episode_return_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;max_return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;episode_return_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í•™ìŠµ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ì²«ë²ˆì§¸ Gridworld (ì£¼í™© ë„¤ëª¨ X)
    &lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/dqn1.png&quot; width=&quot;100%&quot; /&gt;
  &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;ë‘ë²ˆì§¸ Gridworld (ì£¼í™© ë„¤ëª¨ O)
    &lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/dqn2.png&quot; width=&quot;100%&quot; /&gt;
  &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ê·¸ë˜í”„ë¥¼ ë¹„êµí•´ë³´ë©´ ë‘ë²ˆì§¸ Gridworldë¡œ ëŒë ¸ì„ ë•Œ, ë³´ë‹¤ ë¹¨ë¦¬, ì ì€ ë¶„ì‚°ìœ¼ë¡œ ìµœì  policyë¥¼ ì°¾ì•„ê°€ëŠ” ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. í•˜ì§€ë§Œ ë‘ë²ˆì§¸ GridworldëŠ” ë¦¬ì›Œë“œ 10ì„ ì£¼ëŠ” sub optimalí•œ ê²½ìš°ê°€ ì¶”ê°€ ë˜ì—ˆê¸° ë•Œë¬¸ì— ìì¹«í•˜ë©´ ë¦¬ì›Œë“œ 20ì„ ì£¼ëŠ” ë³´ë¬¼ì„ ì°¾ì•„ê°€ëŠ” ëŒ€ì‹ ì— 10ì„ ì£¼ëŠ” sub optimalì— ë¹ ì§ˆ ìˆ˜ ìˆë‹¤. ê·¸ëŸ´ ê²½ìš° batch sizeë¥¼ í‚¤ìš°ê±°ë‚˜, í•™ìŠµì´ ì§„í–‰ë˜ì–´ ê°ì— ë”°ë¼ learning rate ì„œì„œíˆ ê°ì†Œì‹œí‚´ìœ¼ë¡œì¨ sub optimalì— ë¹ ì§€ëŠ” ê²ƒì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
Â &lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;ì°¸ê³  ë‚´ìš© ì¶œì²˜ :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://wiki.hash.kr/index.php/DQN&quot;&gt;http://wiki.hash.kr/index.php/DQN&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://velog.io/@sjinu/%EA%B0%9C%EB%85%90%EC%A0%95%EB%A6%AC-7.-DQNDeep-Q-NEtwork&quot;&gt;https://velog.io/@sjinu/%EA%B0%9C%EB%85%90%EC%A0%95%EB%A6%AC-7.-DQNDeep-Q-NEtwork&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="RL" />
      
        <category term="coding" />
      

      
        <summary type="html">Â  DQN ì´ë€? Â  ì´ì „ì— (Reinforcement learning) Value Function Approximation í¬ìŠ¤íŒ…ì—ì„œ Value function approximationì— ëŒ€í•˜ì—¬ ë‹¤ë£¨ì—ˆë‹¤. ìš”ì•½í•˜ë©´ ê°•í™”í•™ìŠµì—ì„œ ê°„ë‹¨í•œ table í˜•íƒœë¡œ í•™ìŠµì„ í•˜ê²Œ ë˜ë©´ í•™ìŠµì´ ê·¹ë„ë¡œ ëŠë ¤ì§€ëŠ” ë¬¸ì œê°€ ìˆì–´ value functionì„ ë‹¤ì–‘í•˜ê²Œ ê·¼ì‚¬í•˜ì—¬ í™œìš©í•œë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">(Reinforcement learning) Value Function Approximation</title>
      <link href="http://localhost:4000/(RL)-Value-Function-Approximation" rel="alternate" type="text/html" title="(Reinforcement learning) Value Function Approximation" />
      <published>2022-05-13T13:23:00+09:00</published>
      <updated>2022-05-13T13:23:00+09:00</updated>
      <id>http://localhost:4000/(RL)%20Value%20Function%20Approximation</id>
      <content type="html" xml:base="http://localhost:4000/(RL)-Value-Function-Approximation">&lt;p&gt;ì´ë²ˆ ê¸€ì—ì„œëŠ” ê°•í™”í•™ìŠµ ê¸°ë³¸ ê°œë… ì¤‘ Value function approximationì— ëŒ€í•´ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ê¸€ì€ David Silverì˜ ê°•í™”í•™ìŠµ ê°•ì˜ì™€ KAIST EE619 ê°•í™”í•™ìŠµ ìˆ˜ì—…ì—ì„œ ê³µë¶€í•œ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;tabular-methods&quot;&gt;Tabular Methods&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;ê·œëª¨ê°€ ì‘ì€ MDP ëª¨ë¸ì˜ ê²½ìš°, stateì™€ actionì„ Tableì— ì €ì¥í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë” ì •í™•íˆëŠ” value functionì„ ì‚¬ìš©í•˜ëŠ” DP ë¬¸ì œì˜ ê²½ìš°, ëª¨ë“  state sëŠ” V(s) &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vector&lt;/code&gt;ì„ ê°€ì§ˆ ê²ƒì´ë‹¤. ë˜í•œ, action-value functionì„ ì‚¬ìš©í•˜ëŠ” MC, TDì˜ ê²½ìš° ëª¨ë“  state-action ìŒ (s, a)ì— ëŒ€í•˜ì—¬ Q(s, a) &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;matrix&lt;/code&gt;ê°€ ì¡´ì¬í•œë‹¤. ì´ë ‡ê²Œ í–‰ë ¬ë¡œ ë§Œë“¤ì–´ í‘¸ëŠ” ë°©ì‹ì„ &lt;strong&gt;Tabular Methods&lt;/strong&gt;ë¼ê³  í•œë‹¤. í•˜ì§€ë§Œ ì´ëŸ° Tabular MethodëŠ” stateì™€ actionì˜ ì°¨ì›ì´ ë¬´ì§€í•˜ê²Œ ì»¤ì§€ëŠ” ì‹¤ìƒí™œ ë¬¸ì œì— Generalizationì„ í•  ìˆ˜ ì—†ë‹¤.&lt;/p&gt;

&lt;p&gt;ë‹¤ìŒì˜ ë¬¸ì œë“¤ì„ ìƒê°í•´ë³´ì.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Backgammon: $10^{20}$ states&lt;/li&gt;
  &lt;li&gt;Compoter Go: $10^{170}$ states&lt;/li&gt;
  &lt;li&gt;Robot: continuous state space&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì´ëŸ° ê²½ìš°, íŠ¹íˆë‚˜ continuous state spaceë¥¼ ê°€ì§€ëŠ” ê²½ìš°ì—ëŠ” íŠ¹íˆë‚˜ Tableë§Œìœ¼ë¡œ í•¸ë“¤ë§ì´ ë¶ˆê°€ëŠ¥í•˜ê³  ë”°ë¼ì„œ ìƒˆë¡œìš´ ë°©ë²•ì´ í•„ìš”í•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;parameterizing-value-function&quot;&gt;Parameterizing value function&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;
Â 
ê·¸ë ‡ë‹¤ë©´ ì‹¤ìƒí™œì— ê°•í™”í•™ìŠµì„ ì ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ì–´ë–¤ ë°©ë²•ì„ ì´ìš©í•´ì•¼ í• ê¹Œ? stateì™€ actionì„ tableë¡œ êµ¬í˜„í•˜ëŠ” ëŒ€ì‹ ì—, $ w$ë¼ëŠ” ìƒˆë¡œìš´ ë³€ìˆ˜ë¥¼ í†µí•´ &lt;strong&gt;value function&lt;/strong&gt;ì„ í•¨ìˆ˜í™”í•¨ìœ¼ë¡œì¨ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.
ë¨¼ì €, value functionì„ function approximationì„ ì´ìš©í•˜ì—¬ ì¶”ì •í•´ì¤€ë‹¤.&lt;/p&gt;

\[\hat{V}_{w}(s) \approx V^{\pi}(s) ~~ or ~~\hat{Q}_{w}(s, a) \approx V^{\pi}(s, a)\]

&lt;p&gt;ë‹¤ìŒìœ¼ë¡œ, seen states(ë°©ë¬¸í•œ states)ë¡œ ë¶€í„° unseen states(ì•„ì§ ë°©ë¬¸í•˜ì§€ ì•Šì€ states)ë¡œ ì¼ë°˜í™”ì‹œí‚¨ë‹¤.
ë§ˆì§€ë§‰ìœ¼ë¡œ MCë‚˜ TD learningì„ ì´ìš©í•˜ì—¬ íŒŒë¼ë¯¸í„° $w$ë¥¼ í•™ìŠµí•˜ë©´ value functionì˜ optimalí•œ ì¶”ì •ì¹˜ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ë¥¼ ê·¸ë¦¼ìœ¼ë¡œ ë‹¤ì‹œ í™•ì¸í•´ë³´ë©´,&lt;/p&gt;
&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/value_approximation.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;
&lt;p&gt;stateê°€ í•¨ìˆ˜ì˜ inputìœ¼ë¡œ ë„£ê³ , $w$ë¼ëŠ” parameterë¥¼ ì§€ë‚˜ action value functionì„ outputìœ¼ë¡œ ë°›ëŠ” ê³¼ì •ì´ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;on-policy-prediction-with-function-approximation&quot;&gt;On-Policy Prediction with Function Approximation&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;
&lt;h3 id=&quot;loss-function-mean-square-value-errormsve&quot;&gt;Loss Function: Mean-Square Value Error(MSVE)&lt;/h3&gt;
&lt;p&gt;On-Policy Prediction problemì€ state value functionì„ ì¶”ì •í•´ë‚˜ê°€ëŠ” ê³¼ì •ì´ë‹¤.
True value function $V^{\pi}(s)$ ì™€ Approximation function $\hat{V} _{w}(s)$ ê°€ ìˆì„ ë•Œ, ë‘ í•¨ìˆ˜ê°€ ìµœëŒ€í•œ ê°™ì•„ì§€ë„ë¡ $\hat{V} _{w}(s)$ ì„ í•™ìŠµì‹œí‚¤ëŠ” ê²ƒì´ ëª©í‘œì´ë‹¤.
ì´ ë•Œ, ë‘ í•¨ìˆ˜ì˜ ì°¨ì´ë¥¼ Mean-Square Value Error(MSVE)ìœ¼ë¡œ ê°€ëŠ í•´ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

\[J(w) = MSE(w) = E_{\pi} = \left [ V^{\pi}(s) - \hat{V}_{w}(s) \right ]^{2} \\ = \sum_{s\in S}^{}\mu^{\pi}(s)\left [ V^{\pi}(s) - \hat{V}_{w}(s) \right ]^{2}\]

&lt;p&gt;ì—¬ê¸°ì„œ $\mu^{\pi}(s)$ ëŠ” $\pi$ ì— ëŒ€í•œ on-policy distribution ì´ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;on-policy-distribution&quot;&gt;On-Policy Distribution&lt;/h3&gt;
&lt;p&gt;MSVEëŠ” ë‘ í•¨ìˆ˜ ê°„ì˜ weighted $L_{2}$ distance ì´ë‹¤. ì´ë–„ ê° sì— ëŒ€í•´ì„œ weighting importanceëŠ” on-policy distribution $d^{\pi}(s)$ ì— ì˜í•´ ì£¼ì–´ì§„ë‹¤.
$d^{\pi}(s)$ ì„ ì •ì˜í•˜ëŠ” í•œ ê°€ì§€ ë°©ë²•ì€&lt;/p&gt;

&lt;h3 id=&quot;stochastic-gradient-descent&quot;&gt;Stochastic Gradient Descent&lt;/h3&gt;
&lt;p&gt;í•™ìŠµì€ ì •ì˜ëœ MSVEì— ëŒ€í•´ì„œ stochastic gradient descent ë°©ë²•ì„ í†µí•´ ì§„í–‰í•´ì¤€ë‹¤. Stochastic gradientì˜ ëª©í‘œëŠ” MSE lossë¥¼ ìµœì†Œí™”í•˜ëŠ” vector $w$ ë¥¼ ì°¾ëŠ” ê²ƒì´ë‹¤.
Stochastic Gradient Descentì„ ìˆ˜í–‰í•˜ëŠ” ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Mean-Square Loss Function: ë¯¸ë¶„ê°€ëŠ¥í•œ í•¨ìˆ˜ë¡œ ì£¼ì–´ì§„ë‹¤.
    &lt;ul&gt;
      &lt;li&gt;ë§Œì•½ loss functionì´ ë¯¸ë¶„ê°€ëŠ¥í•˜ì§€ ì•Šë‹¤ë©´, subgradientë¥¼ ì‚¬ìš©í•œë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;True Gradient: ë¨¼ì € loss functionì˜ true gradientë¥¼ ê³„ì‚°í•œë‹¤.
    &lt;ul&gt;
      &lt;li&gt;True gradient : $\sum_{s}^{}\mu^{\pi}(s) \left [ \left ( V^{\pi}(s) - \hat{V_{w}}(s) \right) \bigtriangledown \hat{V_{w}}(s) \right ]$&lt;/li&gt;
      &lt;li&gt;weight update : $ w_{t+1} = w_{t} + \alpha \sum_{s}^{}\mu^{\pi}(s) \left [ \left ( V^{\pi}(s) - \hat{V_{w}}(s) \right) \bigtriangledown \hat{V_{w}}(s) \right ] $&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Sampling the Gradient: ì´í›„ ìƒ˜í”Œì„ í†µí•´ stochastic gradient ë°©ë²•ìœ¼ë¡œ true gradientë¥¼ ì¶”ì •í•œë‹¤. ì´ëŸ° ë°©ì‹ì„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sample the gradient&lt;/code&gt; ë¼ê³  í•œë‹¤. 2ë²ˆì—ì„œ True expectation $\sum_{s\in S}^{}\mu^{\pi}(s)$ ì´ &lt;strong&gt;$\mu^{\pi}(s)$ ë¡œ ë¶€í„° ìƒì„±ëœ í•˜ë‚˜ì˜ ìƒ˜í”Œ $s_{t}$ ë¡œ ê³„ì‚°í•œ sample mean&lt;/strong&gt; ìœ¼ë¡œ ëŒ€ì²´ëœë‹¤.
    &lt;ul&gt;
      &lt;li&gt;Stochastic gradient : $\left [ \left ( V^{\pi}(s_{t}) - \hat{V_{w}}(s_{t}) \right) \bigtriangledown \hat{V_{w}}(s_{t}) \right ]$&lt;/li&gt;
      &lt;li&gt;weight update : $ w_{t+1} = w_{t} + \alpha \left ( V^{\pi}(s_{t}) - \hat{V_{w}}(s_{t}) \right) \bigtriangledown \hat{V_{w}}(s_{t}) $&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;$\mu^{\pi}(s)$ë¡œ ë¶€í„° ìƒ˜í”Œì„ ì¶©ë¶„íˆ ë§ì´ ì¶”ì¶œí•œë‹¤ë©´, sample-based SGëŠ” true gradient ë¡œ ìˆ˜ë ´í•œë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;on-policy-mc-td-learning&quot;&gt;On-Policy MC, TD Learning&lt;/h3&gt;
&lt;p&gt;gradientë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ì„œ, $s_{t}, V^{\pi}(s_{t})$ ì˜ true valueê°€ í•„ìš”í•˜ì§€ë§Œ ì´ ê°’ì€ ì•Œê¸° í˜ë“¤ë‹¤. ë”°ë¼ì„œ $V^{\pi}(s_{t})$ ë¥¼ ì¶”ì •ì¹˜ì¸ MC, TD or TD( $\lambda$ ) ì¶”ì²­ê°’ìœ¼ë¡œ ëŒ€ì²´í•œë‹¤. ê°ê°ì˜ ì¶”ì •ì¹˜ë¡œ ëŒ€ì²´í•˜ë©´,&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Gradient MC for Value Function Estimation: $ w_{t+1} = w_{t} + \alpha \left ( G_{t} - \hat{V_{w}}(s_{t}) \right) \bigtriangledown \hat{V_{w}}(s_{t}) $&lt;/li&gt;
  &lt;li&gt;Semi-Gradient TD for Value Function Estimation: $ w_{t+1} = w_{t} + \alpha \left ( r_{t+1} + \gamma \hat{V_{w}}(s_{t+1}) - \hat{V_{w}}(s_{t}) \right) \bigtriangledown \hat{V_{w}}(s_{t}) $&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;on-policy-control-with-function-approximation&quot;&gt;On-Policy Control with Function Approximation&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;h3 id=&quot;prediction-vs-control&quot;&gt;Prediction vs Control&lt;/h3&gt;
&lt;p&gt;On-Policy Controlì„ ë‹¤ë£¨ê¸°ì— ì•ì„œ Predictionê³¼ Controlì˜ ì°¨ì´ë¥¼ ë³µìŠµí•´ë³´ì. Perdictionê³¼ Controlì˜ ì°¨ì´ëŠ” policyì— ëŒ€í•œ ëª©í‘œì™€ ê´€ë ¨ì´ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë¨¼ì € RLì—ì„œ prediction taskëŠ” policyê°€ ì£¼ì–´ì§„ ìƒí™©ì—ì„œ ì´ policyê°€ ì–¼ë§ˆë‚˜ ì˜ ë™ì‘í•˜ëŠ” ì§€ë¥¼ ì¸¡ì •í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•œë‹¤. ë”°ë¼ì„œ, ì£¼ì–´ì‹  stateì—ì„œ total rewardë¥¼ ì˜ˆì¸¡í•˜ê¸° ìœ„í•´ì„œ $\pi(\left.\begin{matrix}
a\end{matrix}\right|s)$ ê°€ ê³ ì •ë˜ì–´ ìˆë‹¤.
ë°˜ë©´ì— control taskëŠ” policyê°€ ê³ ì •ë˜ì–´ ìˆì§€ ì•Šìœ¼ë©° ìµœì  policyë¥¼ ì°¾ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•œë‹¤. ì¦‰, ì„ì˜ì˜ ì£¼ì–´ì§„ ìƒíƒœì—ì„œ total rewardì˜ ì˜ˆì¸¡ê°’ì„ ê°€ì¥ í¬ê²Œ í•˜ëŠ” policy $\pi(\left.\begin{matrix}
a\end{matrix}\right|s)$ ë¥¼ ì°¾ëŠ”ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;control-with-value-function-approximation&quot;&gt;Control with Value Function Approximation&lt;/h3&gt;
&lt;p&gt;Control ê³¼ì •ì€ ë‹¤ì‹œ Policy evaluation ê³¼ì •ê³¼ Policy improvement ê³¼ì •ìœ¼ë¡œ ë‚˜ë‰œë‹¤. ì´ ë•Œ, model-freeë¥¼ ìœ„í•´ì„œ action-value functionì„ ì‚¬ìš©í•œë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/function_approx1.jpeg&quot; width=&quot;80%&quot; /&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;Policy evaluation : $\hat{Q}_{w}$ ë¥¼ $Q^{\pi}$ë¡œ ì¶”ì •&lt;/li&gt;
  &lt;li&gt;Policy improvement : action value functionì— $ \epsilon - greedy $ í•œ actionì„ ì·¨í•¨ìœ¼ë¡œì¨ improve ì§„í–‰&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;loss-function-mean-square-value-errormsve-1&quot;&gt;Loss Function: Mean-Square Value Error(MSVE)&lt;/h3&gt;
&lt;p&gt;Prediction ë•Œì™€ ë˜‘ê°™ì´ MSVEë¥¼ êµ¬í•´ë³´ë©´,&lt;/p&gt;

\[J(w) = MSE(w) = E_{\pi} = \left [ Q^{\pi}(s) - \hat{Q}_{w}(s) \right ]^{2} \\ = \sum_{s, a}^{}\mu^{\pi}(s, a)\left [ Q^{\pi}(s, a) - \hat{Q}_{w}(s, a) \right ]^{2}\]

\[- \frac{1}{2} \bigtriangledown  J(w) = \sum_{s, a}^{}\mu^{\pi}(s, a)\left ( Q^{\pi}(s, a) - \hat{Q}_{w}(s, a) \right ) \bigtriangledown \hat{Q}_{w}(s, a)\]

&lt;h3 id=&quot;stochastic-gradient-descent-1&quot;&gt;Stochastic Gradient Descent&lt;/h3&gt;
&lt;p&gt;policy $\pi$ ì—ì„œ ìƒ˜í”Œë§í•œ $(s_{t}, a_{t})$ì— ëŒ€í•˜ì—¬ MSVE ê°’ì„ ì´ìš©í•´ì„œ stochastic gradient descent or semi-gradientë¥¼ ìˆ˜í–‰í•œë‹¤.&lt;/p&gt;

\[\Delta w =  - \hat{\frac{1}{2}\bigtriangledown J(w)} = (Q^{\pi}(s_{t}, a_{t}) - \hat{Q}_{w_{t}}(s_t, a_{t})) \bigtriangledown \hat{Q}_{w_{t}}(s_t, a_{t})\]

&lt;p&gt;ë˜í•œ, Prediction ë§ˆì°¬ê°€ì§€ë¡œ true action value function $ Q^{\pi}(s_{t}, a_{t}) $ ì„ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— MC, TD targetì„ ì‚¬ìš©í•œë‹¤.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;For gradient MC:
 $ w_{t+1} = w_{t} + \alpha \left ( G_{t} - \hat{Q_{w}}(s_{t}, a_{t}) \right) \bigtriangledown \hat{Q_{w}}(s_{t}, a_{t}) $&lt;/li&gt;
  &lt;li&gt;For semi-gradient TD:
 $ w_{t+1} = w_{t} + \alpha \left ( r_{t+1} + \gamma \hat{Q_{w}}(s_{t+1}, a_{t+1}) - \hat{Q_{w}}(s_{t}, a_{t+1}) \right) \bigtriangledown \hat{Q_{w}}(s_{t}, a_{t+1}) $&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;off-policy-prediction-and-control-with-function-approximation&quot;&gt;Off-Policy Prediction and Control with Function Approximation&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;h3 id=&quot;off-policy-td-prediction-vpis-importance-sampling&quot;&gt;Off-Policy TD Prediction ($V^{\pi}$(s)): Importance Sampling&lt;/h3&gt;
&lt;p&gt;Target policy $\pi$, Behavior policy $\beta$ ì— ëŒ€í•˜ì—¬ ë¨¼ì € Tabular caseë¥¼ ë‹¤ì‹œ ì‚´í´ë³´ì.&lt;/p&gt;

\[V(s_{t}) \leftarrow V(s_{t}) + \alpha \left (  \frac{\left.\begin{matrix} \pi(a_{t}\end{matrix}\right|s_{t})}{\left.\begin{matrix} \beta(a_{t}\end{matrix}\right|s_{t})} (r_{t+1} + \gamma V(s_{t+1})) - V(s_{t}) \right )\]

\[V(s_{t}) \leftarrow V(s_{t}) + \alpha  \frac{\left.\begin{matrix} \pi(a_{t}\end{matrix}\right|s_{t})}{\left.\begin{matrix} \beta(a_{t}\end{matrix}\right|s_{t})} (r_{t+1} + \gamma V(s_{t+1}) - V(s_{t}))\]

&lt;p&gt;ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì´ì „ê³¼ ë¹„ìŠ·í•œ ë°©ì‹ìœ¼ë¡œ Stochastic Gradient Descentì„ ì ìš©í•´ weight update ì‹ì„ êµ¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;

\[w_{t+1} = w_{t} + \alpha \left (  \frac{\left.\begin{matrix} \pi(a_{t}\end{matrix}\right|s_{t})}{\left.\begin{matrix} \beta(a_{t}\end{matrix}\right|s_{t})} (r_{t+1} + \gamma \hat{V}_{w_{t}}(s_{t+1})) - \hat{V}_{w_{t}}(s_{t}) \right ) \bigtriangledown \hat{V}_{w_{t}}(s_{t})\]

\[w_{t+1} = w_{t} + \alpha  \frac{\left.\begin{matrix} \pi(a_{t}\end{matrix}\right|s_{t})}{\left.\begin{matrix} \beta(a_{t}\end{matrix}\right|s_{t})} (r_{t+1} + \gamma \hat{V}_{w_{t}}(s_{t+1}) - \hat{V}_{w_{t}}(s_{t})) \bigtriangledown  \hat{V}_{w_{t}}(s_{t})\]

&lt;p&gt;Â &lt;/p&gt;
&lt;h3 id=&quot;off-policy-td-control-action-value-function&quot;&gt;Off-Policy TD Control (Action-Value Function)&lt;/h3&gt;
&lt;p&gt;Controlì˜ ê²½ìš°ì—ë„ Tabular caseë¥¼ ë‹¤ì‹œ ì‚´í´ë³´ë©´,&lt;/p&gt;

\[Q(s_{t}, a_{t}) \leftarrow Q(s_{t}, a_{t}) + \alpha\left ( r_{t+1} + \gamma \sum_{a}^{} \pi(\left.\begin{matrix}
a\end{matrix}\right|s_{t+1})Q(s_{t+1}, a) - Q(s_{t}, a_{t}) \right )\]

&lt;p&gt;Function approximatationì˜ ê²½ìš°ë¡œ ë°œì „ì‹œí‚¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ëœë‹¤.&lt;/p&gt;

\[w_{t+1} = w_{t} + \alpha\left ( r_{t+1} + \gamma \sum_{a}^{} \pi(\left.\begin{matrix}
a\end{matrix}\right|s_{t+1}) \hat{Q}_{w_{t}}(s_{t+1}, a) - \hat{Q}_{w_{t}}(s_{t}, a_{t}) \right ) \bigtriangledown  \hat{Q}_{w_{t}}(s_{t}, a_{t})\]

&lt;p&gt;Â 
&lt;br /&gt;
Â &lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;ì°¸ê³  ë‚´ìš© ì¶œì²˜ :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;KAIST EE619 Mathmatical Foundations of Reinforcement Learning&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://stats.stackexchange.com/questions/340462/what-is-predicted-and-controlled-in-reinforcement-learning&quot;&gt;https://stats.stackexchange.com/questions/340462/what-is-predicted-and-controlled-in-reinforcement-learning&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="RL" />
      

      
        <summary type="html">ì´ë²ˆ ê¸€ì—ì„œëŠ” ê°•í™”í•™ìŠµ ê¸°ë³¸ ê°œë… ì¤‘ Value function approximationì— ëŒ€í•´ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Q-learning &amp;amp; Double Q-learning êµ¬í˜„</title>
      <link href="http://localhost:4000/Implement-Q-learning-&-Double-Q-learning" rel="alternate" type="text/html" title="Q-learning &amp; Double Q-learning êµ¬í˜„" />
      <published>2022-05-12T13:23:00+09:00</published>
      <updated>2022-05-12T13:23:00+09:00</updated>
      <id>http://localhost:4000/Implement%20Q-learning%20&amp;%20Double%20Q-learning</id>
      <content type="html" xml:base="http://localhost:4000/Implement-Q-learning-&amp;-Double-Q-learning">&lt;h2 id=&quot;q-learningê³¼-double-q-learning&quot;&gt;Q-learningê³¼ Double Q-learning&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;h3 id=&quot;q-learning&quot;&gt;Q-learning&lt;/h3&gt;
&lt;p&gt;Q-learning ì€ Off-policy learning ì•Œê³ ë¦¬ì¦˜ ì¤‘ í•˜ë‚˜ì´ë©° Off-policy learning ì•Œê³ ë¦¬ì¦˜ ì¤‘ì—ì„œë„ TD Control Off-policy ë°©ì‹ì´ë‹¤. Off-policy learning ì•Œê³ ë¦¬ì¦˜ ì¤‘ Off-policy MCì™€ Off-policy TDê°€ ìˆì§€ë§Œ Importance sampling ë¬¸ì œ ë•Œë¬¸ì— ì‚¬ìš©ì´ ì–´ë µë‹¤. Q-learningëŠ” Importance samplingì´ í•„ìš”ì—†ëŠ” ë°©ë²•ìœ¼ë¡œ ë³´ë‹¤ ìœ ìš©í•˜ë‹¤. Q-learningì´ ìœ ì¼í•œ TD Control Off-policy ë°©ì‹ì€ ì•„ë‹ˆì§€ë§Œ ìœ ëª…í•˜ê³  ì˜ ì•Œë ¤ì ¸ ìˆëŠ” ì´ìœ ëŠ” êµ¬í˜„ì´ ë§¤ìš° ì‰½ê¸° ë•Œë¬¸ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;Q-learningì€ Bellman optimality backup operationì„ ìƒ˜í”Œ ê¸°ë°˜ìœ¼ë¡œ ì¶”ì‚°í•˜ì—¬ optimal action-value function Q(s, a)ë¥¼ ì°¾ì•„ê°„ë‹¤. ê·¸ë¦¬ê³  ì´ ì¶”ì‚°ì¹˜ëŠ” ì•„ë˜ ìˆ˜ì‹ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´, behavior policyê³¼ target policyì˜ ì˜í–¥ì„ ë°›ì§€ ì•Šê³  ë‹¨ì§€ action-value functionì—ë§Œ ì˜í–¥ì„ ë°›ëŠ”ë‹¤.&lt;/p&gt;

\[Q(s, a) \leftarrow  Q(s, a) +  (r + max Q(s&apos;, a&apos;)-Q(s,a))\]

&lt;p&gt;ë”°ë¼ì„œ Importance sampling(behavior policyê³¼ target policy ì‚¬ì´ì˜ ìƒê´€ê´€ê³„ë¥¼ ì§€ì›Œì£¼ê¸° ìœ„í•´ì„œ ì‚¬ìš©)ì„ í•  ì´ìœ  ìì²´ê°€ ì‚¬ë¼ì§„ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;double-q-learning&quot;&gt;Double Q-learning&lt;/h3&gt;
&lt;p&gt;ì–¸ëœ»ë³´ë©´ On-policy TD Controlì¸ SARSAë‚˜ ë‹¤ë¥¸ Off-policy learning ì•Œê³ ë¦¬ì¦˜ì— ë¹„í•´ì„œ ì¥ì ë§Œ ìˆì–´ ë³´ì´ì§€ë§Œ, Maximization biasë¼ëŠ” ë‹¨ì ì´ ì¡´ì¬í•œë‹¤. Maximization biasëŠ” Q-Learnerê°€ ê°€ì¹˜í•¨ìˆ˜ Q(s, a)ë¥¼ ì‹¤ì œ ê°’ë³´ë‹¤ ë†’ê²Œ í‰ê°€í•˜ëŠ” ë¬¸ì œì´ë‹¤. ì´ëŠ” MDPì˜ stochasticity ë•Œë¬¸ì— ë°œìƒí•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ëŸ° Maximization biasë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•œ ë°©ë²•ë“¤ë„ ì—¬ëŸ¬ê°€ì§€ê°€ ê°œë°œì´ ë˜ì—ˆëŠ” ë° ê·¸ ì¤‘ í•˜ë‚˜ê°€ Double Q-learningì´ë‹¤. Double Q-learningì€ Maximization biasë¥¼ single estimatorì˜ ë¬¸ì œì ìœ¼ë¡œ ê·œì •í•˜ê³ , ì´ì— ëŒ€í•œ ëŒ€ì•ˆìœ¼ë¡œ double estimatorë¥¼ ì œì•ˆí•œë‹¤.&lt;/p&gt;

&lt;p&gt;Double Q-learningì€ ì„œë¡œ ë…ë¦½ëœ ë‘ê°œì˜ Q-functions Q1(s, a)ì™€ Q2(s, a)ë¥¼ ë§Œë“¤ê³  ê°ê° 1/2ì˜ í™•ë¥ ë¡œ ì—…ë°ì´íŠ¸ë¥¼ í•´ì¤€ë‹¤. ì´ëŸ° ë°©ì‹ìœ¼ë¡œ ì•Œê³ ë¦¬ì¦˜ì´ ë™ì‘í•˜ë©´ Maximization biasê°€ ì–´ëŠ ì •ë„ í•´ê²°ë¨ì´ ì•Œë ¤ì ¸ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;q-learningê³¼-double-q-learning-êµ¬í˜„&quot;&gt;Q-learningê³¼ Double Q-learning êµ¬í˜„&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;ë³¸ê²©ì ìœ¼ë¡œ Q-learningê³¼ Double Q-learningì„ êµ¬í˜„í•´ë³´ì. êµ¬í˜„ì€ ì œê³µë°›ì€ Gridworld Classì™€ Q-learning, Deep Q-learning classì˜ skeletonì„ í™œìš©í•˜ì—¬, Q-learning, Deep Q-learning classì˜ methodì™€ Gridworld ë° policyë¥¼ visualization í•˜ëŠ” í•¨ìˆ˜ë¥¼ êµ¬í˜„í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;gridworld-visualization&quot;&gt;Gridworld visualization&lt;/h3&gt;
&lt;p&gt;í•™ìŠµì„ ëŒë¦° Grid worldì˜ í™˜ê²½ì„ í™•ì¸í•˜ê¸° ìœ„í•˜ì—¬ Grid world ì¸ìŠ¤í„´ìŠ¤ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;paint_maps()&lt;/code&gt; í•¨ìˆ˜ë¥¼ ë¨¼ì € êµ¬í˜„í•´ì£¼ì—ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;paint_maps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;savefig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;Grid World&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;c1&quot;&gt;# Placing the initial state on a grid for illustration
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;initials&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;initials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

   &lt;span class=&quot;c1&quot;&gt;# Placing the trap states on a grid for illustration
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;traps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;terminal_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;traps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

   &lt;span class=&quot;c1&quot;&gt;# Placing the terminal state on a grid for illustration
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;terminals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;terminals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;

   &lt;span class=&quot;c1&quot;&gt;# Make a discrete color bar with labels
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;States&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Initial&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;State&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Trap&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;States&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Terminal&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;State&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#F9FFA4&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#B4FF9F&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#FFA1A1&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#FFD59E&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ListedColormap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;insert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;## Make normalizer and formatter
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;matplotlib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BoundaryNorm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;matplotlib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ticker&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FuncFormatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;diff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;tickz&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;diff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initials&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;traps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;terminals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colorbar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ticks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tickz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;k&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;terminal_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;X&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;center&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;va&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;center&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;O&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;center&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;va&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;center&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;savefig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savefig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;./gridworld.png&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì½”ë“œ ì‹¤í–‰ ê²°ê³¼ë¡œ í™•ì¸í•œ GridworldëŠ” ë‹¤ìŒê³¼ ê°™ì´ ìƒê²¼ë‹¤.&lt;/p&gt;
&lt;div style=&quot;text-align: left&quot; width=&quot;100%&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/gridworld.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;h3 id=&quot;q-learning-êµ¬í˜„&quot;&gt;Q-learning êµ¬í˜„&lt;/h3&gt;
&lt;p&gt;ë‹¤ìŒìœ¼ë¡œ Q-learningì˜ ê° methodë¥¼ êµ¬í˜„í•˜ì˜€ë‹¤. êµ¬í˜„ ìƒì„¸ ë‚´ìš©ì€ ì½”ë“œ ë‚´ ì£¼ì„ì„ í†µí•´ ë‚˜íƒ€ë‚´ì—ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Q_learning&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uniform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# epsilonì˜ í™•ë¥ ë¡œ randomí•˜ê²Œ actionì„ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;action_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# 1-epsilonì˜ í™•ë¥ ë¡œ í•´ë‹¹ stateì—ì„œ ê°€ì¥ ë†’ì€ Qê°’ì„ ì¶”ì‚°í•˜ê³  ìˆëŠ” actionì„ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;action_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# actionì˜ list indexë¥¼ ê³„ì‚°
&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# Q-Learning target : reward + gamma * (ë‹¤ìŒ stateì—ì„œ ì¶”ì‚°í•˜ê³  ìˆëŠ” ê°€ì¥ ë†’ì€ Qê°’)
&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;td_target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# update : Q-Learning targetì—ì„œ Q(s, a)ë¥¼ ëº€ê°’ì„ ì—…ë°ì´íŠ¸ í•´ì¤€ë‹¤.
&lt;/span&gt;       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;td_target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_max_Q_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;max_Q_table&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# ê°€ëŠ¥í•œ ëª¨ë“  stateë¥¼ ëŒë©´ì„œ ìµœëŒ€ Qê°’ì„ ì°¾ì•„ max_Q_tableì— ì—…ë°ì´íŠ¸ í•´ì¤€ë‹¤.
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
           &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
               &lt;span class=&quot;n&quot;&gt;max_Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)].&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_Q_table&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Q-learning í•™ìŠµì´ ì˜ ë˜ì—ˆëŠ” ì§€ ì§ê´€ì ìœ¼ë¡œ í™•ì¸í•˜ê¸° ìœ„í•˜ì—¬ 10000ë²ˆ ì—í”¼ì†Œë“œ ë§ˆë‹¤ì˜ í•™ìŠµëœ policyë¥¼ ë„ì‹í™”í•´ë³´ì•˜ë‹¤. ì ì  ë” ë‚˜ì€ policyë¡œ ì˜ ê°€ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot; width=&quot;100%&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/q_learning_policy.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;ì´ policyë¥¼ ê·¸ë¦¬ê¸° ìœ„í•´ êµ¬í˜„í•œ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;plot_policy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;d_symbols&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;â†‘&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;â†’&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;â†“&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;â†&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#F9FFA4&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#B4FF9F&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#FFA1A1&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#FFD59E&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;# Placing the initial state on a grid for illustration
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;initials&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;initials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

   &lt;span class=&quot;c1&quot;&gt;# Placing the trap states on a grid for illustration
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;traps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;terminal_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;traps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

   &lt;span class=&quot;c1&quot;&gt;# Placing the terminal state on a grid for illustration
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;terminals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;terminals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ListedColormap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initials&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;traps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;terminals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interpolation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;nearest&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_yticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;edge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spine&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;spine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_visible&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xticklabels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_yticklabels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tick_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;x&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;w&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tick_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;y&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;w&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;which&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;minor&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;w&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;linestyle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;-&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;linewidth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tick_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;which&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;minor&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;direction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;direction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_symbols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;direction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;direction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;center&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;va&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;center&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;black&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;double-q-learning-êµ¬í˜„&quot;&gt;Double Q-learning êµ¬í˜„&lt;/h3&gt;
&lt;p&gt;ë§ˆì°¬ê°€ì§€ë¡œ Double Q-learningì˜ ê° methodë¥¼ êµ¬í˜„í•˜ì˜€ë‹¤. êµ¬í˜„ ìƒì„¸ ë‚´ìš©ì€ ì½”ë“œ ë‚´ ì£¼ì„ì„ í†µí•´ ë‚˜íƒ€ë‚´ì—ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Double_Q_learning&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uniform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# epsilonì˜ í™•ë¥ ë¡œ randomí•˜ê²Œ actionì„ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;action_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# 1-epsilonì˜ í™•ë¥ ë¡œ í•´ë‹¹ stateì—ì„œ ê°€ì¥ ë†’ì€ Qê°’ì„ ì¶”ì‚°í•˜ê³  ìˆëŠ” actionì„ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;# ì´ ë•Œ ê¸°ì¤€ì´ ë˜ëŠ” Qê°’ì€ Q1, Q2ê°’ì˜ í•©
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;action_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# 0.5ì˜ í™•ë¥ ë¡œ Q1ì„ ì—…ë°ì´íŠ¸
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;c1&quot;&gt;# actionì˜ list indexë¥¼ ê³„ì‚°
&lt;/span&gt;           &lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
           &lt;span class=&quot;c1&quot;&gt;# Q1 tableì—ì„œ next stateì—ì„œ ê°€ì¥ í° Qê°’ì„ ê°€ì§€ê³  ìˆëŠ” actionì˜ indexë¥¼ ê³„ì‚°
&lt;/span&gt;           &lt;span class=&quot;n&quot;&gt;q1_a_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
           &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q1_a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# ë‚˜ë¨¸ì§€ 0.5ì˜ í™•ë¥ ë¡œ Q2ë¥¼ ì—…ë°ì´íŠ¸
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;c1&quot;&gt;# actionì˜ list indexë¥¼ ê³„ì‚°
&lt;/span&gt;           &lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
           &lt;span class=&quot;c1&quot;&gt;# Q2 tableì—ì„œ next stateì—ì„œ ê°€ì¥ í° Qê°’ì„ ê°€ì§€ê³  ìˆëŠ” actionì˜ indexë¥¼ ê³„ì‚°
&lt;/span&gt;           &lt;span class=&quot;n&quot;&gt;q2_a_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
           &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q2_a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_max_Q_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;max_Q_table&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# ê°€ëŠ¥í•œ ëª¨ë“  stateë¥¼ ëŒë©´ì„œ ìµœëŒ€ Qê°’ì„ ì°¾ì•„ max_Q_tableì— ì—…ë°ì´íŠ¸ í•´ì¤€ë‹¤. ì´ ë•Œ, Q1, Q2 ì¤‘ Q2ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ í•˜ì˜€ë‹¤.
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
           &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
               &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                   &lt;span class=&quot;n&quot;&gt;max_Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)].&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_Q_table&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë§ˆì°¬ê°€ì§€ë¡œ Double Q-learning í•™ìŠµì´ ì˜ ë˜ì—ˆëŠ” ì§€ ì§ê´€ì ìœ¼ë¡œ í™•ì¸í•˜ê¸° ìœ„í•˜ì—¬ 10000 ì—í”¼ì†Œë“œë§ˆë‹¤ policyë¥¼ ê·¸ë ¤ë³´ì•˜ë‹¤. Double Q-learning policyë¥¼ ê·¸ë¦¬ëŠ” ë° Q-learning policyë¥¼ ê·¸ë¦´ ë•Œì™€ ê°™ì€ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot; width=&quot;100%&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/double_q_learning_policy.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;êµ¬í˜„-ê²°ê³¼-í™•ì¸&quot;&gt;êµ¬í˜„ ê²°ê³¼ í™•ì¸&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;êµ¬í˜„ì„ ì™„ë£Œí•œ ì´í›„ í•™ìŠµëœ ë‘ ëª¨ë¸ì˜ max Q-functionì„ ë½‘ì•„ plot í•´ë³´ì•˜ë‹¤. ì´ ê²°ê³¼ë¥¼ plotí•˜ëŠ” ë°ì—ëŠ” ì œê³µë°›ì€ í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot; width=&quot;100%&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/q-learning.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;ì´ ê·¸ë˜í”„ë¥¼ ì‚´í´ë³´ë©´ Q-learningì˜ max Q valueê³¼ Double Q-learningì˜ ê°’ì´ ìµœëŒ€ 50ì •ë„ê¹Œì§€ ì°¨ì´ê°€ ë‚œë‹¤. ì „ë°˜ì ìœ¼ë¡œ Q-learningì—ì„œ Q valueê°’ì´ Double Q-learningì—ì„œì˜ ê°’ë³´ë‹¤ overestimate ë˜ì—ˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="RL" />
      
        <category term="coding" />
      

      
        <summary type="html">Q-learningê³¼ Double Q-learning Â </summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">RecSys &amp;amp; RL - A Deep Reinforcement Learning Framework for News Recommendation</title>
      <link href="http://localhost:4000/%EA%B0%95%ED%99%94%ED%95%99%EC%8A%B5-%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%85%BC%EB%AC%B8-%EB%A6%AC%EB%B7%B0-1" rel="alternate" type="text/html" title="RecSys &amp; RL - A Deep Reinforcement Learning Framework for News Recommendation" />
      <published>2022-05-01T17:32:00+09:00</published>
      <updated>2022-05-01T17:32:00+09:00</updated>
      <id>http://localhost:4000/%EA%B0%95%ED%99%94%ED%95%99%EC%8A%B5%20%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C%20%EB%85%BC%EB%AC%B8%20%EB%A6%AC%EB%B7%B0-1</id>
      <content type="html" xml:base="http://localhost:4000/%EA%B0%95%ED%99%94%ED%95%99%EC%8A%B5-%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%85%BC%EB%AC%B8-%EB%A6%AC%EB%B7%B0-1">&lt;p&gt;ì´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A Deep Reinforcement Learning Framework for News Recommendation&lt;/code&gt; ë…¼ë¬¸ì€ ê°•í™”í•™ìŠµì„ í†µí•˜ì—¬ ì„±ëŠ¥ ì¢‹ì€ ë‰´ìŠ¤ ì¶”ì²œ ì‹œìŠ¤í…œì„ ë§Œë“œëŠ” ë°©ë²•ì— ëŒ€í•œ ë‚´ìš©ì„ ë‹´ê³  ìˆë‹¤. 2018ë…„ì— ì‘ì„±ë˜ì—ˆìœ¼ë©° www í•™íšŒì— accept ë˜ì—ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Â 
ë”¥ëŸ¬ë‹ ëª¨ë¸ì„ í™œìš©í•œ ê¸°ì¡´ ë‰´ìŠ¤ ì¶”ì²œ ì‹œìŠ¤í…œì˜ ì·¨ì•½ì &lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ë‹¤ì´ë‚˜ë¯¹í•˜ê²Œ ë³€í•˜ëŠ” ë‰´ìŠ¤ì˜ íŠ¹ì„±ê³¼ ë‰´ìŠ¤ì— ëŒ€í•œ ìœ ì €ì˜ ì„ í˜¸ë„ ë³€í™”ë¥¼ ê³ ë ¤í•  ë•Œ, online learning ì´ í•„ìš”í•˜ë‹¤. ê¸°ì¡´ì—ë„ ë‰´ìŠ¤ íŠ¹ì„±ê³¼ ìœ ì € ì„ í˜¸ë„ì˜ ë‹¤ì´ë‚˜ë¯¹í•œ ë³€í™”ë¥¼ ë°˜ì˜í•˜ëŠ” online recommendation modelì´ ìˆê¸°ëŠ” í–ˆì§€ë§Œ, ì´ ëª¨ë¸ë“¤ì€ í˜„ì¬ì˜ reward(e.g. Click Trhough Rate)ë§Œ ìµœì í™”í•˜ê¸° ë•Œë¬¸ì— í˜„ì¬ì˜ ì¶”ì²œì´ ë¯¸ë˜ì— ê°€ì ¸ì˜¬ íš¨ê³¼ê°€ ë¬´ì‹œë˜ì—ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;ê¸°ì¡´ ì¶”ì²œ ì‹œìŠ¤í…œì€ ìœ ì € feedbackë¡œ ì˜¤ì§ click/no click ì •ë³´ë§Œ ê³ ë ¤í–ˆë‹¤. ë”°ë¼ì„œ ë‰´ìŠ¤ë¥¼ íƒìƒ‰í•˜ë©´ì„œ ì‹¤ìˆ˜ë¡œ ì˜ëª» ëˆ„ë¥¸ ê¸°ì‚¬ì™€ ì •ë§ ì½ê³  ì‹¶ì–´ì„œ ì°¾ì•„ì„œ ë“¤ì–´ê°„ ê¸°ì‚¬ì˜ rewardëŠ” í™•ì‹¤íˆ ë‹¬ë¼ì•¼í•˜ì§€ë§Œ ì´ëŸ¬í•œ íŠ¹ì„±ì€ ì¡ì•„ë‚´ì§€ ëª»í•˜ì˜€ë‹¤.&lt;/li&gt;
  &lt;li&gt;ê¸°ì¡´ ì¶”ì²œ ì‹œìŠ¤í…œì€ ìœ ì €ì—ê²Œ ìœ ì‚¬í•œ ë‰´ìŠ¤ë¥¼ ê³„ì† ì¶”ì²œí•˜ë ¤ëŠ” ê²½í–¥ì´ ìˆë‹¤. ê·¸ë ‡ì§€ë§Œ ì´ë ‡ê²Œ ê³„ì† ë¹„ìŠ·í•œ ë‰´ìŠ¤ë¥¼ ì¶”ì²œí•´ì£¼ë©´ ì£¼ì œì— ëŒ€í•œ ì‚¬ìš©ìì˜ í¥ë¯¸ê°€ ì‰½ê²Œ ë–¨ì–´ì§„ë‹¤.
    &lt;ul&gt;
      &lt;li&gt;ì´ ë…¼ë¬¸ì´ ì“°ì—¬ì§ˆ ë‹¹ì‹œ State-of-art ê°•í™”í•™ìŠµ ë°©ì‹ì€ ë§ì€ ê²½ìš° ê°„ë‹¨í•œ $ \epsilon - greedy $ ë°©ì‹ì´ë‚˜ Upper Confidence Bound (UCB)ë¥¼ í™œìš©í•´ì™”ë‹¤. í•˜ì§€ë§Œ $ \epsilon - greedy $ ì€ ìœ ì €ê°€ ì „í˜€ ê´€ì‹¬ì—†ì–´í•˜ëŠ” ì•„ì´í…œì„ ì¶”ì²œí•  ìˆ˜ë„ ìˆê³ , UCBëŠ” cold-starter ë¬¸ì œê°€ ì¡´ì¬í•œë‹¤.(ê¸°ì¡´ ë°ì´í„°ê°€ ë§ì´ ì—†ë‹¤ë©´ reward ì¶”ì²­ì´ ë¶€ì •í™•í•¨)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;proposed-method&quot;&gt;Proposed method&lt;/h2&gt;
&lt;p&gt;Â 
ì´ëŸ¬í•œ ì·¨ì•½ì ì„ ê·¹ë³µí•˜ê¸° ìœ„í•˜ì—¬ ì´ ë…¼ë¬¸ì—ì„œëŠ” DQNì„ í™œìš©í•œ ë‹¤ìŒê³¼ ê°™ì€ ì¶”ì²œì‹œìŠ¤í…œì„ ì œì•ˆí•œë‹¤.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Contextual Multi-Armed Bandit models
    &lt;ul&gt;
      &lt;li&gt;ìµœê·¼ì— ëª‡ëª‡ ì‚¬ëŒë“¤ì´ ë”ìš± ë³µì¡í•œ ìœ ì € ì•„ì´í…œ ê´€ê³„ë¥¼ ëª¨ë¸ë§í•˜ê¸° ìœ„í•˜ì—¬ banditì„ clustering based collaborative filteringì´ë‚˜ matrix factorizationê³¼ í•©ì¹˜ê³ , reward functionì„ ê²°ì •í•˜ê¸° ìœ„í•˜ì—¬ social network ê´€ê³„ë¥¼ í™œìš©í•˜ëŠ” ì‹œë„ë¥¼ í•˜ì˜€ë‹¤.&lt;/li&gt;
      &lt;li&gt;í•˜ì§€ë§Œ ë…¼ë¬¸ì—ì„œ ì œì•ˆí•˜ëŠ” ëª¨ë¸ì€ ì´ì „ ëª¨ë¸ê³¼ëŠ” ë‹¤ë¥¸ë°, ë…¼ë¬¸ì˜ ëª¨ë¸ì€ Markov Decision Process (MDP)ë¥¼ ì ìš©í•˜ì—¬, ëª¨ë¸ì˜ future rewardë¥¼ í™œìš©í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Markov Decision Process models
    &lt;ul&gt;
      &lt;li&gt;ìœ ì €ì™€ ì•„ì´í…œ(ë‰´ìŠ¤)ê°„ì˜ ë³µì¡í•œ ê´€ê³„ë¥¼ ëª¨ë¸ë§í•˜ëŠ” ëŒ€ì‹ ì—, online news recommendationì˜ ë‹¤ì´ë‚˜ë¯¹í•œ íŠ¹ì„±ì— ì§‘ì¤‘í•˜ì—¬ future rewardë¥¼ ëª¨ë¸ë§í•œë‹¤.
(ê¸°ì¡´ì˜ Marti-Armed Bandit (MAB) ë°©ë²•ë“¤ê³¼ ë‹¤ë¦„)&lt;/li&gt;
      &lt;li&gt;ë” ë‚˜ì•„ê°€ MDP frameworkë¥¼ continuous stateì™€ action representationì™€ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ ì‰½ê²Œ í™•ì¥í•  ìˆ˜ ìˆê³ , ëª¨ë“  (state, action, reward) tupleì„ í™œìš©í•˜ì—¬ ëª¨ë¸ íŒŒë¼ë¯¸í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ í•™ìŠµí•  ìˆ˜ ìˆë‹¤.
(ê¸°ì¡´ì˜ MAP ë°©ë²•ë“¤ê³¼ ë‹¤ë¦„)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ë˜í•œ, ì¶”ì²œì— ë‹¤ì–‘ì„±ì„ ì¦ê°€ì‹œí‚¤ê¸° ìœ„í•˜ì—¬ Exploration strategyë¡œ Dueling Bandit Gradient Descent exploration strategyë¥¼ í™œìš©í•˜ëŠ”ë°, ì—¬ê¸°ì—ëŠ” ë‘ ê°€ì§€ ì´ìœ ê°€ ìˆë‹¤.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;recommendation ë‹¤ì–‘ì„±ì„ ì¦ê°€ì‹œí‚¤ê¸° ìœ„í•¨&lt;/li&gt;
  &lt;li&gt;ê³ ì „ì ì¸ exploration strategies (ex&amp;gt; e-greedy, Upper Confidence Bound)ë¡œ ë¶€í„° ë°œìƒí•˜ëŠ” recommendation accuracy ê°ì†Œë¥¼ ë§‰ê¸° ìœ„í•¨&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;model-framework&quot;&gt;Model framework&lt;/h3&gt;
&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/recsys1.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;ìœ„ ê·¸ë¦¼ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´, ë…¼ë¬¸ì˜ ëª¨ë¸ì€ offline ë°©ì‹ê³¼ online ë°©ì‹ìœ¼ë¡œ ë‚˜ë‰˜ì–´ì ¸ ìˆë‹¤.
offline stageì—ì„œëŠ” ë¯¸ë¦¬ ìˆ˜ì§‘í•´ë‘” ë°ì´í„°(user-news click logs)ì— Deep Q-Networkë¥¼ ì ìš©í•˜ì—¬ rewardë¥¼ ì˜ˆì¸¡í•œë‹¤. ì´ offline ë°©ì‹ì„ í†µí•˜ì—¬ 4ê°€ì§€ì˜ feature(News, User, User news, Context)ê°€ ì¶”ì¶œëœë‹¤.
ê·¸ëŸ° ë‹¤ìŒ, online stageì—ì„œëŠ” ì‹¤ì œ ì‘ë™í•˜ëŠ” online serviceë¥¼ í†µí•˜ì—¬ recommendation agent Gê°€ ì§ì ‘ ìœ ì €ì™€ ìƒí˜¸ì‘ìš©í•˜ë©° networkë¥¼ ì—…ë°ì´íŠ¸ í•´ë‚˜ê°„ë‹¤.
ì˜¨ë¼ì¸ ì—…ë°ì´íŠ¸ ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;

&lt;p&gt;(1) PUSH:
ìœ ì €ê°€ ë‰´ìŠ¤ ìš”ì²­ì„ ë³´ë‚´ë©´, recommendation agent GëŠ” í•´ë‹¹ ìœ ì €ì˜ featuresì™€ ë‰´ìŠ¤ í›„ë³´êµ°(í˜„ì¬ ì¶”ì²œ ë°›ì€ ë¦¬ìŠ¤íŠ¸ì™€ ìœ ì‚¬ë„ê°€ ë†’ì€ ê¸°ì‚¬ ë¬´ì‘ìœ„ ì¶”ì¶œ)ì„ ë°›ì•„ ì¶”ì²œí•  top-k ë‰´ìŠ¤ ë¦¬ìŠ¤íŠ¸ë¥¼ ìƒì„±í•œë‹¤.
(2) FEEDBACK:
ìœ ì €ëŠ” ë‰´ìŠ¤ ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ë¥¼ ë³´ê³  ê°ê°ì˜ ì•„ì´í…œì„ í´ë¦­í•˜ê±°ë‚˜, í´ë¦­í•˜ì§€ ì•ŠìŒìœ¼ë¡œì„œ feedbackì„ ì¤€ë‹¤.
(3) MINOR UPDATE
ê° timestampë§ˆë‹¤ exploitation networkì™€ exploration networkë¥¼ ë¹„êµí•˜ì—¬, ë§Œì•½ exploration networkì˜ ì„±ëŠ¥ì´ ë” ì¢‹ë‹¤ë©´, í˜„ì¬ networkë¥¼ exploration networkìª½ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•˜ê³ , ë°˜ëŒ€ë¡œ exploitation networkì˜ ì„±ëŠ¥ì´ ë” ì¢‹ë‹¤ë©´ ê·¸ëŒ€ë¡œ ë‘”ë‹¤.
(4) MAJOR UPDATE
íŠ¹ì • ì •í•´ë‘” ì‹œê°„ì´ ì§€ë‚˜ê³  ë‚œ í›„, &lt;strong&gt;experience replay&lt;/strong&gt; techniqueì„ ì‚¬ìš©í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ë¥¼ ì—…ë°ì´íŠ¸ í•œë‹¤. ì¢€ ë” ìì„¸í•˜ê²Œ, ì‚¬ìš©ì feedbackê³¼ ë©”ëª¨ë¦¬ì— ì €ì¥ ëœ user activenessë¥¼ ì¶”ê°€í•œë‹¤. (agentê°€ ìµœê·¼ì˜ click, activeness ê¸°ë¡ì„ ìœ ì§€)&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;experiment&quot;&gt;Experiment&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;h3 id=&quot;offline-part&quot;&gt;Offline Part&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;ìƒì—… ë‰´ìŠ¤ ì¶”ì²œ ì•±ì—ì„œ ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•œë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;online-part&quot;&gt;Online Part&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;offline dataë¡œ ëª¨ë¸ì„ pre-train&lt;/li&gt;
  &lt;li&gt;ì‹¤í—˜ìš© ì•±ì„ ë°°í¬í•˜ì—¬ í•œë‹¬ ë™ì•ˆ ìš´ì˜. ì‹¤í—˜êµ°ì„ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ  ê° ê·¸ë£¹ì— í…ŒìŠ¤íŠ¸í•  ëª¨ë¸ë¡œ ì¶”ì²œëœ ë‰´ìŠ¤ë¥¼ ë³´ì—¬ì¤€ë‹¤.&lt;/li&gt;
  &lt;li&gt;ìœ ì €ë¡œë¶€í„° ë‰´ìŠ¤ ìš”ì²­ì´ ë“¤ì–´ê°ˆ ë•Œë§ˆë‹¤ ë‰´ìŠ¤ë¥¼ ì¶”ì²œí•´ì£¼ê³  ì´ë“¤ ë‰´ìŠ¤ì— ëŒ€í•œ ìœ ì € í”¼ë“œë°±(click or not)ì´ ê¸°ë¡ëœë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;overall-experiment-flow&quot;&gt;Overall experiment flow&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;ë¨¼ì € offline dataë¡œ ëª¨ë¸ì„ í•™ìŠµí•œë‹¤.&lt;/li&gt;
  &lt;li&gt;Online ë‰´ìŠ¤ ì•±ì— ê°™ì€ ë¹„ìœ¨ë¡œ ê°ê° ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ ëª¨ë¸ì„ ë°°ì •í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;Onlineìœ¼ë¡œ ë°°í¬í•œ ë‰´ìŠ¤ ì•±ì— ìœ ì €ê°€ ë“¤ì–´ì™€ì„œ ë‰´ìŠ¤ë¥¼ ìš”ì²­í•˜ë©´, candidates ê¸°ì‚¬ ì„¸íŠ¸ë¥¼ ë°°ì •ëœ ëª¨ë¸ì— ë³´ë‚¸ë‹¤.&lt;/li&gt;
  &lt;li&gt;ëª¨ë¸ì„ Current networkì™€ Explore networkë¡œ ë‚˜ëˆ„ì–´ candidates ê¸°ì‚¬ inputì„ ì ìš©í•œë‹¤. (PUSH ê³¼ì •)
    &lt;ul&gt;
      &lt;li&gt;ì´ ë•Œ, Explore networkëŠ” current network ëª¨ë¸ì—ì„œì˜ ê°€ì¤‘ì¹˜ íŒŒë¼ë¯¸í„°ë¥¼ Gaussian Random Noiseê¸°ë²•ì„ í†µí•´ ì—…ë°ì´íŠ¸í•œë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;
&lt;div style=&quot;text-align: left&quot;&gt;
    &lt;img src=&quot;/assets/img/post_images/drn2.png&quot; width=&quot;70%&quot; /&gt;
  &lt;/div&gt;
&lt;ol&gt;
  &lt;li&gt;ë‘ ëª¨ë¸ì—ì„œ ë°˜í™˜í•˜ëŠ” ë¦¬ìŠ¤íŠ¸ë¥¼ í•©ì³ ìœ ì €ì˜ rewardê°€ ë°œìƒí•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê³  ë‘ ëª¨ë¸ì˜ rewardë¥¼ ë¹„êµí•œë‹¤. (FEEDBACK ê³¼ì •)&lt;/li&gt;
  &lt;li&gt;ë§Œì•½ Explore networkì˜ ì„±ëŠ¥ì´ ë” ì¢‹ë‹¤ë©´, Explore networkì˜ íŒŒë¼ë¯¸í„°ë¥¼ ë‹¤ìŒ stepì˜ íŒŒë¼ë¯¸í„°ë¡œ ì—…ë°ì´íŠ¸ í•œë‹¤. (MINOR UPDATE ê³¼ì •)&lt;/li&gt;
  &lt;li&gt;Major update ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ì„¤ì •ëœ ì‹œê°„ì´ ë˜ê¸° ì „ê¹Œì§€ 2~6 ê³¼ì •ì„ ë°˜ë³µí•œë‹¤. ì´ ê³¼ì •ì—ì„œ user activenessì— ëŒ€í•œ ì •ë³´ë¥¼ memoryì— ì¶”ê°€í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ë©”ëª¨ë¦¬ì— ìˆëŠ” ë°ì´í„°(recent historical click &amp;amp; user activeness records) ì¤‘ batch sizeë§Œí¼ ìƒ˜í”Œë§í•´ì„œ ëª¨ë¸ì„ ì—…ë°ì´íŠ¸í•œë‹¤. (MAJOR UPDATE ê³¼ì •)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ì‹¤í—˜ ê²°ê³¼, ë…¼ë¬¸ì˜ ë°©ë²•ìœ¼ë¡œ ì¶”ì²œ ì •í™•ë„ì™€ ì¶”ì²œ ë‹¤ì–‘ì„±ì„ ìƒë‹¹íˆ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆì—ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;ì´í›„ ì‹¤í—˜ì—ì„œ ìœ ì €ë¥¼ ì—¬ëŸ¬ ê·¸ë£¹ì„ ë‚˜ëˆ„ì–´ì„œ(heavy users and one-time users ë“±) ëª¨ë¸ì„ ë””ìì¸í•˜ë©´ ë” ì˜ë¯¸ìˆì„ ê²ƒì´ë‹¤.
    &lt;ul&gt;
      &lt;li&gt;ë§Œì•½ ê° ìœ ì € ê·¸ë£¹ì—ì„œ ì„œë¡œ ë‹¤ë¥¸ íŒ¨í„´ì´ ë°œê²¬ë˜ë©´ ë” ë§ì€ ì¸ì‚¬ì´íŠ¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â &lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&quot;references-&quot;&gt;references :&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://jisoo-coding.tistory.com/27&quot;&gt;https://jisoo-coding.tistory.com/27&lt;/a&gt;&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="RecSys" />
      
        <category term="RL" />
      
        <category term="paper" />
      

      
        <summary type="html">ì´ A Deep Reinforcement Learning Framework for News Recommendation ë…¼ë¬¸ì€ ê°•í™”í•™ìŠµì„ í†µí•˜ì—¬ ì„±ëŠ¥ ì¢‹ì€ ë‰´ìŠ¤ ì¶”ì²œ ì‹œìŠ¤í…œì„ ë§Œë“œëŠ” ë°©ë²•ì— ëŒ€í•œ ë‚´ìš©ì„ ë‹´ê³  ìˆë‹¤. 2018ë…„ì— ì‘ì„±ë˜ì—ˆìœ¼ë©° www í•™íšŒì— accept ë˜ì—ˆë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">RL - Autonomous Driving Based on Modified SAC Algorithm through Imitation Learning Pre-training</title>
      <link href="http://localhost:4000/RL-Autonomous-Driving-Based-on-Modified-SAC-Algorithm-through-Imitation-Learning-Pre-training" rel="alternate" type="text/html" title="RL - Autonomous Driving Based on Modified SAC Algorithm through Imitation Learning Pre-training" />
      <published>2022-04-30T17:32:00+09:00</published>
      <updated>2022-04-30T17:32:00+09:00</updated>
      <id>http://localhost:4000/RL%20-%20Autonomous%20Driving%20Based%20on%20Modified%20SAC%20Algorithm%20through%20Imitation%20Learning%20Pre-training</id>
      <content type="html" xml:base="http://localhost:4000/RL-Autonomous-Driving-Based-on-Modified-SAC-Algorithm-through-Imitation-Learning-Pre-training">&lt;p&gt;This paper is a follow-up to the paper written 2 years ago. Although the core idea is the same, since the previously used DDPG algorithm did not converge well, SAC was used instead.&lt;/p&gt;

&lt;h2 id=&quot;background&quot;&gt;Background&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;This paper is based on the previous study with very similar settings but difference
model.&lt;/li&gt;
  &lt;li&gt;The DDPG algorithm(previously used) seems to have not much high convergence
during training&lt;/li&gt;
  &lt;li&gt;Instead, use SAC(Soft Actor Critic) algorithm
    &lt;ul&gt;
      &lt;li&gt;Robustness, stability and well-convergence&lt;/li&gt;
      &lt;li&gt;State-of-the-art off-policy actor critic deep reinforcement learning algorithm based on the maximum entropy reinforcement learning framework&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;proposed-method&quot;&gt;Proposed method&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Single-Q SAC Algorithm : use SAC with some slight differences due to the method of combining imitation learning and reinforcement learning
    &lt;ul&gt;
      &lt;li&gt;The original SAC has two target parameters for Q-function&lt;/li&gt;
      &lt;li&gt;However, with previous experiment, the average return over 5 runs of 3 million iterations of SAC algorithm with double-A and SAC algorithm with single-Q are quite similar, so they only use one target parameter for each network and do not update the temperature parameter Î± for simplicity&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;results&quot;&gt;Results&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Although using pure SAC can result in a good performance, it still has a lower
average accumulated reward after 100 episodes than their method.
    &lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/sc3.png&quot; width=&quot;70%&quot; /&gt;
&lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="Autonomous driving" />
      
        <category term="RL" />
      
        <category term="paper" />
      

      
        <summary type="html">This paper is a follow-up to the paper written 2 years ago. Although the core idea is the same, since the previously used DDPG algorithm did not converge well, SAC was used instead.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">RL - Improved Reinforcement Learning through Imitation Learning Pretraining Towards Image-based Autonomous Drivings</title>
      <link href="http://localhost:4000/RL-Improved-Reinforcement-Learning-through-Imitation-Learning-Pretraining-Towards-Image-based-Autonomous-Driving" rel="alternate" type="text/html" title="RL - Improved Reinforcement Learning through Imitation Learning Pretraining Towards Image-based Autonomous Drivings" />
      <published>2022-04-30T10:32:00+09:00</published>
      <updated>2022-04-30T10:32:00+09:00</updated>
      <id>http://localhost:4000/RL%20-%20Improved%20Reinforcement%20Learning%20through%20Imitation%20Learning%20Pretraining%20Towards%20Image-based%20Autonomous%20Driving</id>
      <content type="html" xml:base="http://localhost:4000/RL-Improved-Reinforcement-Learning-through-Imitation-Learning-Pretraining-Towards-Image-based-Autonomous-Driving">&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Improved Reinforcement Learning through Imitation Learning Pretraining Towards Image-based Autonomous Drivings&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Autonomous Driving Based on Modified SAC Algotirhm through Imitation Learning Pre-training&lt;/code&gt;, which will be covered in the next article, were written in the lab of Prof. Dong Eui Chang at KAIST and deal with how to improve autonomous driving learning using reinforcement learning.&lt;/p&gt;

&lt;p&gt;More specifically, in the image-based autonomous driving task, imitation learning and reinforcement learning are combined and used together to utilize each othersâ€™ strength. The difference between the two papers is that the first paper uses DDPG as reinforcement learning whereas the second paper uses SAC.&lt;/p&gt;

&lt;h2 id=&quot;background&quot;&gt;Background&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;The problem of generating control decision given a monocular camera image and other auxiliary vehicle sensorsâ€™ outputs has aroused a lot of interest in recent years.&lt;/li&gt;
  &lt;li&gt;Conducting imitation learning towards given human policy might produce a relative well-performed policy
    &lt;ul&gt;
      &lt;li&gt;However, limitation on the possible policy performance and the potential lack of generalizability for unseen situations.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Instead, using RL in a simulator and then transfer the learned policy to real world is very popular in recent research.
    &lt;ul&gt;
      &lt;li&gt;Nonetheless, when the state and action spaces are huge or high dimensional, pure RL algorithm training process usually diverges.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;They present a method which combines these two methods and thus leverage both their advantages for this image-based autonomous driving task.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;proposed-method&quot;&gt;Proposed method&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;
Â 
(1) pre-training(imitation learning) -&amp;gt; (2) fine-tuning(DDPG)&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Network architecture
    &lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/rl_driving1_1.png&quot; width=&quot;70%&quot; /&gt;
&lt;/div&gt;
    &lt;ul&gt;
      &lt;li&gt;ResNet-34 architecture
        &lt;ul&gt;
          &lt;li&gt;One of CNN network for deep reinforcement learning tasks like environmental perception, model compression, and object detection&lt;/li&gt;
          &lt;li&gt;Use ResNet-34 as the backbone structure for both actor and critic networks&lt;/li&gt;
          &lt;li&gt;The simple and light ResNet-34 out performs other architectures with attention module integrated in terms of both final testing loss and the generated policyâ€™s performance.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Imitation learning phase
    &lt;ul&gt;
      &lt;li&gt;Aim to generate a good initial policy&lt;/li&gt;
      &lt;li&gt;Consider current image input and current vehicle speed as our current state inputs, and throttle, brake from zero to one and steering from minus one to positive one as our control outputs&lt;/li&gt;
      &lt;li&gt;Use Huber loss : to less sensitive to outliers and can make the training process more stable compared to MSE as a result.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Reinforcement learning phase
    &lt;ul&gt;
      &lt;li&gt;Reward : distance to the nearest obstacle and current velocity
        &lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/rl_driving1_2.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;
      &lt;/li&gt;
      &lt;li&gt;Continuous and deterministic policy setting : to prevent possible catastrophic effect under undesired behavior.&lt;/li&gt;
      &lt;li&gt;In order to combine with imitation learning, they make several changes on the original DDPG
        &lt;ul&gt;
          &lt;li&gt;actor, critic networks
            &lt;ul&gt;
              &lt;li&gt;actor network : give all the weights of the pre-trained actor network to the actor networks used in the DDPG.&lt;/li&gt;
              &lt;li&gt;critic network : give all the weights except the final fully connected layer to critic networks used in the DDPG.&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;replay pool : train actor and critic networks using the samples collected under imitation learningâ€™s generated policy. Then, use normal DDPG to collect new experience&lt;/li&gt;
          &lt;li&gt;removing OU noise&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;experiments&quot;&gt;Experiments&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Imitation learning phase
    &lt;ul&gt;
      &lt;li&gt;Use an Xbox controller to control the car under various weather and lighting conditions and record the data using Airsim API&lt;/li&gt;
      &lt;li&gt;1000 for each episode and terminates when a collision happens.&lt;/li&gt;
      &lt;li&gt;Randomly choose the weather condition and the initial position of the car before each episode starts and calculate a 5 episodesâ€™ average accumulated reward as the criteria.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;RL phase
    &lt;ul&gt;
      &lt;li&gt;Same setting as imitation learnin phase&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Results
    &lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img width=&quot;100%&quot; src=&quot;/assets/img/post_images/rl_driving1_3.png&quot; /&gt;
&lt;/div&gt;
    &lt;ul&gt;
      &lt;li&gt;Eventually, their proposed method achieves a considerable performance boost from the original imitation learningâ€™s learned policy while the pure DDPG never performs well and does not show any improving trend.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="Autonomous driving" />
      
        <category term="RL" />
      
        <category term="paper" />
      

      
        <summary type="html">Improved Reinforcement Learning through Imitation Learning Pretraining Towards Image-based Autonomous Drivings and Autonomous Driving Based on Modified SAC Algotirhm through Imitation Learning Pre-training, which will be covered in the next article, were written in the lab of Prof. Dong Eui Chang at KAIST and deal with how to improve autonomous driving learning using reinforcement learning.</summary>
      

      
      
    </entry>
  
</feed>
