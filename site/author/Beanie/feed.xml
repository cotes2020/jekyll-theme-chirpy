<?xml version="1.0" encoding="utf-8"?>

<feed xmlns="http://www.w3.org/2005/Atom" >
  <generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator>
  <link href="http://localhost:4000/author/Beanie/feed.xml" rel="self" type="application/atom+xml" />
  <link href="http://localhost:4000/" rel="alternate" type="text/html" />
  <updated>2022-05-22T19:09:32+09:00</updated>
  <id>http://localhost:4000/author/Beanie/feed.xml</id>

  
  
  

  
    <title type="html">Beanie in the wind | </title>
  

  
    <subtitle>Beanie &amp; Kaze&apos;s tech blog</subtitle>
  

  

  
    
      
    
      
    
  

  
  

  
    <entry>
      <title type="html">ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ ë…¸íŠ¸ ì‘ì„± ì„œë¹„ìŠ¤ Catty ì†Œê°œ</title>
      <link href="http://localhost:4000/Introduce-Catty,-the-resource-based-note-taking-app" rel="alternate" type="text/html" title="ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ ë…¸íŠ¸ ì‘ì„± ì„œë¹„ìŠ¤ Catty ì†Œê°œ" />
      <published>2022-05-20T16:32:00+09:00</published>
      <updated>2022-05-20T16:32:00+09:00</updated>
      <id>http://localhost:4000/Introduce%20Catty,%20the%20resource%20based%20note-taking%20app</id>
      <content type="html" xml:base="http://localhost:4000/Introduce-Catty,-the-resource-based-note-taking-app">&lt;p&gt;ì‘ë…„ 11ì›”ë¶€í„° í‹ˆí‹ˆíˆ ê³µë¶€ê²¸ ì‚¬ì´ë“œ í”„ë¡œì íŠ¸ ê²¸ Catty ì„œë¹„ìŠ¤ë¥¼ ê°œë°œí•˜ì˜€ë‹¤. ì´ë²ˆ ê¸€ì—ì„œëŠ” Cattyì— ë„£ì€ ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤ì„ ì†Œê°œí•˜ê³  ë‹¤ìŒê¸€ì—ì„œëŠ” íšŒê³  í˜•ì‹ìœ¼ë¡œ ì§€ê¸ˆê» ê°œë°œí•˜ë©´ì„œ ëŠë¼ê³  ìƒê°í•œ ê²ƒë“¤ì„ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;catty-ì„œë¹„ìŠ¤ê°€-ë­”ë°&quot;&gt;Catty ì„œë¹„ìŠ¤ê°€ ë­”ë°?&lt;/h2&gt;
&lt;video controls=&quot;&quot; autoplay=&quot;autoplay&quot; loop=&quot;loop&quot; width=&quot;100%&quot;&gt;
  &lt;source src=&quot;/assets/img/post_images/catty_introduce.mp4&quot; type=&quot;video/mp4&quot; /&gt;
&lt;/video&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;CattyëŠ” ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ì˜ ë…¸íŠ¸ ì‘ì„± ì„œë¹„ìŠ¤ì´ë‹¤. ë‹¹ì¥ ë‚˜ë¥¼ í¬í•¨í•´ ë§ì€ ì‚¬ëŒë“¤ì´ ê³¼ì œë¥¼ í•˜ê±°ë‚˜ ë³´ê³ ì„œë¥¼ ì‘ì„±í•˜ê±°ë‚˜ ìŠ¤í„°ë””ë¥¼ í•  ë•Œ, ì¸í„°ë„· ìƒì˜ ë‹¤ì–‘í•œ ìë£Œë“¤ì„ ì°¸ê³ í•˜ì—¬ ê¸€ì„ ì ê³¤ í•œë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/catty_introduce6.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;ê·¸ë ‡ì§€ë§Œ ê¸€ì„ ì ìœ¼ë©´ì„œ ë¦¬ì„œì¹˜ë¥¼ í•˜ë‹¤ë³´ë©´ ì´ë ‡ê²Œ íƒ­ì´ ë§ì•„ì§€ê¸° ì¼ìˆ˜ì´ë‹¤. ì´ë ‡ê²Œ ë˜ë©´ ì–´ë–¤ íƒ­ì´ ì–´ë–¤ ë‚´ìš©ì„ ë‹´ê³  ìˆëŠ” ì§€ í™•ì¸ë„ ì–´ë ¤ì›Œì§€ê³ , íƒ­ì„ ê³„ì† ì™”ë‹¤ê°”ë‹¤ í•˜ë©° ê¸€ì„ ì ì–´ì•¼ í•´ì„œ ì‹œê°„ë„ ì˜¤ë˜ê±¸ë¦¬ê³  ë¶ˆí¸í•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;ë˜í•œ ê°œì¸ì ìœ¼ë¡œ ì§€í•˜ì² ì´ë‚˜ ë²„ìŠ¤ì—ì„œ ì´ë™í•˜ë©´ì„œ ìë£Œì¡°ì‚¬ë¥¼ í•˜ëŠ” ê²½ìš°ê°€ ë§ì€ ë° ì´ë ‡ê²Œ ì°¾ì€ ìë£Œë“¤ì€ ë§‰ìƒ ê¸€ì„ ì“°ë©´ì„œ ì°¸ê³ í•˜ë ¤ê³  í•˜ë©´ ì–´ë””ì— ì €ì¥ë˜ì–´ ìˆëŠ” ì§€ ì°¾ê¸°ê°€ ì–´ë µë‹¤. ê²°êµ­ ìœ ìš©í–ˆë˜ ë¦¬ì†ŒìŠ¤ë¥¼ ë‹¤ì‹œ ë’¤ì ¸ê°€ë©° ì°¾ê±°ë‚˜ í¬ê¸°í•˜ê³  ìƒˆë¡œ ë¦¬ì„œì¹˜ë¥¼ ì‹œì‘í•  ë•Œë„ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;CattyëŠ” ì´ëŸ° ë¶ˆí¸í•¨ì—ì„œ ì‹œì‘í•´ì„œ ì—¬ëŸ¬ ë¦¬ì†ŒìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ë…¸íŠ¸ë¥¼ ì‘ì„±í•˜ê¸°ì— í¸ë¦¬í•œ ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤ì„ ë…¹ì˜€ë‹¤.&lt;/p&gt;

&lt;!-- * í•µì‹¬ í‚¤ì›Œë“œ
  * ë¦¬ì†ŒìŠ¤ ìˆ˜ì§‘ / ë¦¬ì†ŒìŠ¤ í•˜ì´ë¼ì´íŠ¸ / ë…¸íŠ¸ ì‘ì„±

* ê¸°ìˆ  ìŠ¤íƒ
  * `React` `Next` `typescript` `Redux-toolkit` `tailwind css` `eslint` `prettier` `Typesense` `Firestore` `AWS Lambda` `AWS S3` `Vercel` --&gt;

&lt;p&gt;Catty ì„œë¹„ìŠ¤ëŠ” í¬ê²Œ &lt;strong&gt;ë¦¬ì†ŒìŠ¤ ìˆ˜ì§‘&lt;/strong&gt;, &lt;strong&gt;ë¦¬ì†ŒìŠ¤ í•˜ì´ë¼ì´íŠ¸&lt;/strong&gt;, &lt;strong&gt;ë…¸íŠ¸ ì‘ì„±&lt;/strong&gt; 3ê°œì˜ ê¸°ëŠ¥ìœ¼ë¡œ ë‚˜ë‰œë‹¤. ê°ê°ì˜ ê¸°ëŠ¥ì„ ì•„ë˜ì—ì„œ ë” ìì„¸íˆ ì„¤ëª…í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;1-ë¦¬ì†ŒìŠ¤-ìˆ˜ì§‘&quot;&gt;&lt;strong&gt;(1) ë¦¬ì†ŒìŠ¤ ìˆ˜ì§‘&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;Â 
Cattyì—ì„œëŠ” ëª¨ë°”ì¼-ì›¹ì—ì„œ í¸ë¦¬í•˜ê²Œ ìë£Œë¥¼ ìˆ˜ì§‘í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ë°©ë²•ë“¤ì„ ì§€ì›í•œë‹¤. Cattyì˜ ì›¹í´ë¦¬í¼, ì•±ì„ ì´ìš©í•˜ë©´ í•œ ë²ˆì˜ í´ë¦­ìœ¼ë¡œ ì›¹ìƒì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ë°”ë¡œ ìˆ˜ì§‘í•  ìˆ˜ ìˆë‹¤!&lt;/p&gt;

&lt;p&gt;ìë£Œë¥¼ ìˆ˜ì§‘í•  ë•Œ í´ë”ì™€ íƒœê·¸ë¥¼ ì„ íƒí•  ìˆ˜ ìˆë‹¤. íƒœê·¸ëŠ” ì¸ìŠ¤íƒ€ê·¸ë¨ íƒœê·¸ ë‚¨ê¸°ë“¯ì´ ìë£Œë¥¼ ìˆ˜ì§‘í•  ë•Œ ë©”ëª¨ì— &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#&lt;/code&gt;ê³¼ í•¨ê»˜ íƒœê·¸ë¥¼ ë‚¨ê²¨ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. ì´ íƒœê·¸ê°€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(3) ë…¸íŠ¸ ì‘ì„±&lt;/code&gt;ì—ì„œ ë…¸íŠ¸ ì‘ì„±í•  ë•Œ ì°¸ê³ í•  ìë£Œë“¤ì˜ ê¸°ì¤€ì´ ëœë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;í¬ë¡¬-ìµìŠ¤í…ì…˜ì›¹í´ë¦¬í¼&quot;&gt;í¬ë¡¬ ìµìŠ¤í…ì…˜(ì›¹í´ë¦¬í¼)&lt;/h3&gt;

&lt;p&gt;ì•„ë˜ ë™ì˜ìƒì—ì„œ ë³´ì—¬ì§€ë“¯ì´ Catty ì›¹í´ë¦¬í¼ë¥¼ í†µí•´ ë²„íŠ¼ í´ë¦­ë§Œìœ¼ë¡œ ì›¹í˜ì´ì§€ url, ìŠ¤í¬ë¦°ìƒ·, ê·¸ë¦¬ê³  ìœ íŠœë¸Œ ì˜ìƒ ìº¡ì³ë¥¼ ë°”ë¡œ ìˆ˜ì§‘í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;
&lt;video controls=&quot;&quot; autoplay=&quot;autoplay&quot; loop=&quot;loop&quot; width=&quot;100%&quot;&gt;
  &lt;source src=&quot;/assets/img/post_images/catty_introduce1.mov&quot; type=&quot;video/mp4&quot; /&gt;
&lt;/video&gt;

&lt;p&gt;Catty í¬ë¡¬ ìµìŠ¤í…ì…˜ì€ &lt;a href=&quot;https://chrome.google.com/webstore/detail/catty-web-clipper/kjajbpgmgnojjjjihidkagemppicbjpg&quot;&gt;https://chrome.google.com/webstore/detail/catty-web-clipper/kjajbpgmgnojjjjihidkagemppicbjpg&lt;/a&gt;ì—ì„œ ë‹¤ìš´ë°›ì„ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ëª¨ë°”ì¼ì•±&quot;&gt;ëª¨ë°”ì¼ì•±&lt;/h3&gt;

&lt;p&gt;ëª¨ë°”ì¼ì•±ì—ì„œë„ ë‹¤ì–‘í•œ íƒ€ì…ì˜ ìë£Œë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. íŠ¹íˆ ë°”ë¡œê°€ê¸° ê¸°ëŠ¥ì„ í†µí•´ ì•±ì„ ì—´ì§€ ì•Šê³  ìƒë‹¨ë°”ì˜ ë²„íŠ¼ í´ë¦­ìœ¼ë¡œ ìë£Œë¥¼ ì¶”ê°€í•  ìˆ˜ë„ ìˆë‹¤.&lt;/p&gt;
&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/catty_introduce7.png&quot; width=&quot;60%&quot; /&gt;
&lt;/div&gt;

&lt;h3 id=&quot;ì›¹ì•±&quot;&gt;ì›¹ì•±&lt;/h3&gt;

&lt;p&gt;ì›¹ì•±ì—ì„œëŠ” ì•„ë˜ ê·¸ë¦¼ì˜ í™”ì‚´í‘œê°€ ê°€ë¦¬í‚¤ëŠ” íŒ¨ë„ì— íŒŒì¼ì„ ë“œë˜ê·¸ ë“œë¡­ìœ¼ë¡œ ëŒì–´ë‹¤ ë†“ê±°ë‚˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ìë£Œë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;
&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/catty_introduce3.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;2-ë¦¬ì†ŒìŠ¤-í•˜ì´ë¼ì´íŠ¸&quot;&gt;&lt;strong&gt;(2) ë¦¬ì†ŒìŠ¤ í•˜ì´ë¼ì´íŠ¸&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;Â 
ë˜í•œ Cattyì—ì„œëŠ” ë¦¬ì†ŒìŠ¤ í•˜ì´ë¼ì´íŠ¸ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. ìˆ˜ì§‘í•œ ë¦¬ì†ŒìŠ¤ì—ì„œ íŠ¹íˆ ì¤‘ìš”í•œ ë¶€ë¶„ì„ ê¸°ë¡í•˜ê³ , ë˜í•œ ì´ë ‡ê²Œ í•˜ì´ë¼ì´íŠ¸í•œ ë¶€ë¶„ì„ í†µí•´ì„œ ìë£Œ ê²€ìƒ‰ë„ ê°€ëŠ¥í•˜ë‹¤. ê°ê°ì˜ ìë£Œ íƒ€ì…ì— ëŒ€í•œ í•˜ì´ë¼ì´íŠ¸ ì‚¬ìš© ì˜ˆì‹œëŠ” ì•„ë˜ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ë¶ë§ˆí¬-í•˜ì´ë¼ì´íŠ¸&quot;&gt;ë¶ë§ˆí¬ í•˜ì´ë¼ì´íŠ¸&lt;/h3&gt;

&lt;p&gt;Catty ì›¹ì—ì„œ ìˆ˜ì§‘í•œ ë¶ë§ˆí¬ ìë£Œë¥¼ ë³´ë‹¤ ì½ê¸° í¸í•œ ì½ê¸°ëª¨ë“œë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ ì½ê¸°ëª¨ë“œì—ì„œ ì¤‘ìš”í•œ ë‚´ìš©ì„ ë“œë˜ê·¸ í•˜ë©´ í•˜ì´ë¼ì´íŠ¸ íŒì—…ì´ ëœ¬ë‹¤. ì—¬ê¸°ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Add highlight&lt;/code&gt; ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë¶ë§ˆí¬ í•˜ì´ë¼ì´íŠ¸ê°€ ì¶”ê°€ëœë‹¤.&lt;/p&gt;

&lt;video controls=&quot;&quot; autoplay=&quot;autoplay&quot; loop=&quot;loop&quot; width=&quot;100%&quot;&gt;
  &lt;source src=&quot;/assets/img/post_images/catty_introduce2.mov&quot; type=&quot;video/webm&quot; /&gt;
&lt;/video&gt;
&lt;!-- &lt;div style=&quot;text-align: left&quot;&gt;
  &lt;video width=&quot;100%&quot; controls src=&quot;/assets/img/post_images/catty_introduce2.mov&quot;&gt;&lt;/video&gt;
&lt;/div&gt; --&gt;

&lt;h3 id=&quot;ìœ íŠœë¸Œ-í•˜ì´ë¼ì´íŠ¸&quot;&gt;ìœ íŠœë¸Œ í•˜ì´ë¼ì´íŠ¸&lt;/h3&gt;

&lt;p&gt;Catty ì›¹ì—ì„œ ìˆ˜ì§‘í•œ ë¶ë§ˆí¬ ìë£Œë¥¼ ë³´ë‹¤ ì½ê¸° í¸í•œ ì½ê¸°ëª¨ë“œë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ ì½ê¸°ëª¨ë“œì—ì„œ ì¤‘ìš”í•œ ë‚´ìš©ì„ ë“œë˜ê·¸ í•˜ë©´ í•˜ì´ë¼ì´íŠ¸ íŒì—…ì´ ëœ¬ë‹¤. ì—¬ê¸°ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Add highlight&lt;/code&gt; ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë¶ë§ˆí¬ í•˜ì´ë¼ì´íŠ¸ê°€ ì¶”ê°€ëœë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/catty_introduce5.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;h3 id=&quot;pdf-í•˜ì´ë¼ì´íŠ¸&quot;&gt;PDF í•˜ì´ë¼ì´íŠ¸&lt;/h3&gt;

&lt;p&gt;ì—…ë¡œë“œí•œ PDF íŒŒì¼ì´ë‚˜ ë¶ë§ˆí¬ ì¤‘ urlì´ â€˜.pdfâ€™ë¡œ ëë‚˜ëŠ” ìë£ŒëŠ” PDF ìµœì í™” ë³´ê¸°ê°€ ì œê³µëœë‹¤. ì´ PDF viewì—ì„œ ë¶ë§ˆí¬ ë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì¤‘ìš”í•œ ë‚´ìš©ì„ ë“œë˜ê·¸ í•œ ë’¤ ë©”ëª¨ë¥¼ ì¶”ê°€í•˜ì—¬ í•˜ì´ë¼ì´íŠ¸ë¥¼ ë‚¨ê¸¸ ìˆ˜ ìˆë‹¤.&lt;/p&gt;
&lt;video controls=&quot;&quot; autoplay=&quot;autoplay&quot; loop=&quot;loop&quot; width=&quot;100%&quot;&gt;
  &lt;source src=&quot;/assets/img/post_images/catty_introduce4.mov&quot; type=&quot;video/webm&quot; /&gt;
&lt;/video&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;3-ë…¸íŠ¸-ì‘ì„±&quot;&gt;&lt;strong&gt;(3) ë…¸íŠ¸ ì‘ì„±&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;Â 
ì´ì œ ì´ë ‡ê²Œ ìˆ˜ì§‘í•œ ìë£Œë“¤ì„ ë“€ì–¼ë·°ë¡œ ë™ì‹œì— í™•ì¸í•˜ë©° ë…¸íŠ¸ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤! ì•ì„œ ëª¨ì€ ìë£Œë“¤ ì¤‘ ë…¸íŠ¸ë¥¼ ì“¸ ë•Œ ì°¸ê³ í•˜ê³  ì‹¶ì€ ìë£Œë“¤ì˜ í´ë”ì™€ íƒœê·¸ë¥¼ ì§€ì •í•˜ë©´ ê·¸ ìë£Œë“¤ì„ ì°¸ê³ í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/catty_introduce9.png&quot; width=&quot;70%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
Â 
ì´ì œ ì´ë ‡ê²Œ ë³´ë‹¤ ë¹ ë¥´ê³  ì‰½ê²Œ ë‚˜ë§Œì˜ ë…¸íŠ¸ë¥¼ ì‘ì„±í•  ì¤€ë¹„ê°€ ëª¨ë‘ ëë‚¬ë‹¤!&lt;/p&gt;

&lt;video controls=&quot;&quot; autoplay=&quot;autoplay&quot; loop=&quot;loop&quot; width=&quot;100%&quot;&gt;
  &lt;source src=&quot;/assets/img/post_images/catty_introduce8.mov&quot; type=&quot;video/webm&quot; /&gt;
&lt;/video&gt;

&lt;p&gt;&lt;br /&gt;
Â 
ë§ˆì§€ë§‰ìœ¼ë¡œ Network íƒ­ìœ¼ë¡œ ì´ë™í•˜ë©´, ì´ë ‡ê²Œ ìˆ˜ì§‘í•˜ê³ , ì‘ì„±í•œ ë¦¬ì†ŒìŠ¤ë¥¼ íƒœê·¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì—°ê²°ëœ ê·¸ë˜í”„ ë·°ë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ ê·¸ë˜í”„ ë·°ì—ì„œ ê°ê°ì˜ ë…¸ë“œë¥¼ ëˆ„ë¥´ë©´ í•´ë‹¹ íƒœê·¸ì˜ ìë£Œë“¤ì„ ëª¨ì•„ë³´ê±°ë‚˜ ë…¸íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;
&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/network.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
Â 
p.s. Catty ì„œë¹„ìŠ¤ê°€ ë” ê¶ê¸ˆí•˜ë‹¤ë©´ &lt;a href=&quot;https://www.cattynote.com/&quot;&gt;https://www.cattynote.com/&lt;/a&gt;ì—ì„œ ë¬´ë£Œë¡œ ì‚¬ìš©í•´ë³¼ ìˆ˜ ìˆì–´ìš”. ë†€ëŸ¬ì˜¤ì„¸ìš”!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
Â &lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;ëª©ì—… ì´ë¯¸ì§€ ì¶œì²˜ : &lt;a href=&quot;www.freepik.com&quot;&gt;www.freepik.com&lt;/a&gt;&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="Catty" />
      

      
        <summary type="html">ì‘ë…„ 11ì›”ë¶€í„° í‹ˆí‹ˆíˆ ê³µë¶€ê²¸ ì‚¬ì´ë“œ í”„ë¡œì íŠ¸ ê²¸ Catty ì„œë¹„ìŠ¤ë¥¼ ê°œë°œí•˜ì˜€ë‹¤. ì´ë²ˆ ê¸€ì—ì„œëŠ” Cattyì— ë„£ì€ ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤ì„ ì†Œê°œí•˜ê³  ë‹¤ìŒê¸€ì—ì„œëŠ” íšŒê³  í˜•ì‹ìœ¼ë¡œ ì§€ê¸ˆê» ê°œë°œí•˜ë©´ì„œ ëŠë¼ê³  ìƒê°í•œ ê²ƒë“¤ì„ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">(ì‘ì„±ì¤‘) RecSys &amp;amp; RL - Top-ğ¾ Off-Policy Correction for a REINFORCE Recommender System</title>
      <link href="http://localhost:4000/RecSys-&-RL-Top-%F0%9D%90%BE-Off-Policy-Correction-for-a-REINFORCE-Recommender-System" rel="alternate" type="text/html" title="(ì‘ì„±ì¤‘) RecSys &amp; RL - Top-ğ¾ Off-Policy Correction for a REINFORCE Recommender System" />
      <published>2022-05-20T16:03:00+09:00</published>
      <updated>2022-05-20T16:03:00+09:00</updated>
      <id>http://localhost:4000/RecSys%20&amp;%20RL%20-%20Top-%F0%9D%90%BE%20Off-Policy%20Correction%20for%20a%20REINFORCE%20Recommender%20System</id>
      <content type="html" xml:base="http://localhost:4000/RecSys-&amp;-RL-Top-%F0%9D%90%BE-Off-Policy-Correction-for-a-REINFORCE-Recommender-System">&lt;p&gt;ì´ì „ì— ì½ì—ˆë˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A Deep Reinforcement Learning Framework for News Recommendation&lt;/code&gt; ë…¼ë¬¸ì€ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ ì½”ë“œë¥¼ ì°¾ê¸°ê°€ ì–´ë ¤ì› ë‹¤. ê·¸ë˜ì„œ ì•Œê³ ë¦¬ì¦˜ ì½”ë“œê°€ ê°™ì´ ìˆìœ¼ë©´ì„œ ì ë‹¹íˆ challengingí•œ ë…¼ë¬¸ì„ ë‹¤ì‹œ ì°¾ì•„ë³´ì•˜ê³  ì´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Top-ğ¾ Off-Policy Correction for a REINFORCE Recommender System&lt;/code&gt; ì´ ê°€ì¥ ê´œì°®ì•„ë³´ì—¬ ì½ì–´ë³´ì•˜ë‹¤. ì´í›„ ì—¬ëŸ¬ ìƒ˜í”Œ ì½”ë“œë¥¼ ì°¸ê³ í•˜ì—¬ public datasetìœ¼ë¡œ ì§ì ‘ êµ¬í˜„ê¹Œì§€ í•´ë³¼ ì˜ˆì •ì´ë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;ì£¼ìš”-contribution&quot;&gt;ì£¼ìš” Contribution&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;ì´ ë…¼ë¬¸ì˜ ì£¼ìš”í•œ ê¸°ì—¬ì ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;REINFORCE Recommender&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;Large, non-stationary state and action spaces&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Off-Policy Candidate Generation&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;RLì—ì„œ ì¶”ì²œì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ë°ì´í„°ì˜ ë¶€ì¡±ì´ íŠ¹íˆ ë¬¸ì œê°€ ëœë‹¤. ê³ ì „ì ì¸ RLì—ì„œëŠ” ì´ ë°ì´í„° ë¶€ì¡± ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ ë§ì€ ì–‘ì˜ training dataë¥¼ self-replayë‚˜ simulationì„ í†µí•´ ìˆ˜ì§‘í•˜ì˜€ë‹¤.
  í•˜ì§€ë§Œ ì¶”ì²œì‹œìŠ¤í…œ ë¬¸ì œì˜ ê²½ìš°, ë³µì¡í•˜ê²Œ ì–½í˜€ìˆëŠ” ì¶”ì²œì‹œìŠ¤í…œ í™˜ê²½ ë•Œë¬¸ì— simulationì„ í†µí•˜ì—¬ ë°ì´í„°ë¥¼ ì–»ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ë”°ë¼ì„œ rewardë¥¼ ê´€ì°°í•˜ëŠ” ê²ƒ ìì²´ê°€ ì‹¤ì œ ìœ ì €ì—ê²Œ ì‹¤ì œ ì¶”ì²œì„ ì œê³µí•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— íƒìƒ‰ë˜ì§€ ì•Šì€ ê³µê°„ì˜ state, action spaceì— ëŒ€í•˜ì—¬ rewardê°’ì„ ì‰½ê²Œ ì•Œì•„ë‚´ê¸° ì–´ë µë‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;
  Â &lt;/p&gt;

    &lt;p&gt;ë”°ë¼ì„œ ë³¸ ë…¼ë¬¸ì—ì„œëŠ”, &lt;strong&gt;ë‹¤ë¥¸ ì¶”ì²œì‹œìŠ¤í…œì´ë‚˜ ê³¼ê±°ì˜ policyì—ì„œ ì–»ì€ ìœ ì € feedbackì˜ ë¡œê·¸ë“¤ì„ í™œìš©í•˜ì—¬ Off-policy learningì„ ìˆ˜í–‰&lt;/strong&gt; í•œë‹¤. ì´ ë•Œ, ë‹¤ë¥¸ policyì—ì„œ ìˆ˜ì§‘í•˜ì˜€ê¸° ë•Œë¬¸ì— í•„ì—°ì ìœ¼ë¡œ ë°œìƒí•˜ëŠ” biasë¥¼ í•´ê²°í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í•™ìŠµí•œë‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Top-K Off-Policy Correction&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;ì‹¤ì œ ì¶”ì²œì‹œìŠ¤í…œ í™˜ê²½ì—ì„œëŠ” 1ê°œê°€ ì•„ë‹Œ ì—¬ëŸ¬ê°œì˜ ì¶”ì²œì„ ë™ì‹œì— ì œê³µí•´ì•¼ í•œë‹¤. ë”°ë¼ì„œ ë³¸ ë…¼ë¬¸ì—ì„œëŠ” top-K recommender systemì„ ìœ„í•œ ìƒˆë¡œìš´ top-K off-policy correctionì„ ì •ì˜í•œë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Benefits in Live Experiments&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;ì•„ì´í…œì— ëŒ€í•œ ìœ ì € ì„ í˜¸ë„ëŠ” ê³„ì† ë³€í•¨ -&amp;gt; ìœ ì € state ê°’ì´ ì§€ì†ì ìœ¼ë¡œ ë°”ë€ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;reinforce-recommender&quot;&gt;Reinforce Recommender&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;
&lt;h3 id=&quot;mdp-modeling&quot;&gt;MDP Modeling&lt;/h3&gt;
&lt;p&gt;ì¶”ì²œì‹œìŠ¤í…œì„ ê°•í™”í•™ìŠµ ì„¸íŒ…ì— ì í•©í•˜ê²Œ ë§ì¶°ë³´ì. ê°•í™”í•™ìŠµì„ ìœ„í•˜ì—¬ í™˜ê²½ì„ Markov Decision Process(MDP)ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;$S$ : ìœ ì € stateë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì—°ì†ì ì¸ state space&lt;/li&gt;
  &lt;li&gt;$A$ : ì¶”ì²œ ì•„ì´í…œ í›„ë³´êµ°ì„ í¬í•¨í•˜ê³  ìˆëŠ” discreteí•œ action space&lt;/li&gt;
  &lt;li&gt;$P$ : state transition probability ( $S \times A \times S \to \mathbb{R}$ )&lt;/li&gt;
  &lt;li&gt;$R$ : ë³´ìƒ í•¨ìˆ˜ ( $S \times A \to \mathbb{R}$ ), ì´ ë•Œ, $ r(s, a) $ ëŠ” ìœ ì € state sì—ì„œ action aë¥¼ í•  ë•Œ ë°”ë¡œ ì–»ì–´ì§€ëŠ” rewardë¥¼ ì˜ë¯¸í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;$ \rho_{0} $ : ì´ˆê¸° ìƒíƒœ ë¶„í¬&lt;/li&gt;
  &lt;li&gt;$ \gamma $ future rewardì— ëŒ€í•œ discount factor&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;policy-gradient&quot;&gt;Policy Gradient&lt;/h3&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;model-architecture&quot;&gt;Model Architecture&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;off-policy-correction&quot;&gt;Off-Policy Correction&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;top-k-recommendation&quot;&gt;Top-K Recommendation&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;exploration&quot;&gt;Exploration&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;experiment-results&quot;&gt;Experiment Results&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="RecSys" />
      
        <category term="RL" />
      
        <category term="paper" />
      

      
        <summary type="html">ì´ì „ì— ì½ì—ˆë˜ A Deep Reinforcement Learning Framework for News Recommendation ë…¼ë¬¸ì€ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ ì½”ë“œë¥¼ ì°¾ê¸°ê°€ ì–´ë ¤ì› ë‹¤. ê·¸ë˜ì„œ ì•Œê³ ë¦¬ì¦˜ ì½”ë“œê°€ ê°™ì´ ìˆìœ¼ë©´ì„œ ì ë‹¹íˆ challengingí•œ ë…¼ë¬¸ì„ ë‹¤ì‹œ ì°¾ì•„ë³´ì•˜ê³  ì´ Top-ğ¾ Off-Policy Correction for a REINFORCE Recommender System ì´ ê°€ì¥ ê´œì°®ì•„ë³´ì—¬ ì½ì–´ë³´ì•˜ë‹¤. ì´í›„ ì—¬ëŸ¬ ìƒ˜í”Œ ì½”ë“œë¥¼ ì°¸ê³ í•˜ì—¬ public datasetìœ¼ë¡œ ì§ì ‘ êµ¬í˜„ê¹Œì§€ í•´ë³¼ ì˜ˆì •ì´ë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Transformer</title>
      <link href="http://localhost:4000/Transformer" rel="alternate" type="text/html" title="Transformer" />
      <published>2022-05-16T13:02:00+09:00</published>
      <updated>2022-05-16T13:02:00+09:00</updated>
      <id>http://localhost:4000/Transformer</id>
      <content type="html" xml:base="http://localhost:4000/Transformer">&lt;p&gt;&lt;strong&gt;Transformerì€ recurrenceë‚˜ convolutionì—†ì´ attentionë§Œì„ ì‚¬ìš©í•˜ëŠ” ìƒˆë¡œìš´ sequence transduction model&lt;/strong&gt;ì´ë‹¤. Transformerì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Attention Is All You Need&lt;/code&gt; ë¼ëŠ” ë…¼ë¬¸ì—ì„œ ì²˜ìŒìœ¼ë¡œ ì œì•ˆë˜ì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ Transformerì„ ì²˜ìŒ ì ‘í•˜ê³  ê°œë…ì´ ë³µì¡í•´ì„œ ìœ íŠœë¸Œ ì˜ìƒì´ë‚˜ ë¸”ë¡œê·¸ ê¸€ë“¤ì„ ì°¾ì•„ë³´ë©´ì„œ ì´í•´ë¥¼ í•´ë³´ë ¤ê³  ì‹œë„í–ˆì§€ë§Œ ê²°êµ­ì—ëŠ” ì´ê²Œ ì²˜ìŒ ì œì•ˆëœ ë…¼ë¬¸ì„ ì •ë…í•˜ëŠ” ê²Œ ê°€ì¥ ë„ì›€ì´ ë˜ì—ˆë‹¤. ê·¸ë˜ì„œ ì´ë²ˆ ê¸€ì—ì„œëŠ” Transformerê°€ ì œì•ˆëœ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Attention Is All You Need&lt;/code&gt; ì„ ì •ë¦¬í•´ë³´ê¸°ë¡œ í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;background&quot;&gt;Background&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;ê¸°ì¡´ì˜ seq2seq ëª¨ë¸ì€ ì¸ì½”ë”-ë””ì½”ë” êµ¬ì¡°ë¡œ êµ¬ì„±ë˜ì–´ ìˆì—ˆë‹¤. ì¸ì½”ë”ì—ì„œëŠ” ì…ë ¥ ì‹œí€€ìŠ¤(ex&amp;gt; ë¬¸ì¥)ë¥¼ í•˜ë‚˜ì˜ ë²¡í„° í‘œí˜„ìœ¼ë¡œ ì••ì¶•í•˜ê³ , ë””ì½”ë”ëŠ” ì´ ë²¡í„° í‘œí˜„ì„ í†µí•´ ì¶œë ¥ ì‹œí€€ìŠ¤ë¥¼ ë§Œë“¤ì–´ëƒˆë‹¤. í•˜ì§€ë§Œ ì´ êµ¬ì¡°ì—ì„œëŠ” ì¸ì½”ë”ê°€ ì…ë ¥ ì‹œí€€ìŠ¤ë¥¼ ì••ì¶•í•˜ëŠ” ê³¼ì •ì—ì„œ ì •ë³´ê°€ ì¼ë¶€ ì†ì‹¤ëœë‹¤ëŠ” ë‹¨ì ì´ ì¡´ì¬í–ˆëŠ”ë°, ê·¸ë˜ì„œ ì´ë¥¼ ë³´ì •í•˜ê¸° ìœ„í•˜ì—¬ ì–´í…ì…˜ì´ ì‚¬ìš©ë˜ì—ˆë‹¤. ì´ ë•Œ ì–´í…ì…˜ì€ ì¸ì½”ë” ìª½ì˜ hidden variableê³¼ ë””ì½”ë” ìª½ì˜ hidden variableê°„ì˜ ìœ ì‚¬ì„±ì„ ë¹„êµí•˜ì˜€ë‹¤. ì´ ì–´í…ì…˜ì„ ì´ìš©í•˜ë©´ ì…ë ¥ê³¼ ì¶œë ¥ ì‹œí€€ìŠ¤ì˜ distanceì— ëŒ€í•œ ê³ ë ¤ ì—†ì´ ë‘˜ê°„ì˜ ì˜ì¡´ì„±ì„ ëª¨ë¸ë§í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë³¸ ë…¼ë¬¸ì—ì„œëŠ” ì´ë ‡ê²Œ ì–´í…ì…˜ì„ RNNì˜ ë‹¨ì ì„ ë³´ì •í•˜ëŠ” ì—­í• ë¡œì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ &lt;strong&gt;ì–´í…ì…˜&lt;/strong&gt; ë§Œì„ ì‚¬ìš©í•´ ì¸ì½”ë”-ë””ì½”ë”ë¥¼ ë§Œë“¤ì–´ë³´ëŠ” ê²ƒì„ ì œì•ˆí•œë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;ëª¨ë¸-ì•„í‚¤í…ì³&quot;&gt;ëª¨ë¸ ì•„í‚¤í…ì³&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;
&lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/transformer1.jpeg&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;h3 id=&quot;encoder-and-decoder-stacks&quot;&gt;Encoder and Decoder Stacks&lt;/h3&gt;

&lt;h4 id=&quot;encoder&quot;&gt;Encoder&lt;/h4&gt;

&lt;p&gt;íŠ¸ëœìŠ¤í¬ë¨¸ëŠ” RNN ì—†ì´ ì¸ì½”ë”-ë””ì½”ë”ë¥¼ êµ¬ì„±í•œë‹¤. RNNì´ ìˆëŠ” êµ¬ì¡°ì—ì„œëŠ” ì¸ì½”ë”ì™€ ë””ì½”ë”ì— ê°ê° ì¡´ì¬í•˜ëŠ” RNN í•œ ê°œê°€ tê°œì˜ time stepë¥¼ ê°€ì§€ëŠ” êµ¬ì¡°ì˜€ë‹¤ë©´, íŠ¸ëœìŠ¤í¬ë¨¸ëŠ” ì¸ì½”ë”, ë””ì½”ë” ìì²´ê°€ Nê°œ(ë³¸ ë…¼ë¬¸ì—ì„œëŠ” 6ê°œ)ì”© ì¡´ì¬í•œë‹¤. ê° 6ê°œì˜ layerì€ ë‹¤ì‹œ 2ê°œì˜ sub-layerì„ ê°€ì§„ë‹¤. ì—¬ê¸°ì„œ ì²« ë²ˆì§¸ sub-layerì€ &lt;strong&gt;multi-head self-attention mechanism&lt;/strong&gt;ì´ê³ , ë‘ë²ˆì§¸ sub-layerì€ &lt;strong&gt;position-wise fully connected feed-forward ë„¤íŠ¸ì›Œí¬&lt;/strong&gt; ì´ë‹¤. ë˜í•œ, Encoderì—ì„œ layer nomalizationì„ ìˆ˜í–‰í•œ ì´í›„ì— ê° sub-layersì—ì„œ residual connectionì„ í•´ì¤€ë‹¤.&lt;/p&gt;

&lt;h4 id=&quot;decoder&quot;&gt;Decoder&lt;/h4&gt;
&lt;p&gt;Encoderì™€ ë§ˆì°¬ê°€ì§€ë¡œ 6ê°œì˜ layerì„ stackí•˜ì˜€ê³ , ë™ì¼í•œ 2ê°œì˜ sub-layerì„ ê°€ì§€ë©° ì´ì— ë– í•´ multi head attentionì„ ìˆ˜í–‰í•˜ëŠ” 3ë²ˆì§¸ sub-layerê°€ ì¶”ê°€ëœë‹¤. ë˜í•œ ë§ˆì°¬ê°€ì§€ë¡œ layer nomalization ì´í›„ ê° sub-layerì—ì„œ residual connectionì„ í•´ì¤€ë‹¤.&lt;/p&gt;

&lt;p&gt;ë°˜ë©´ Encoderì™€ëŠ” ë‹¬ë¦¬ self-attentionì„ ìˆ˜í–‰í•˜ëŠ” sub-layerì— ì¡°ê¸ˆ ìˆ˜ì •ì„ ê°€í–ˆëŠ”ë°,&lt;/p&gt;

&lt;h3 id=&quot;attention&quot;&gt;Attention&lt;/h3&gt;

&lt;p&gt;Attention í•¨ìˆ˜ëŠ” queryì™€ key-value pair (key, value) ì˜ ì§‘í•©ì„ outputìœ¼ë¡œ ë§¤í•‘í•œë‹¤. ì¢€ ë” ìì„¸íˆ ë§í•˜ë©´, outputì€ valueë“¤ì˜ weighted sumìœ¼ë¡œ ê³„ì‚°ë˜ëŠ” ë°, ì´ ë•Œ, ê° valueì— ëŒ€ì‘ë˜ëŠ” weight ê°’ì€ queryì™€ ëŒ€ì‘ë˜ëŠ” keyê°„ì˜ compatibility functionìœ¼ë¡œ ê³„ì‚°ëœë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/transformer2.jpeg&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;h4 id=&quot;scaled-dot-product-attention&quot;&gt;Scaled Dot-Product Attention&lt;/h4&gt;

&lt;p&gt;Compatibility í•¨ìˆ˜ë¡œ ëŒ€í‘œì ìœ¼ë¡œ &lt;strong&gt;scaled dot product&lt;/strong&gt; ë¥¼ ì‚¬ìš©í•œë‹¤. Scaled dot productì—ì„œ ê° valueì˜ weightì€ ë‹¤ìŒ ì‹ìœ¼ë¡œ ê³„ì‚°ëœë‹¤.&lt;/p&gt;

\[Attention(Q, K, V) = softmax( \frac{QK^{T}}{\sqrt{d_{k}}} ) V\]

&lt;p&gt;ì´ ë•Œ, ì‹ì„ í™•ì¸í•´ë³´ë©´ $ \frac{1}{\sqrt{d_{k}}} $ ë¥¼ ì¶”ê°€ë¡œ ê³±í•´ì£¼ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ëŠ” $ d_{k} $ ê°€ í° ìˆ˜ ì¼ ë•Œ, dot productê°€ ë„ˆë¬´ í° ê°’ì„ ê°€ì ¸ softmax functionì´ ë§¤ìš° ì‘ì€ gradient ê°’ì„ ê°€ì§€ê²Œ ëœë‹¤. ë”°ë¼ì„œ dot productë¥¼ $ d_{k} $ ë¡œ ë‚˜ëˆ  ì´ë¥¼ ë³´ì •í•´ì¤€ë‹¤.&lt;/p&gt;

&lt;h4 id=&quot;multi-head-attention&quot;&gt;Multi-Head Attention&lt;/h4&gt;
&lt;p&gt;ì–´í…ì…˜ì„ í° dimensionì— ëŒ€í•˜ì—¬ í•œ ë²ˆì— ì ìš©í•˜ë©´ í•™ìŠµ ì†ë„ê°€ ì˜¤ë˜ ê±¸ë¦°ë‹¤. ë”°ë¼ì„œ ë³¸ ë…¼ë¬¸ì—ì„œëŠ” ì–´í…ì…˜ì„ ì‚¬ìš©í•  ë•Œ í•œ ë²ˆì— ì ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì—¬ëŸ¬ê°œë¡œ ë¶„í• í•˜ì—¬ ë³‘ë ¬ë¡œ ìˆ˜í–‰í•œ ë’¤ ì´ë¥¼ ë‹¤ì‹œ í•˜ë‚˜ë¡œ í•©ì¹˜ëŠ” ë°©ë²•ì„ ì œì•ˆí•˜ì˜€ë‹¤. ì¦‰, ì „ì²´ dimensionì„ hë¡œ ë‚˜ëˆ ì„œ ë³‘ë ¬ë¡œ attentionì„ hë²ˆ ì ìš©í•œë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;queryì™€ key, valueë¥¼ ê°ê° $ d_{k}, d_{k}, d_{v} $ ì°¨ì›ì— linear projectioní•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ì´ë ‡ê²Œ projection ëœ ë²„ì „ì˜ query, key, valueë¥¼ ê°€ì§€ê³  Scaled dot product attentionì„ ìˆ˜í–‰í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ì´ ê³¼ì •ì„ hë²ˆ ë°˜ë³µí•œë‹¤.&lt;/li&gt;
  &lt;li&gt;êµ¬í•´ì§„ hê°œì˜ ë²¡í„°ë¥¼ í•©ì¹˜ê³  ë‹¤ì‹œ project í•˜ì—¬ ìµœì¢… ê°’ì„ ì–»ëŠ”ë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;position-wise-feed-forward-networks&quot;&gt;Position-wise Feed-Forward Networks&lt;/h3&gt;
&lt;p&gt;sub layerì— ì ìš©ë˜ëŠ” attentionì— ì¶”ê°€ë¡œ, ì¸ì½”ë”, ë””ì½”ë”ì˜ ê° ë ˆì´ì–´ëŠ” ê° positionì— ë™ì¼í•˜ê²Œ ì ìš©ë˜ëŠ” fully connected feed-forward networkë¥¼ ê°€ì§„ë‹¤. ì´ ë„¤íŠ¸ì›Œí¬ëŠ” ReLu activationì„ ì‚¬ì´ì— ë‘” ë‘ê°œì˜ linear transformationìœ¼ë¡œ êµ¬ì„±ëœë‹¤.&lt;/p&gt;

\[FFN(x) = max(0, xW_{1} + b_{1})W_{2} + b_{2}\]

&lt;h3 id=&quot;embeddings-and-softmax&quot;&gt;Embeddings and Softmax&lt;/h3&gt;
&lt;p&gt;ë‹¤ë¥¸ sequence transduction ëª¨ë¸ê³¼ ìœ ì‚¬í•˜ê²Œ, ì…ë ¥ í† í°ë“¤ì„ ì¶œë ¥ í† í°ë“¤ë¡œ ë³€í™˜í•´ì£¼ëŠ” ë° í•™ìŠµëœ embeddingì„ ì‚¬ìš©í•œë‹¤. ë˜í•œ, ë””ì½”ë” ì¶œë ¥ì„ ë‹¤ìŒ í† í°ì˜ í™•ë¥ ë¡œ ë°”ê¿”ì£¼ëŠ”ë° í•™ìŠµëœ transformationê³¼ softmax í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;positional-encoding&quot;&gt;Positional Encoding&lt;/h3&gt;

&lt;p&gt;íŠ¸ëœìŠ¤í¬ë¨¸ ëª¨ë¸ì—ì„œëŠ” recurrenceë„, convolutionë„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ëª¨ë¸ì´ ì‹œí€€ìŠ¤ì˜ ìˆœì„œ ì •ë³´ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œëŠ” ì‹œí€€ìŠ¤ì— ìˆëŠ” ê° í† í°ì˜ ìƒëŒ€ ìœ„ì¹˜ í˜¹ì€ ì ˆëŒ€ ìœ„ì¹˜ ì •ë³´ë¥¼ ì¶”ê°€ë¡œ ì•Œë ¤ì¤˜ì•¼ í•œë‹¤. ì´ë¥¼ ìœ„í•´ì„œ ì¸ì½”ë”, ë””ì½”ë”ì— ë“¤ì–´ê°€ê¸° ì „ì— ê°ê°ì˜ í•˜ìœ„ ë ˆì´ì–´ì¸ ì„ë² ë”© ë ˆì´ì–´ì— &lt;strong&gt;positional encoding&lt;/strong&gt;ì´ ì¶”ê°€í•˜ì—¬ sequenceì— ìˆœì„œë¥¼ ì¤€ë‹¤.&lt;/p&gt;

&lt;p&gt;positional encodingëŠ” ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ êµ¬í•  ìˆ˜ ìˆëŠ”ë°, ë…¼ë¬¸ì—ì„œëŠ” ë‹¤ì–‘í•œ ì£¼íŒŒìˆ˜ì˜ ì‚¬ì¸, ì½”ì‚¬ì¸ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ ê°’ì„ ê³„ì‚°í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ì²˜ëŸ¼ positional encodingì„ ì‚¬ìš©í•˜ë©´ ì‹œí€€ìŠ¤ì˜ ìˆœì„œ ì •ë³´ë¥¼ ë³´ì¡´í•  ìˆ˜ ìˆê²Œ ëœë‹¤. ì´í›„ ì¸ì½”ë”ì™€ ë””ì½”ë”ì—ì„œëŠ” ê°™ì€ ë‹¨ì–´ë¥¼ ì…ë ¥ ë°›ì•„ë„ ìˆœì„œ ì •ë³´ì— ë”°ë¼ ë‹¤ë¥¸ ë²¡í„° ê°’ì„ ì²˜ë¦¬í•˜ê²Œ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;training&quot;&gt;Training&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;h3 id=&quot;training-data-and-batching&quot;&gt;Training Data and Batching&lt;/h3&gt;
&lt;p&gt;í•™ìŠµì—ëŠ” 4.5ë°±ë§Œê°œì˜ setence pairë¡œ êµ¬ì„±ëœ standard WMT 2014 English-German datasetì„ ì‚¬ìš©í•˜ì˜€ë‹¤ ë˜í•œ, English-French í•™ìŠµì—ëŠ” ë³´ë‹¤ í° (36M) WMT 2014 English-Frensh datasetì„ ì‚¬ìš©í•˜ì˜€ë‹¤. sentence pairì€ ê¸¸ì´ì— ë”°ë¼ batchë¡œ ë¬¶ì—ˆê³ , ê° batchëŠ” ì•½ 25000ê°œì˜ source tokenê³¼ ì•½ 25000ê°œì˜ target tokenìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;optimizer&quot;&gt;Optimizer&lt;/h3&gt;
&lt;p&gt;Adam optimizerì„ ì‚¬ìš©í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;regularization&quot;&gt;Regularization&lt;/h3&gt;
&lt;p&gt;ì •ê·œí™” ë°©ì‹ìœ¼ë¡œ Residual dropoutì„ ì‚¬ìš©í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;result&quot;&gt;Result&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Base Modelë§Œìœ¼ë¡œë„ ì¶©ë¶„íˆ ìµœê³  ì„±ëŠ¥ì„ ë³´ì˜€ìœ¼ë©°,&lt;/li&gt;
  &lt;li&gt;íŠ¹íˆ Big Modelì˜ ê²½ìš° state-of-the-artë¥¼ ìƒë‹¹í•œ ìˆ˜ì¤€ìœ¼ë¡œ ê°±ì‹ í•˜ëŠ” ì„±ëŠ¥ì„ ë³´ì—¬ì£¼ì—ˆë‹¤.
    &lt;ul&gt;
      &lt;li&gt;WMT 2014 English to German ë²ˆì—­ ê³¼ì œì—ì„œ big transformer ëª¨ë¸ì´ ì•™ìƒë¸” ëª¨ë¸ì„ í¬í•¨í•œ ê¸°ì¡´ ëª¨ë¸ ë³´ë‹¤ 2.0 BLEU ì´ìƒìœ¼ë¡œ ë” ì¢‹ì€ ì„±ëŠ¥ì„ ë‚´ì—ˆë‹¤.&lt;/li&gt;
      &lt;li&gt;WMT 2014 English to French ë²ˆì—­ ê³¼ì œì—ì„œ big transformer ëª¨ë¸ì´ ì´ì „ì˜ ë‹¤ë¥¸ single modelë³´ë‹¤ training ë¹„ìš©ì€ 1/4ë¡œ ì¤„ì—ˆìŒì—ë„ BLEUëŠ” ë” ì¢‹ì•˜ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;ë§ì´ ì–¸ê¸‰í•˜ì˜€ë“¯ì´, TransformerëŠ” recurrenceì™€ convolutionì„ ëª¨ë‘ ì œê±°í•œ, ì˜¤ì§ attentionì—ë§Œ ì˜ì¡´í•˜ëŠ” ìƒˆë¡œìš´ ì¢…ë¥˜ì˜ ëª¨ë¸ì´ë‹¤. ì´ ëª¨ë¸ì€ ê³„ì‚°ëŸ‰ì„ ì¤„ì´ê³  ë³‘ë ¬í™”ë¥¼ ì ìš©í•´ í•™ìŠµ ì†ë„ê°€ í›¨ì”¬ ë¹ ë¥¼ ë¿ë§Œ ì•„ë‹ˆë¼ ê·¸ ì„±ëŠ¥ ë˜í•œ state-of-the-artë¥¼ ë‹¬ì„±í•˜ëŠ” ìˆ˜ì¤€ì— ì´ë¥´ë €ë‹¤. ë˜í•œ ì´ëŸ¬í•œ attentionì— ê¸°ë°˜í•œ ëª¨ë¸ì€ ë‹¤ë¥¸ taskë“¤ì— ì ìš©í•  ìˆ˜ë„ ìˆë‹¤. ë¹„ë‹¨ í…ìŠ¤íŠ¸ë¿ë§Œ ì•„ë‹ˆë¼ ì´ë¯¸ì§€, ì˜¤ë””ì˜¤ë‚˜ ë¹„ë””ì˜¤ ë“±ì˜ ìƒëŒ€ì ìœ¼ë¡œ í° ì…ë ¥-ì¶œë ¥ì„ ìš”í•˜ëŠ” taskë“¤ì— íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
Â &lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;ì°¸ê³  ë‚´ìš© ì¶œì²˜ :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;https://greeksharifa.github.io/nlp(natural%20language%20processing)%20/%20rnns/2019/08/17/Attention-Is-All-You-Need/&lt;/li&gt;
&lt;/ul&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="AI" />
      

      
        <summary type="html">Transformerì€ recurrenceë‚˜ convolutionì—†ì´ attentionë§Œì„ ì‚¬ìš©í•˜ëŠ” ìƒˆë¡œìš´ sequence transduction modelì´ë‹¤. Transformerì€ Attention Is All You Need ë¼ëŠ” ë…¼ë¬¸ì—ì„œ ì²˜ìŒìœ¼ë¡œ ì œì•ˆë˜ì—ˆë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Deep Q-Network(DQN) êµ¬í˜„</title>
      <link href="http://localhost:4000/Implement-DQN" rel="alternate" type="text/html" title="Deep Q-Network(DQN) êµ¬í˜„" />
      <published>2022-05-16T13:02:00+09:00</published>
      <updated>2022-05-16T13:02:00+09:00</updated>
      <id>http://localhost:4000/Implement%20DQN</id>
      <content type="html" xml:base="http://localhost:4000/Implement-DQN">&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;dqn-ì´ë€&quot;&gt;DQN ì´ë€?&lt;/h2&gt;
&lt;p&gt;Â 
ì´ì „ì— &lt;a href=&quot;&quot;&gt;(Reinforcement learning) Value Function Approximation í¬ìŠ¤íŒ…&lt;/a&gt;ì—ì„œ Value function approximationì— ëŒ€í•˜ì—¬ ë‹¤ë£¨ì—ˆë‹¤. ìš”ì•½í•˜ë©´ ê°•í™”í•™ìŠµì—ì„œ ê°„ë‹¨í•œ table í˜•íƒœë¡œ í•™ìŠµì„ í•˜ê²Œ ë˜ë©´ í•™ìŠµì´ ê·¹ë„ë¡œ ëŠë ¤ì§€ëŠ” ë¬¸ì œê°€ ìˆì–´ value functionì„ ë‹¤ì–‘í•˜ê²Œ ê·¼ì‚¬í•˜ì—¬ í™œìš©í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ëŸ¬í•œ approximatorë¡œ Neural Networkë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤. ì´ë²ˆ ê¸€ì—ì„œ ì†Œê°œí•  Deep Q-Networks(DQN)ì€ Q-learning ì•Œê³ ë¦¬ì¦˜ì˜ Q(Action-value) í•¨ìˆ˜ë¥¼ ë”¥ëŸ¬ë‹ìœ¼ë¡œ ê·¼ì‚¬í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ, DeepMindì—ì„œ ë°œí‘œí•œ &lt;a href=&quot;https://arxiv.org/pdf/1312.5602.pdf&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Playing Atari with Deep Reinforcement&lt;/code&gt;&lt;/a&gt; ë¼ëŠ” ì—°êµ¬ì—ì„œ ì œì•ˆë˜ì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ DQN ë…¼ë¬¸ì—ì„œëŠ” raw pixelì„ inputìœ¼ë¡œ ë°›ì•„, value function(â‰ˆfuture rewards)ë¥¼ outputìœ¼ë¡œ ë°˜í™˜í•˜ëŠ” Q-Learningì˜ parameterë¥¼ í•™ìŠµí•˜ëŠ” Convolutional Neural Network(CNN)ì„ ì‚¬ìš©í•˜ì˜€ë‹¤. ì¦‰, ê³ ì°¨ì›ì˜ sensory inputì„ í†µí•´ control policiesë¥¼ ë‹¤ì´ë ‰íŠ¸ë¡œ í•™ìŠµí•˜ëŠ” Deep learning modelì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ ì´ì „ì—ëŠ” ì™œ ê°•í™”í•™ìŠµì— ë”¥ëŸ¬ë‹ì„ í™œìš©í•˜ì§€ ëª»í–ˆì„ê¹Œ? ì‚¬ì‹¤ ë”¥ëŸ¬ë‹ê³¼ ê°•í™”í•™ìŠµì´ ê³ ì°¨ì›ì˜ ë°ì´í„°ë¥¼ í™œìš©í•˜ëŠ” ë°©ë²•ì€ ë¬´ì²™ ë‹¤ë¥´ë‹¤. ëª‡ê°€ì§€ ì˜ˆì‹œë¡œ&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Deep-Learning ê¸°ë°˜ ë°©ë²•ë“¤ì€ hand-labelled training datasetì„ í•„ìš”ë¡œ í•˜ì§€ë§Œ, Reinforcement Learningì—ì„œëŠ” ì˜¤ë¡œì§€ delayì™€ ë…¸ì´ì¦ˆê°€ í¬í•¨ëœ ìŠ¤ì¹¼ë¼ê°’ì¸ Rewardë§Œì„ í†µí•´ì„œ í•™ìŠµëœë‹¤. ë”ìš±ì´ë‚˜ ê·¸ reward ì¡°ì°¨ sparse, noisy, and delayí•œ ì„±ê²©ì„ ê°€ì§„ë‹¤.&lt;/li&gt;
  &lt;li&gt;Deep Learningì—ì„œëŠ” data sampleì´ i.i.dí•˜ë‹¤ëŠ” ê°€ì •ì´ ìˆë‹¤. í•˜ì§€ë§Œ, Reinforcement Learningì˜ ê²½ìš° í˜„ì¬ì˜ stateê°€ ì–´ë””ì¸ ì§€ì— ë”°ë¼ ê°€ëŠ¥í•œ ë‹¤ìŒ stateê°€ ê²°ì •ëœë‹¤. ì¦‰, ë…ë¦½ì ì´ì§€ ì•Šê³  ì¢…ì†ì ì´ë©°, stateê°„ì˜ correlation(ìƒê´€ê´€ê³„)ë˜í•œ í¬ë‹¤.&lt;/li&gt;
  &lt;li&gt;ì—ì´ì „íŠ¸ê°€ í•™ìŠµí•¨ì— ë”°ë¼ policyê°€ ë‹¬ë¼ì§€ë©´ì„œ, í•™ìŠµ ë°ì´í„°ì˜ ë¶„ì‚°(distribution) ìì²´ë„ ì‹œê°„ì— ë”°ë¼ ë³€í•œë‹¤. ë°˜ë©´ ë”¥ëŸ¬ë‹ì€ ê³ ì •ëœ ê¸°ë³¸ ë¶„ì‚°(fixed underlying distribution)ì„ ê°€ì •í•œë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì´ëŸ¬í•œ ê°•í™”í•™ìŠµì— ì´ìœ ë¡œ ë”¥ëŸ¬ë‹ ê¸°ë²•ì„ ì´ì „ì—ëŠ” ë°”ë¡œ ì ìš©í•˜ì§€ ëª»í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Playing Atari with Deep Reinforcement&lt;/code&gt; ë…¼ë¬¸ë„ ì˜ˆì™¸ì—†ì´ ì´ëŸ¬í•œ ë¬¸ì œì— ì§ë©´í–ˆëŠ”ë°, ë…¼ë¬¸ì—ì„œëŠ” ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•˜ì—¬ &lt;strong&gt;Experience replay&lt;/strong&gt; ì™€ &lt;strong&gt;Target network&lt;/strong&gt; ë¼ëŠ” ë°©ë²•ì„ ì œì•ˆí•˜ì˜€ë‹¤. ì´ ë‘ íŠ¹ì§•ì ì¸ ë°©ë²•ì„ í†µí•˜ì—¬ ì„±ê³µì ìœ¼ë¡œ ë”¥ëŸ¬ë‹ì„ ê°•í™”í•™ìŠµì— ì ìš©í•˜ì—¬ ê³ ì°¨ì› ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;experience-replay&quot;&gt;Experience replay&lt;/h3&gt;
&lt;p&gt;ë“¤ì–´ì˜¤ëŠ” ì…ë ¥ì„ ìˆœì„œëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ë°ì´í„° ê°„ì˜ ì—°ê´€ì„±ì´ ë„ˆë¬´ ì»¤ì§€ê²Œ ëœë‹¤. ë”°ë¼ì„œ ìµœê·¼ nê°œì˜ ë°ì´í„°ë¥¼ ê³„ì†í•´ì„œ ì €ì¥í•˜ê³ , ë„¤íŠ¸ì›Œí¬ë¥¼ í•™ìŠµí•  ë•ŒëŠ” ì €ì¥í•œ ë°ì´í„° ì¤‘ ëª‡ê°œë¥¼ ë¬´ì‘ìœ„ë¡œ ìƒ˜í”Œí•˜ì—¬ ì‚¬ìš©í•œë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;target-network&quot;&gt;Target network&lt;/h3&gt;
&lt;p&gt;Target network ì„¤ëª…ì€ &lt;a href=&quot;https://jsideas.net/dqn/&quot;&gt;https://jsideas.net/dqn/&lt;/a&gt;ì˜ ë‹¹ë‚˜ê·€ ì˜ˆì‹œê°€ ì´í•´í•˜ê¸° ì¢‹ì•˜ë‹¤. ì´ ë¸”ë¡œê·¸ì˜ ì„¤ëª…ì„ ì°¨ìš©í•˜ë©´&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ì¼ë°˜ì ì¸ Q Learningì€ ë‹¹ë‚˜ê·€ ë’¤ì— ì˜¬ë¼íƒ€ ë‚šì‹œëŒ€ë¡œ ë‹¹ê·¼ì„ ë“œë¦¬ìš°ê³  ë‹¹ë‚˜ê·€ê°€ ê³§ê²Œ ê±·ê¸°ë¥¼ ë°”ë¼ëŠ” ê²ƒê³¼ ê°™ë‹¤. ë‹¹ê·¼ì„ ë“  ì†ì„ ê³§ê²Œë§Œ ìœ ì§€í•˜ë©´ ë‹¹ë‚˜ê·€ê°€ ì§ì§„í•  ê²ƒì´ë¼ê³  ìƒê°í•˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ì˜ ì•ˆëœë‹¤. ë‹¹ë‚˜ê·€ì™€ ì‚¬ëŒ, ê·¸ë¦¬ê³  ë‚šì‹œëŒ€ì™€ ë‹¹ê·¼ì´ ëª¨ë‘ ì—°ê²°ë˜ì–´ ìˆê¸°ì—, ë‹¹ë‚˜ê·€ê°€ ì›€ì§ì´ë©´ ì˜¬ë¼íƒ„ ì‚¬ëŒë„ í”ë“¤ë¦¬ê³  ê·¸ì— ë”°ë¼ ë‹¹ê·¼ë„ í”ë“¤ë¦°ë‹¤. ê²°êµ­ ì˜ìƒì—ì„œì²˜ëŸ¼ ë‹¹ë‚˜ê·€ëŠ” ì§ì„ ìœ¼ë¡œ ì´ë™í•˜ëŠ”ë° ì‹¤íŒ¨í•œë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;ë‹¹ê·¼ì˜ ìœ„ì¹˜ë¥¼ Q í•¨ìˆ˜ì˜ íƒ€ê²Ÿ $(r+max_{aâ€™}Q(s^{â€˜}, a^{â€˜}))$ ìœ¼ë¡œ, ë‹¹ë‚˜ê·€ì˜ ì›€ì§ì„ì„ ì¶”ì •ì¹˜(Q)ë¡œ ëŒ€ì…í•´ë³´ë©´ ëœë‹¤. íƒ€ê²Ÿê³¼ ì¶”ì •ì¹˜ì˜ ì˜¤ì°¨ë¥¼ ì¤„ì—¬ì•¼í•˜ëŠ”ë°, Qì˜ ë³€í™”ì— ë”°ë¼ íƒ€ê²Ÿê³¼ ì¶”ì •ì¹˜ê°€ ëª¨ë‘ í•¨ê»˜ ë³€í™”í•˜ë©´ ì•ˆì •ì ì¸ í•™ìŠµ(ì´ë™)ì´ ì–´ë ¤ì›Œì§„ë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;DQNì—ì„œëŠ” ë‹¹ë‚˜ê·€ì™€ ë‹¹ê·¼ì„ ë¶„ë¦¬ì‹œí‚¤ëŠ” Fixed Q Targets ë°©ë²•ì„ ì‚¬ìš©í•´ì„œ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤. Qí•¨ìˆ˜ë¥¼ ì¶”ì •í•˜ëŠ” ë„¤íŠ¸ì›Œí¬(local network)ì™€ Targetì„ ì„¤ì •í•˜ëŠ”ë° ì‚¬ìš©í•˜ëŠ” ë„¤íŠ¸ì›Œí¬(target network)ë¡œ ì¶”ì •ê³¼ í‰ê°€ë¥¼ ë¶„ë¦¬í•œë‹¤. ë‹¹ë‚˜ê·€ ë“±ì—ì„œ ë‚´ë ¤ì„œ ë‚šì‹œëŒ€ë¥¼ ë“œë¦¬ìš°ë©´, ë‹¹ê·¼ì˜ ìœ„ì¹˜ëŠ” ë”ì´ìƒ ë‹¹ë‚˜ê·€ì˜ ì›€ì§ì„ì— ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ”ë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;ê·¸ë¦¬ê³  target networkì˜ ì—…ë°ì´íŠ¸ ì£¼ê¸°ë¥¼ local networkë³´ë‹¤ ë” ëŠë¦¬ê²Œ ë§Œë“¦ìœ¼ë¡œì¨ ëª©í‘œê°€ ìì£¼ íœ˜ì²­ì´ì§€ ì•Šë„ë¡ í•œë‹¤. DQN êµ¬í˜„ì—ì„œëŠ” local networkê°€ 4ë²ˆ ì—…ë°ì´íŠ¸ë  ë•Œ í•œë²ˆì”© target networkì˜ íŒŒë¼ë¯¸í„°ë¥¼ local networkì˜ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•´ soft updateí•œë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;dqn-êµ¬í˜„&quot;&gt;DQN êµ¬í˜„&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;h3 id=&quot;environment&quot;&gt;Environment&lt;/h3&gt;
&lt;p&gt;ë¨¼ì €, ì´ë²ˆ DQN êµ¬í˜„ì€ ì œê³µë°›ì€ 2ê°œì˜ GridWorld í™˜ê²½ì„ ê¸°ë°˜ìœ¼ë¡œ ì§„í–‰í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;p&gt;ë¨¼ì € ì²«ë²ˆì§¸ GridWorldëŠ” ê·¸ë¦¼ê³¼ ê°™ë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/dqn4.png&quot; width=&quot;50%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;ê·¸ë¦¼ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´ ì´ í™˜ê²½ì€ ë…¸ë€ ë™ê·¸ë¼ë¯¸, ë¹¨ê°„ ë„¤ëª¨, ë…¹ìƒ‰ ë„¤ëª¨ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤. ê°ê°ì„ ì‚´í´ë³´ë©´,&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ë…¸ë€ ë™ê·¸ë¼ë¯¸ : agentì˜ ì›€ì§ì„ì„ ë‚˜íƒ€ë‚¸ë‹¤.&lt;/li&gt;
  &lt;li&gt;ë¹¨ê°„ ë„¤ëª¨ : í­íƒ„ì´ ìœ„ì¹˜í•´ ìˆìœ¼ë©° agentê°€ í•´ë‹¹ ìœ„ì¹˜ë¡œ ê°€ë©´ reward -10ì„ ì–»ê³  ë‹¤ì‹œ episodeë¥¼ ì‹œì‘í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ì´ˆë¡ ë„¤ëª¨ : ë³´ë¬¼ì´ ìœ„ì¹˜í•´ ìˆìœ¼ë©° agentê°€ í•´ë‹¹ ìœ„ì¹˜ë¡œ ê°€ë©´ reward 20ì„ ì–»ê³  ë‹¤ì‹œ episodeë¥¼ ì‹œì‘í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ë¹¨ê°„ ë„¤ëª¨, ì´ˆë¡ ë„¤ëª¨ê°€ ì—†ëŠ” ê³µê°„ì„ ë…¸ë€ ë™ê·¸ë¼ë¯¸ê°€ íƒìƒ‰í•  ë•Œë§ˆë‹¤ reward -0.1ì„ ì–»ëŠ”ë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ë‘ë²ˆì§¸ GridWorldëŠ” ì²«ë²ˆì§¸ GridWorldì— ì£¼í™© ë„¤ëª¨ê°€ ì¶”ê°€ë˜ì—ˆë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/dqn5.png&quot; width=&quot;45%&quot; /&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;ì£¼í™© ë„¤ëª¨ : ìŒì‹ ìœ„ì¹˜í•´ ìˆìœ¼ë©° agentê°€ í•´ë‹¹ ìœ„ì¹˜ë¡œ ê°€ë©´ reward 10ì„ ì–»ê³  ë‹¤ì‹œ episodeë¥¼ ì‹œì‘í•œë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;dqn-class-êµ¬í˜„&quot;&gt;DQN class êµ¬í˜„&lt;/h3&gt;

&lt;p&gt;ì´ëŸ¬í•œ í™˜ê²½ì—ì„œ ì˜ ë™ì‘í•  ìˆ˜ ìˆëŠ” DQNì„ êµ¬í˜„í•´ë³´ì.
DQN êµ¬í˜„ì€ &lt;strong&gt;neural network ìƒì„±&lt;/strong&gt;, &lt;strong&gt;action ì„ íƒ&lt;/strong&gt;, &lt;strong&gt;experience replayë¥¼ ìœ„í•˜ì—¬ ì´ì „ experienceë¥¼ ë©”ëª¨ë¦¬ì— ì €ì¥&lt;/strong&gt;, &lt;strong&gt;ë©”ëª¨ë¦¬ì— í¬í•¨ëœ experienceë¥¼ ì´ìš©í•˜ì—¬ í•™ìŠµ&lt;/strong&gt;ì˜ ê³¼ì •ìœ¼ë¡œ ë‚˜ëˆ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;neural network ìƒì„±&lt;/strong&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_construct_network()&lt;/code&gt; í•¨ìˆ˜)&lt;/p&gt;

    &lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/dqn3.jpeg&quot; width=&quot;80%&quot; /&gt;
  &lt;/div&gt;

    &lt;p&gt;ì´ DQN ëª¨ë¸ì—ì„œ êµ¬í˜„í•œ neural networkëŠ” ìœ„ ë‹¤ì´ì–´ê·¸ë¨ê³¼ ë¹„ìŠ·í•˜ë‹¤. ë¨¼ì € input layerì—ì„œ n_features sizeì˜ ì…ë ¥ì„ ë°›ê³  24 í¬ê¸°ë¡œ ì¶œë ¥ì„ í•œë‹¤. ì´ ë•Œ, activation í•¨ìˆ˜ë¡œ relu í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤. ë˜í•œ Hidden layerì—ì„œëŠ” ì´ì „ ë ˆì´ì–´ì˜ ì¶œë ¥ì„ ì¸í’‹ìœ¼ë¡œ ë°›ì•„ 24 í¬ê¸°ë¡œ ì¶œë ¥ì„ í•œë‹¤. ì´ ë•Œë„ ë§ˆì°¬ê°€ì§€ë¡œ activation í•¨ìˆ˜ë¡œ reluë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤. ë§ˆì§€ë§‰ output layerì—ì„œëŠ” n_actions í¬ê¸°ë¡œ ì¶œë ¥ì„ í•˜ê³  ì´ ë•Œ, activation í•¨ìˆ˜ë¥¼ linearë¡œ ì„¤ì •í•˜ì˜€ë‹¤. ì´ë ‡ê²Œ êµ¬í˜„í•œ ëª¨ë¸ì˜ ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;relu&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;relu&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;linear&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;mse&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;ì´ ëª¨ë¸ì— n_features í¬ê¸°ì˜ state ë²¡í„°ê°€ ë“¤ì–´ì˜¤ë©´ ëª¨ë¸ì˜ predictionìœ¼ë¡œ ì–»ì€ ì˜ˆì¸¡ëœ reward ê°’ê³¼ true reward ê°’ì˜ ì—ëŸ¬ê°€ ì‘ì•„ì§€ë„ë¡ ë‚´ë¶€ weight ê°’ì„ ì¡°ì •í•œë‹¤. ì´ë¥¼ ê³„ì† ë°˜ë³µí•˜ë‹¤ë³´ë©´ ì˜ˆì¸¡ëœ rewardê°€ true rewardì™€ ê°™ì•„ì§€ëŠ” ë°©í–¥ìœ¼ë¡œ (ìµœì  policyë¥¼ ì°¾ëŠ” ë°©í–¥ìœ¼ë¡œ) í•™ìŠµë˜ê²Œ ëœë‹¤.&lt;/p&gt;

    &lt;p&gt;ì¢€ ë” êµ¬ì²´ì ìœ¼ë¡œ í•™ìŠµ ê³¼ì •ì„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;model.fit()&lt;/code&gt;ê³¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;model.predict()&lt;/code&gt; í•¨ìˆ˜ë¡œ ë‹¤ì‹œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤. ê°ê°ì„ ì‚´í´ë³´ë©´,&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;model.fit(state, true_reward, epochs=1, verbose)&lt;/code&gt;
        &lt;ul&gt;
          &lt;li&gt;ì£¼ì–´ì§„ stateì—ì„œ true rewardë¥¼ ì˜ˆì¸¡í•˜ë„ë¡ í•™ìŠµí•œë‹¤.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;model.predict(state)&lt;/code&gt;
        &lt;ul&gt;
          &lt;li&gt;unseen inputì— ëŒ€í•˜ì—¬ rewardë¥¼ ì˜ˆì¸¡í•œë‹¤.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;ì´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;model.fit()&lt;/code&gt;ê³¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;model.predict()&lt;/code&gt;ë¥¼ í•™ìŠµ ê³¼ì •ì—ì„œ í™œìš©í•˜ë©° ìµœì  policyë¥¼ ì°¾ì•„ë‚˜ê°”ë‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;action ì„ íƒ&lt;/strong&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;choose_action()&lt;/code&gt; í•¨ìˆ˜)
    &lt;ul&gt;
      &lt;li&gt;e_greedy í™•ë¥ ë¡œëŠ” random í•˜ê²Œ actionì„ ì„ íƒí•˜ê³ , 1 - (e-greedy) í™•ë¥ ë¡œëŠ” ëª¨ë¸ì—ì„œ ì˜ˆì¸¡í•œ rewardê°€ ê°€ì¥ í° actionì„ ì„ íƒí•œë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;experienceë¥¼ ë©”ëª¨ë¦¬ì— ì €ì¥&lt;/strong&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_transition()&lt;/code&gt; í•¨ìˆ˜)
    &lt;ul&gt;
      &lt;li&gt;experience replay ë°©ì‹ìœ¼ë¡œ experienceë¥¼ ì¬í™œìš© ìœ„í•˜ì—¬ í•™ìŠµì„ ë©”ëª¨ë¦¬ì— ì €ì¥í•´ë‘”ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ë©”ëª¨ë¦¬ì˜ experienceë¥¼ ì´ìš©í•˜ì—¬ í•™ìŠµ&lt;/strong&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;learn()&lt;/code&gt; í•¨ìˆ˜)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì´ ê³¼ì •ì„ í†µí•©í•˜ì—¬ êµ¬í˜„ëœ ì „ì²´ DQN Class ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;collections&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deque&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.optimizers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;EPISODES&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DeepQLearning&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
           &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;discount_factor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;e_greedy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;replace_target_iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;memory_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;discount_factor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;discount_factor&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deque&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memory_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_greedy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e_greedy&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace_target_iter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;replace_target_iter&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_construct_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_construct_network&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

       &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;relu&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;relu&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;linear&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;mse&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;store_transition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;choose_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# e_greedy í™•ë¥ ë¡œëŠ” random í•˜ê²Œ actionì„ ì„ íƒí•˜ê³ , 1 - (e-greedy) í™•ë¥ ë¡œëŠ” ëª¨ë¸ì—ì„œ ì˜ˆì¸¡í•œ rewardê°€ ê°€ì¥ í° actionì„ ì„ íƒí•œë‹¤.
&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

       &lt;span class=&quot;c1&quot;&gt;# e_greedy í™•ë¥ ë¡œ random í•˜ê²Œ actionì„ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_greedy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randrange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

       &lt;span class=&quot;c1&quot;&gt;#  1 - (e-greedy) í™•ë¥ ë¡œ ëª¨ë¸ì„ í†µí•´ ì˜ˆì¸¡í•œ rewardê°€ ê°€ì¥ í° actionì„ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;act_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;act_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# returns action
&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# ë©”ëª¨ë¦¬ì— ì €ì¥ëœ experienceì—ì„œ batch_sizeë§Œí¼ ëœë¤í•˜ê²Œ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;minibatch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# ì„ íƒëœ ê°ê°ì˜ experienceì— ëŒ€í•˜ì—¬ ëª¨ë¸ì´ ì‹¤ì œ experienceë¡œ ì–»ì€ reward ë°©í–¥ìœ¼ë¡œ ê°’ì„ ì˜ ì˜ˆì¸¡í•˜ë„ë¡ í•™ìŠµì„ ì§„í–‰
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;minibatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;
           &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
               &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;discount_factor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;target_f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;target_f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;
           &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;dqn-class-ì‹¤í–‰&quot;&gt;DQN Class ì‹¤í–‰&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;ì´ì œ ì´ë ‡ê²Œ êµ¬í˜„í•œ DQN Classë¥¼ í™œìš©í•˜ì—¬ í•™ìŠµì„ ì§„í–‰í•´ë³´ì•˜ë‹¤.
ì´ 300ê°œì˜ episodeì— ëŒ€í•˜ì—¬ DQNì„ í•™ìŠµì‹œí‚¤ê³  average episode returnì„ ê·¸ë ¤ë³´ì•˜ë‹¤.
ì´ ë•Œ, return ê°’ì´ ìƒˆë¡­ê²Œ í•™ìŠµì„ ëŒë¦´ ë•Œ ë§ˆë‹¤ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì— 300ê°œì˜ episodeë¡œ í•™ìŠµí•˜ëŠ” ê³¼ì • ì „ì²´ë¥¼ 5ë²ˆ ë°˜ë³µí•´ì„œ episode rewardì˜ min-max, meanë¥¼ ë‚˜ëˆ„ì–´ plotí•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Robot_Gridworld&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;env2&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Robot_Gridworld&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Robot_Gridworld2&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;deep_q_learning&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DeepQLearning&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;collections&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deque&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;return_value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.99&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;episode_return_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;global&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_value&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;reward_per_episode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;returns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deque&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;episode&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

       &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;step_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

       &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;return_value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dqn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choose_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;terminal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;return_value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_value&lt;/span&gt;

           &lt;span class=&quot;n&quot;&gt;step_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;dqn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store_transition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;terminal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

           &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
               &lt;span class=&quot;n&quot;&gt;dqn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;

           &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;terminal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
               &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot; {} End. Total steps : {}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;episode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
               &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;

           &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

       &lt;span class=&quot;n&quot;&gt;returns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;return_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;reward_per_episode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;returns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;episode_return_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reward_per_episode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;Game over.&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destroy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Robot_Gridworld&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

       &lt;span class=&quot;n&quot;&gt;dqn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DeepQLearning&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;discount_factor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;e_greedy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;replace_target_iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;memory_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;
                           &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


       &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;after&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#Basic module in tkinter
&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mainloop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#Basic module in tkinter
&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;mean_return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;episode_return_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;min_return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;episode_return_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;max_return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;episode_return_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í•™ìŠµ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ì²«ë²ˆì§¸ Gridworld (ì£¼í™© ë„¤ëª¨ X)
    &lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/dqn1.png&quot; width=&quot;100%&quot; /&gt;
  &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;ë‘ë²ˆì§¸ Gridworld (ì£¼í™© ë„¤ëª¨ O)
    &lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/dqn2.png&quot; width=&quot;100%&quot; /&gt;
  &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ê·¸ë˜í”„ë¥¼ ë¹„êµí•´ë³´ë©´ ë‘ë²ˆì§¸ Gridworldë¡œ ëŒë ¸ì„ ë•Œ, ë³´ë‹¤ ë¹¨ë¦¬, ì ì€ ë¶„ì‚°ìœ¼ë¡œ ìµœì  policyë¥¼ ì°¾ì•„ê°€ëŠ” ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. í•˜ì§€ë§Œ ë‘ë²ˆì§¸ GridworldëŠ” ë¦¬ì›Œë“œ 10ì„ ì£¼ëŠ” sub optimalí•œ ê²½ìš°ê°€ ì¶”ê°€ ë˜ì—ˆê¸° ë•Œë¬¸ì— ìì¹«í•˜ë©´ ë¦¬ì›Œë“œ 20ì„ ì£¼ëŠ” ë³´ë¬¼ì„ ì°¾ì•„ê°€ëŠ” ëŒ€ì‹ ì— 10ì„ ì£¼ëŠ” sub optimalì— ë¹ ì§ˆ ìˆ˜ ìˆë‹¤. ê·¸ëŸ´ ê²½ìš° batch sizeë¥¼ í‚¤ìš°ê±°ë‚˜, í•™ìŠµì´ ì§„í–‰ë˜ì–´ ê°ì— ë”°ë¼ learning rate ì„œì„œíˆ ê°ì†Œì‹œí‚´ìœ¼ë¡œì¨ sub optimalì— ë¹ ì§€ëŠ” ê²ƒì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
Â &lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;ì°¸ê³  ë‚´ìš© ì¶œì²˜ :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://wiki.hash.kr/index.php/DQN&quot;&gt;http://wiki.hash.kr/index.php/DQN&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://velog.io/@sjinu/%EA%B0%9C%EB%85%90%EC%A0%95%EB%A6%AC-7.-DQNDeep-Q-NEtwork&quot;&gt;https://velog.io/@sjinu/%EA%B0%9C%EB%85%90%EC%A0%95%EB%A6%AC-7.-DQNDeep-Q-NEtwork&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="RL" />
      
        <category term="coding" />
      

      
        <summary type="html">Â  DQN ì´ë€? Â  ì´ì „ì— (Reinforcement learning) Value Function Approximation í¬ìŠ¤íŒ…ì—ì„œ Value function approximationì— ëŒ€í•˜ì—¬ ë‹¤ë£¨ì—ˆë‹¤. ìš”ì•½í•˜ë©´ ê°•í™”í•™ìŠµì—ì„œ ê°„ë‹¨í•œ table í˜•íƒœë¡œ í•™ìŠµì„ í•˜ê²Œ ë˜ë©´ í•™ìŠµì´ ê·¹ë„ë¡œ ëŠë ¤ì§€ëŠ” ë¬¸ì œê°€ ìˆì–´ value functionì„ ë‹¤ì–‘í•˜ê²Œ ê·¼ì‚¬í•˜ì—¬ í™œìš©í•œë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Bidirectional Associative Memory êµ¬í˜„</title>
      <link href="http://localhost:4000/Implement-Bidirectional-Associative-Memory" rel="alternate" type="text/html" title="Bidirectional Associative Memory êµ¬í˜„" />
      <published>2022-05-16T11:47:00+09:00</published>
      <updated>2022-05-16T11:47:00+09:00</updated>
      <id>http://localhost:4000/Implement%20Bidirectional%20Associative%20Memory</id>
      <content type="html" xml:base="http://localhost:4000/Implement-Bidirectional-Associative-Memory">&lt;h2 id=&quot;bidirectional-associative-memory-bam-ì´ë€&quot;&gt;Bidirectional Associative Memory (BAM) ì´ë€?&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;
Â 
BAM ì€ Hopfield modelì„ í™•ì¥í•œ ëª¨ë¸ì´ë‹¤.
ì—¬ê¸°ì„œ ë˜ Hopfield modelì´ë¼ëŠ” ê²ƒì´ ë“±ì¥í•˜ëŠ” ë°(..), ì ì‹œ ì •ë¦¬í•˜ê³  ë„˜ì–´ê°€ì.&lt;/p&gt;

&lt;h3 id=&quot;hopfield-model&quot;&gt;Hopfield model&lt;/h3&gt;
&lt;p&gt;ì¸ê³µì§€ëŠ¥ì—ì„œ ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” í¼ì…‰íŠ¸ë¡ (perceptron) ë“±ì€ í•™ìŠµ ê³¼ì •ì—ì„œ weightê°€ ì ì  ì—…ë°ì´íŠ¸ ë˜ë©´ì„œ ìµœì  weightë¥¼ ì°¾ì•„ê°„ë‹¤. ì´ì™€ ë‹¤ë¥´ê²Œ Hopfield networkëŠ” ê³ ì •ëœ weightë¥¼ ì´ìš©í•˜ì—¬ ì •ë³´ë¥¼ ì—°ìƒí•œë‹¤.
Hopfield networkëŠ” í•™ìŠµ íŒ¨í„´ì— ëŒ€í•´ ê³„ì‚°ëœ ê³ ì • ê°€ì¤‘ì¹˜ í–‰ë ¬ì„ ì €ì¥í•˜ê³ , ì…ë ¥ íŒ¨í„´ì´ ë“¤ì–´ì˜¬ ë•Œë§ˆë‹¤ ê°€ì¤‘ì¹˜ í–‰ë ¬ì„ ì´ìš©í•˜ì—¬ ì…ë ¥ íŒ¨í„´ì— ëŒ€í•œ í•™ìŠµ íŒ¨í„´ì„ ì—°ìƒí•œë‹¤. í™‰í•„ë“œ ë„¤íŠ¸ì›Œí¬ ì•Œê³ ë¦¬ì¦˜ì€ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;p&gt;1) í•™ìŠµ íŒ¨í„´ì— ì–‘ê·¹í™” ì—°ì‚°ì„ ì ìš©&lt;/p&gt;

&lt;p&gt;2) í•™ìŠµ íŒ¨í„´ì— ëŒ€í•œ í™‰í•„ë“œ ë„¤íŠ¸ì›Œí¬ì˜ ê°€ì¤‘ì¹˜ í–‰ë ¬ì„ ê³„ì‚°&lt;/p&gt;

&lt;p&gt;3) ê³„ì‚°ëœ ê°€ì¤‘ì¹˜ í–‰ë ¬ì„ ì €ì¥&lt;/p&gt;

&lt;p&gt;4) ì…ë ¥ íŒ¨í„´ì´ ë“¤ì–´ì˜¤ë©´ ì €ì¥ëœ ê°€ì¤‘ì¹˜ í–‰ë ¬ì„ ì´ìš©í•˜ì—¬ ì…ë ¥ íŒ¨í„´ì— ëŒ€í•œ í•™ìŠµ íŒ¨í„´ì„ ì—°ìƒ&lt;/p&gt;

&lt;h3 id=&quot;bam&quot;&gt;BAM&lt;/h3&gt;
&lt;p&gt;BAMì€ ì´ëŸ° Hopfield modelì„ ì–‘ë°©í–¥ìœ¼ë¡œ íŒ¨í„´ì´ ì—°ìƒ ê°€ëŠ¥í•˜ë„ë¡ í™•ì¥í•œ ê²ƒì´ë‹¤. ì¦‰, Aì™€ B ë‘ê°œì˜ íŒ¨í„´ì´ ìˆì„ ë•Œ, Aë¡œë¶€í„° Bë¥¼ ì—°ìƒí•  ë¿ ì•„ë‹ˆë¼, ë°˜ëŒ€ë¡œ Bë¡œë¶€í„° Aë¥¼ ì—°ìƒí•  ìˆ˜ë„ ìˆë‹¤. ì´ëŸ° ì–‘ë°©í–¥ íŠ¹ì§• ë•Œë¬¸ì— ë‹¤ì–‘í•œ ë¶„ì•¼ì— í­ ë„“ê²Œ ì‘ìš©ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ì—¬ê¸°ì„œ ê³„ì† &lt;strong&gt;ì—°ìƒ&lt;/strong&gt; ì´ë¼ëŠ” ë§ì„ ì‚¬ìš©í•˜ê³  ìˆëŠ”ë° &lt;strong&gt;ì—°ìƒ&lt;/strong&gt; ì„ ì–´ë–»ê²Œ ì´í•´í•˜ë©´ ë ê¹Œ?&lt;/p&gt;

&lt;p&gt;ê°€ë²¼ìš´ ì˜ˆì‹œë¡œ ìš°ë¦¬ëŠ” ë°–ì—ì„œ ê°•ì•„ì§€ë¥¼ ë§Œë‚˜ë©´ â€˜ì–´? ê°•ì•„ì§€ë‹¤!â€™ í•˜ëŠ” ìƒê°ì„ í•œë‹¤. ê°•ì•„ì§€ì˜ ëª¨ìŠµìœ¼ë¡œ ë¶€í„° â€˜ê°•ì•„ì§€â€™ë¼ëŠ” ë‹¨ì–´ê°€ ì—°ìƒë˜ì—ˆê¸° ë•Œë¬¸ì´ë‹¤. ì—¬ê¸°ì„œ ë§í•˜ëŠ” ì—°ìƒë„ ì´ì™€ ìœ ì‚¬í•˜ê²Œ ì´í•´í•˜ë©´ ëœë‹¤. í™•ì¥í•˜ì—¬ &lt;strong&gt;ì–‘ë°©í–¥ ì—°ìƒ&lt;/strong&gt; ì€ ê°•ì•„ì§€ë¥¼ ë³´ê³  â€˜ê°•ì•„ì§€â€™ë¼ëŠ” ë‹¨ì–´ë¥¼ ì—°ìƒí•˜ëŠ” ê²ƒì— ë”í•´ â€˜ê°•ì•„ì§€â€™ë¼ëŠ” ë‹¨ì–´ë¥¼ ë³´ê³  ê°•ì•„ì§€ì˜ ëª¨ìŠµì„ ì—°ìƒí•˜ëŠ” ê²ƒìœ¼ë¡œ ì´í•´í•´ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë¦¼ìœ¼ë¡œ ì‚´í´ë³´ë©´, ì•„ë˜ ê·¸ë¦¼ì—ì„œ BAMì€ linear associatorê³¼ ë§¤ìš° ìœ ì‚¬í•˜ì§€ë§Œ ìì„¸íˆ ë³´ë©´ í™”ì‚´í‘œ ì´‰ì´ ì–‘ìª½ìœ¼ë¡œ ì—°ê²°ë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  ë‘ íŒ¨í„´ì˜ ì§‘ë‹¨(ê·¸ë¦¼ì—ì„œëŠ” x, yë¡œ í‘œê¸°ë¨)ì´ fully connected ë˜ì–´ ìˆìŒë„ ë³¼ ìˆ˜ ìˆë‹¤. Xì— í¬í•¨ëœ ìš”ì†Œë“¤ì´ Yì˜ ìš”ì†Œë“¤ê³¼ ì™„ì „íˆ ì—°ê²°ë˜ê³ , Yì˜ ìš”ì†Œë“¤ë„ Xì˜ ìš”ì†Œë“¤ë¡œ ì™„ì „íˆ ì—°ê²°ëœë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/bam1.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;ì´ ë•Œ, ë‘ ì§‘í•©ì„ ì„œë¡œ ì—°ê²°í•˜ì—¬ ê°ê°ì„ ì—°ìƒí•´ë‚´ê¸° ìœ„í•´ì„œëŠ” ë‘ ì§‘í•©ì˜ ìƒê´€ê´€ê³„ë¥¼ ì•Œì•„ì•¼ í•œë‹¤. ì´ ìƒê´€ê´€ê³„ë¥¼ êµ¬í•˜ëŠ” ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;

\[w_{ji} = \sum_{s=1}^{S} x_{i}^{s} y_{j}^{s}\]

&lt;p&gt;ì´ í–‰ë ¬ì€ BAMì—ì„œ ë§¤ìš° ì¤‘ìš”í•œë°, ë°”ë¡œ BAMì˜ í•™ìŠµì‹ì´ ëœë‹¤! ë°”ë¡œ ì´ í–‰ë ¬ì´ ê° ì§‘í•©ìœ¼ë¡œ ë¶€í„° ë‚˜ë¨¸ì§€ ì§‘í•©ì„ ì—°ìƒí•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤.&lt;/p&gt;

\[y_{j} =  \left ( \sum_{i=1}^{I} w_{ji} x_{i} \right ), ~~x_{i} =  \left ( \sum_{j=1}^{J} w_{ji} y_{j} \right )\]

&lt;p&gt;&lt;br /&gt;
Â 
Â &lt;/p&gt;
&lt;h2 id=&quot;bam-êµ¬í˜„&quot;&gt;BAM êµ¬í˜„&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;ì´ì œ ì´ ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ë³¸ê²©ì ìœ¼ë¡œ BAMì„ êµ¬í˜„í•´ë³´ì. class method ì¤‘ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;update_weight()&lt;/code&gt;ëŠ” ìœ„ì˜ ìˆ˜ì‹ì—ì„œ $w_{ji}$ ë¥¼, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;feedForward()&lt;/code&gt;ëŠ” $y_{j}$, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;feedBackward()&lt;/code&gt;ëŠ” $x_{i}$ ë¥¼ êµ¬í•˜ëŠ” ì‹ì„ íŒŒì´ì¬ìœ¼ë¡œ êµ¬í˜„í•œ í•¨ìˆ˜ì´ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;bam-class-êµ¬í˜„&quot;&gt;BAM class êµ¬í˜„&lt;/h3&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;BAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
    &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;
    &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight_matrix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make_new_weight_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;make_new_weight_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_count&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update_weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight_matrix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make_new_weight_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;sample_in&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;sample_out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
          &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# Generate x from y
&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;feedForward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# Generate y from x
&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;feedBackward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transpose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;computeEnergy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â &lt;/p&gt;

&lt;h3 id=&quot;ë°ì´í„°-ìƒì„±&quot;&gt;ë°ì´í„° ìƒì„±&lt;/h3&gt;
&lt;p&gt;ì´ì œ ë³¸ê²©ì ìœ¼ë¡œ BAMìœ¼ë¡œ í•™ìŠµì„ ì‹œì¼œë³´ì. í•™ìŠµì„ ìœ„í•´ì„œ ë°ì´í„°ë¥¼ ìƒì„±í•´ì¤€ë‹¤.
í•™ìŠµ ë°ì´í„°ì…‹ì€ Sê°œì˜ $(x^{s}, y^{s})$ ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. ì´ ë•Œ $x^{s}$ ëŠ” 1024ê°œì˜ element, $y^{s}$ 512ê°œì˜ elementë¡œ êµ¬ì„±ëœë‹¤. ê°ê°ì˜ elementëŠ” 50% í™•ë¥ ë¡œ 1, -1ì˜ ê°’ì„ ê°€ì§„ë‹¤.&lt;/p&gt;

&lt;p&gt;ë˜í•œ, ë‹¤ì–‘í•œ ë¹„êµë¥¼ ìœ„í•˜ì—¬ Sê°€ ê°ê° 50, 100, 200ì¼ ë•Œ ë°ì´í„° D50, D100, D200 ë¥¼ ìƒì„±í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# S=50
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x50&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y50&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# S=100
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# S=200
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x200&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y200&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â &lt;/p&gt;

&lt;h3 id=&quot;bam-í•™ìŠµ-ë…¸ì´ì¦ˆê°€-ì—†ëŠ”-ê²½ìš°&quot;&gt;BAM í•™ìŠµ (ë…¸ì´ì¦ˆê°€ ì—†ëŠ” ê²½ìš°)&lt;/h3&gt;
&lt;p&gt;ì´ì œ ì •ë§ë¡œ BAMìœ¼ë¡œ ì—°ìƒì„ ì‹œì‘í•´ë³´ì. Sê°œì˜ ë°ì´í„° ê°ê°ì„ input, outputìœ¼ë¡œ í•˜ì—¬ ì´ 10ë²ˆì˜ iteration ë™ì•ˆ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;feedForward()&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;feedBackward()&lt;/code&gt; ê³¼ì •ì„ ë°˜ë³µí•œ ë’¤, ê³„ì‚°ëœ outputê³¼ true outputì˜ ì°¨ì´ë¥¼ ë¹„êµí•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;copy&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;bam&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train_wo_noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;error_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;bam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update_weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;test_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;test_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feedForward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;error_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;test_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feedBackward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# plot error
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;number of different elements&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;epoch&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;Average of all output errors&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_wo_noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì˜ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ ì•„ë˜ì˜ ê·¸ë˜í”„ê°€ ì¶œë ¥ëœë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/bam2.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;noiseê°€ ì—†ëŠ” ê²½ìš°ì—ëŠ” ì—ëŸ¬ ì—†ì´ outputì´ ì˜ ì—°ìƒë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;

&lt;h3 id=&quot;bam-í•™ìŠµ-ë…¸ì´ì¦ˆê°€-ìˆëŠ”-ê²½ìš°&quot;&gt;BAM í•™ìŠµ (ë…¸ì´ì¦ˆê°€ ìˆëŠ” ê²½ìš°)&lt;/h3&gt;
&lt;p&gt;ì´ë²ˆì—ëŠ” inputì— ë…¸ì´ì¦ˆë¥¼ ì£¼ê³  ìœ„ì˜ ê³¼ì •ì„ ë‹¤ì‹œ ì§„í–‰í•´ë³´ì•˜ë‹¤. ê° ë°ì´í„°ì…‹ë§ˆë‹¤ $x^{10}$ ì— ë…¸ì´ì¦ˆë¥¼ ì¤€ë‹¤. ë…¸ì´ì¦ˆë¥¼ ì£¼ê¸° ìœ„í•´ì„œ $x^{10}$ ì˜ íŠ¹ì • ê°œìˆ˜ì˜ elementì— -1 ~ 1ì‚¬ì˜ì˜ ëœë¤í•œ ê°’ì„ ë”í•˜ì˜€ë‹¤.
ê·¸ë¦¬ê³  ë‹¤ì–‘í•œ ë¹„êµë¥¼ ìœ„í•˜ì—¬ ë…¸ì´ì¦ˆë¥¼ ì£¼ëŠ” elementì˜ ê°¯ìˆ˜ë¥¼ 0, 1, 2, 3, 5, 7, 10, 15, 20, 30, 50, 100ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ì§„í–‰í•´ì£¼ì—ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;make_noise_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;randomlist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;randomlist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train_w_noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_noise_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_elements&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;total_error_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update_weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# noise ê°¯ìˆ˜ ë³„ë¡œ ë°˜ë³µí•´ì„œ train
&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_noise&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_noise_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;error_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# x^10ì— ëŒ€í•´ 10ê°œì˜ ì„œë¡œ ë‹¤ë¥¸ noisy inputì„ ìƒì„±í•˜ê³  ì‹¤í–‰
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;test_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;make_noise_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;test_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# num_iteration ìˆ˜ ë§Œí¼ ë°˜ë³µí•˜ì—¬ ì‹¤í–‰
&lt;/span&gt;      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feedForward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;error_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;test_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feedBackward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;total_error_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# plot error
&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;total_error_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;total_error_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;{} noisy elements&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_noise_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;number of different elements&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;epoch&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;[D{}] Average of all output errors with noisy input&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_elements&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;center left&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bbox_to_anchor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;num_noise_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_w_noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_noise_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_w_noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_noise_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_w_noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_noise_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ ì•„ë˜ì˜ ê·¸ë˜í”„ê°€ ì¶œë ¥ëœë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/bam3.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/bam4.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;ì—ëŸ¬ê°€ ì—†ë˜ noise ì—†ëŠ” ê²½ìš°ì™€ëŠ” ë‹¬ë¦¬, noise elementê°€ ë§ì„ ìˆ˜ë¡ ì—ëŸ¬ê°€ ì»¤ì§„ë‹¤. ì´ ì—ëŸ¬ëŠ” iterationì´ ì§„í–‰ë˜ëŠ” ë™ì•ˆ ì ì  ê°ì†Œë˜ëŠ” ì–‘ìƒì„ ë³´ì¸ë‹¤.
ë˜í•œ, D200ì¸ ê²½ìš°ê°€ D50ì¸ ê²½ìš°ë³´ë‹¤ í•™ìŠµì— ì–´ë ¤ì›€ì´ ìˆìŒë„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
Â &lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;ì°¸ê³  ë‚´ìš© ì¶œì²˜ :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.aistudy.co.kr/neural/BAM.htm&quot;&gt;http://www.aistudy.co.kr/neural/BAM.htm&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://untitledtblog.tistory.com/7&quot;&gt;https://untitledtblog.tistory.com/7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="AI" />
      

      
        <summary type="html">Bidirectional Associative Memory (BAM) ì´ë€? Â  BAM ì€ Hopfield modelì„ í™•ì¥í•œ ëª¨ë¸ì´ë‹¤. ì—¬ê¸°ì„œ ë˜ Hopfield modelì´ë¼ëŠ” ê²ƒì´ ë“±ì¥í•˜ëŠ” ë°(..), ì ì‹œ ì •ë¦¬í•˜ê³  ë„˜ì–´ê°€ì.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">ì›¹ì•±ì—ì„œ íŠ¹ì • í¬ë¡¬ ìµìŠ¤í…ì…˜ ì„¤ì¹˜ ì—¬ë¶€ í™•ì¸í•˜ê¸°</title>
      <link href="http://localhost:4000/Check-installation-of-specific-chrome-extension-on-the-web-app" rel="alternate" type="text/html" title="ì›¹ì•±ì—ì„œ íŠ¹ì • í¬ë¡¬ ìµìŠ¤í…ì…˜ ì„¤ì¹˜ ì—¬ë¶€ í™•ì¸í•˜ê¸°" />
      <published>2022-05-15T03:21:00+09:00</published>
      <updated>2022-05-15T03:21:00+09:00</updated>
      <id>http://localhost:4000/Check%20installation%20of%20specific%20chrome%20extension%20on%20the%20web%20app</id>
      <content type="html" xml:base="http://localhost:4000/Check-installation-of-specific-chrome-extension-on-the-web-app">&lt;p&gt;Catty ì„œë¹„ìŠ¤ëŠ” í¬ë¡¬ ìµìŠ¤í…ì…˜ê³¼ í•¨ê»˜ ì‚¬ìš©í•´ì•¼ ê°€ì¥ í¸ë¦¬í•˜ê³  íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ì›¹ì•±ì— ë“¤ì–´ì˜¨ ì‚¬ëŒë“¤ ì¤‘ì— ì•„ì§ í¬ë¡¬ ìµìŠ¤í…ì…˜ì„ ì„¤ì¹˜í•˜ì§€ ì•Šì€ ì‚¬ëŒë“¤ì—ê²Œ ì•„ë˜ì™€ ê°™ì´ í¬ë¡¬ ìµìŠ¤í…ì…˜ì„ ì„¤ì¹˜í•˜ë¼ëŠ” ì•Œë¦¼ì„ ë„ìš°ê³ ì í•˜ì˜€ë‹¤.&lt;/p&gt;
&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/extension.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;ê·¸ëŸ¬ê¸° ìœ„í•´ì„œëŠ” ë¨¼ì € ì›¹ì•±ì—ì„œ í•´ë‹¹ ìœ ì €ì˜ Catty í¬ë¡¬ ìµìŠ¤í…ì…˜ ì„¤ì¹˜ ì—¬ë¶€ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ê¸°ëŠ¥ì€ í¬ë¡¬ ìµìŠ¤í…ì…˜ì—ì„œ ì´ë¯¸ì§€ í•˜ë‚˜ë¥¼ ì›¹ì—ì„œ ì ‘ê·¼ê°€ëŠ¥í•˜ê²Œ ì„¤ì •í•´ë‘ê³ , ì›¹ì—ì„œ í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒì„ ì‹œë„í•œ ë‹¤ìŒ, ì´ ì‹œë„ì˜ ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€ë¥¼ íŒë‹¨í•˜ëŠ” ê²ƒìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë¨¼ì €, í¬ë¡¬ ìµìŠ¤í…ì…˜ì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;manifest.json&lt;/code&gt;ì—ì„œ ì²´í¬í•˜ë ¤ê³  í•˜ëŠ” ì´ë¯¸ì§€ë¥¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;web_accessible_resources&lt;/code&gt;ì— ì¶”ê°€í•´ì¤€ë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;web_accessible_resources&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/images/Jcrop.gif&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/images/pixel.png&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê·¸ëŸ° ë‹¤ìŒ ì›¹ì•±ì— ë‹¤ìŒ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•œë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;useEffect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;detectExtension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CHROME_EXTENSION_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;detectExtension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;extensionId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;chrome-extension://&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;extensionId&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/images/pixel.png&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nx&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;setExtensionInstalled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onerror&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;setExtensionInstalled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ë ‡ê²Œ ì„¤ì •í•´ë‘ë©´ í•´ë‹¹ í•¨ìˆ˜ê°€ ìˆëŠ” ì»´í¬ë„ŒíŠ¸ê°€ mount ë  ë•Œ, í™•ì¸í•˜ê³  ì‹¶ì€ CHROME_EXTENSION_IDì˜ images/pixel.png ì´ë¯¸ì§€ ë¡œë“œë¥¼ ì‹œë„í•œë‹¤. ì´ ë•Œ ë¡œë“œê°€ ì‹¤íŒ¨í•˜ë©´ CHROME_EXTENSION_IDê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë‹¤ëŠ” ëœ»ì´ë¯€ë¡œ ì„¤ì¹˜ë¥¼ í•˜ë¼ëŠ” ì•Œë¦¼ì„ ë„ìš°ë©´ ëœë‹¤.&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="Catty" />
      
        <category term="extension" />
      

      
        <summary type="html">Catty ì„œë¹„ìŠ¤ëŠ” í¬ë¡¬ ìµìŠ¤í…ì…˜ê³¼ í•¨ê»˜ ì‚¬ìš©í•´ì•¼ ê°€ì¥ í¸ë¦¬í•˜ê³  íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ì›¹ì•±ì— ë“¤ì–´ì˜¨ ì‚¬ëŒë“¤ ì¤‘ì— ì•„ì§ í¬ë¡¬ ìµìŠ¤í…ì…˜ì„ ì„¤ì¹˜í•˜ì§€ ì•Šì€ ì‚¬ëŒë“¤ì—ê²Œ ì•„ë˜ì™€ ê°™ì´ í¬ë¡¬ ìµìŠ¤í…ì…˜ì„ ì„¤ì¹˜í•˜ë¼ëŠ” ì•Œë¦¼ì„ ë„ìš°ê³ ì í•˜ì˜€ë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">(Reinforcement learning) Value Function Approximation</title>
      <link href="http://localhost:4000/(RL)-Value-Function-Approximation" rel="alternate" type="text/html" title="(Reinforcement learning) Value Function Approximation" />
      <published>2022-05-13T13:23:00+09:00</published>
      <updated>2022-05-13T13:23:00+09:00</updated>
      <id>http://localhost:4000/(RL)%20Value%20Function%20Approximation</id>
      <content type="html" xml:base="http://localhost:4000/(RL)-Value-Function-Approximation">&lt;p&gt;ì´ë²ˆ ê¸€ì—ì„œëŠ” ê°•í™”í•™ìŠµ ê¸°ë³¸ ê°œë… ì¤‘ Value function approximationì— ëŒ€í•´ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ê¸€ì€ David Silverì˜ ê°•í™”í•™ìŠµ ê°•ì˜ì™€ KAIST EE619 ê°•í™”í•™ìŠµ ìˆ˜ì—…ì—ì„œ ê³µë¶€í•œ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;tabular-methods&quot;&gt;Tabular Methods&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;ê·œëª¨ê°€ ì‘ì€ MDP ëª¨ë¸ì˜ ê²½ìš°, stateì™€ actionì„ Tableì— ì €ì¥í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë” ì •í™•íˆëŠ” value functionì„ ì‚¬ìš©í•˜ëŠ” DP ë¬¸ì œì˜ ê²½ìš°, ëª¨ë“  state sëŠ” V(s) &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vector&lt;/code&gt;ì„ ê°€ì§ˆ ê²ƒì´ë‹¤. ë˜í•œ, action-value functionì„ ì‚¬ìš©í•˜ëŠ” MC, TDì˜ ê²½ìš° ëª¨ë“  state-action ìŒ (s, a)ì— ëŒ€í•˜ì—¬ Q(s, a) &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;matrix&lt;/code&gt;ê°€ ì¡´ì¬í•œë‹¤. ì´ë ‡ê²Œ í–‰ë ¬ë¡œ ë§Œë“¤ì–´ í‘¸ëŠ” ë°©ì‹ì„ &lt;strong&gt;Tabular Methods&lt;/strong&gt;ë¼ê³  í•œë‹¤. í•˜ì§€ë§Œ ì´ëŸ° Tabular MethodëŠ” stateì™€ actionì˜ ì°¨ì›ì´ ë¬´ì§€í•˜ê²Œ ì»¤ì§€ëŠ” ì‹¤ìƒí™œ ë¬¸ì œì— Generalizationì„ í•  ìˆ˜ ì—†ë‹¤.&lt;/p&gt;

&lt;p&gt;ë‹¤ìŒì˜ ë¬¸ì œë“¤ì„ ìƒê°í•´ë³´ì.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Backgammon: $10^{20}$ states&lt;/li&gt;
  &lt;li&gt;Compoter Go: $10^{170}$ states&lt;/li&gt;
  &lt;li&gt;Robot: continuous state space&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì´ëŸ° ê²½ìš°, íŠ¹íˆë‚˜ continuous state spaceë¥¼ ê°€ì§€ëŠ” ê²½ìš°ì—ëŠ” íŠ¹íˆë‚˜ Tableë§Œìœ¼ë¡œ í•¸ë“¤ë§ì´ ë¶ˆê°€ëŠ¥í•˜ê³  ë”°ë¼ì„œ ìƒˆë¡œìš´ ë°©ë²•ì´ í•„ìš”í•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;parameterizing-value-function&quot;&gt;Parameterizing value function&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;
Â 
ê·¸ë ‡ë‹¤ë©´ ì‹¤ìƒí™œì— ê°•í™”í•™ìŠµì„ ì ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ì–´ë–¤ ë°©ë²•ì„ ì´ìš©í•´ì•¼ í• ê¹Œ? stateì™€ actionì„ tableë¡œ êµ¬í˜„í•˜ëŠ” ëŒ€ì‹ ì—, $ w$ë¼ëŠ” ìƒˆë¡œìš´ ë³€ìˆ˜ë¥¼ í†µí•´ &lt;strong&gt;value function&lt;/strong&gt;ì„ í•¨ìˆ˜í™”í•¨ìœ¼ë¡œì¨ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.
ë¨¼ì €, value functionì„ function approximationì„ ì´ìš©í•˜ì—¬ ì¶”ì •í•´ì¤€ë‹¤.&lt;/p&gt;

\[\hat{V}_{w}(s) \approx V^{\pi}(s) ~~ or ~~\hat{Q}_{w}(s, a) \approx V^{\pi}(s, a)\]

&lt;p&gt;ë‹¤ìŒìœ¼ë¡œ, seen states(ë°©ë¬¸í•œ states)ë¡œ ë¶€í„° unseen states(ì•„ì§ ë°©ë¬¸í•˜ì§€ ì•Šì€ states)ë¡œ ì¼ë°˜í™”ì‹œí‚¨ë‹¤.
ë§ˆì§€ë§‰ìœ¼ë¡œ MCë‚˜ TD learningì„ ì´ìš©í•˜ì—¬ íŒŒë¼ë¯¸í„° $w$ë¥¼ í•™ìŠµí•˜ë©´ value functionì˜ optimalí•œ ì¶”ì •ì¹˜ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ë¥¼ ê·¸ë¦¼ìœ¼ë¡œ ë‹¤ì‹œ í™•ì¸í•´ë³´ë©´,&lt;/p&gt;
&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/value_approximation.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;
&lt;p&gt;stateê°€ í•¨ìˆ˜ì˜ inputìœ¼ë¡œ ë„£ê³ , $w$ë¼ëŠ” parameterë¥¼ ì§€ë‚˜ action value functionì„ outputìœ¼ë¡œ ë°›ëŠ” ê³¼ì •ì´ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;on-policy-prediction-with-function-approximation&quot;&gt;On-Policy Prediction with Function Approximation&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;
&lt;h3 id=&quot;loss-function-mean-square-value-errormsve&quot;&gt;Loss Function: Mean-Square Value Error(MSVE)&lt;/h3&gt;
&lt;p&gt;On-Policy Prediction problemì€ state value functionì„ ì¶”ì •í•´ë‚˜ê°€ëŠ” ê³¼ì •ì´ë‹¤.
True value function $V^{\pi}(s)$ ì™€ Approximation function $\hat{V} _{w}(s)$ ê°€ ìˆì„ ë•Œ, ë‘ í•¨ìˆ˜ê°€ ìµœëŒ€í•œ ê°™ì•„ì§€ë„ë¡ $\hat{V} _{w}(s)$ ì„ í•™ìŠµì‹œí‚¤ëŠ” ê²ƒì´ ëª©í‘œì´ë‹¤.
ì´ ë•Œ, ë‘ í•¨ìˆ˜ì˜ ì°¨ì´ë¥¼ Mean-Square Value Error(MSVE)ìœ¼ë¡œ ê°€ëŠ í•´ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

\[J(w) = MSE(w) = E_{\pi} = \left [ V^{\pi}(s) - \hat{V}_{w}(s) \right ]^{2} \\ = \sum_{s\in S}^{}\mu^{\pi}(s)\left [ V^{\pi}(s) - \hat{V}_{w}(s) \right ]^{2}\]

&lt;p&gt;ì—¬ê¸°ì„œ $\mu^{\pi}(s)$ ëŠ” $\pi$ ì— ëŒ€í•œ on-policy distribution ì´ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;on-policy-distribution&quot;&gt;On-Policy Distribution&lt;/h3&gt;
&lt;p&gt;MSVEëŠ” ë‘ í•¨ìˆ˜ ê°„ì˜ weighted $L_{2}$ distance ì´ë‹¤. ì´ë–„ ê° sì— ëŒ€í•´ì„œ weighting importanceëŠ” on-policy distribution $d^{\pi}(s)$ ì— ì˜í•´ ì£¼ì–´ì§„ë‹¤.
$d^{\pi}(s)$ ì„ ì •ì˜í•˜ëŠ” í•œ ê°€ì§€ ë°©ë²•ì€&lt;/p&gt;

&lt;h3 id=&quot;stochastic-gradient-descent&quot;&gt;Stochastic Gradient Descent&lt;/h3&gt;
&lt;p&gt;í•™ìŠµì€ ì •ì˜ëœ MSVEì— ëŒ€í•´ì„œ stochastic gradient descent ë°©ë²•ì„ í†µí•´ ì§„í–‰í•´ì¤€ë‹¤. Stochastic gradientì˜ ëª©í‘œëŠ” MSE lossë¥¼ ìµœì†Œí™”í•˜ëŠ” vector $w$ ë¥¼ ì°¾ëŠ” ê²ƒì´ë‹¤.
Stochastic Gradient Descentì„ ìˆ˜í–‰í•˜ëŠ” ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Mean-Square Loss Function: ë¯¸ë¶„ê°€ëŠ¥í•œ í•¨ìˆ˜ë¡œ ì£¼ì–´ì§„ë‹¤.
    &lt;ul&gt;
      &lt;li&gt;ë§Œì•½ loss functionì´ ë¯¸ë¶„ê°€ëŠ¥í•˜ì§€ ì•Šë‹¤ë©´, subgradientë¥¼ ì‚¬ìš©í•œë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;True Gradient: ë¨¼ì € loss functionì˜ true gradientë¥¼ ê³„ì‚°í•œë‹¤.
    &lt;ul&gt;
      &lt;li&gt;True gradient : $\sum_{s}^{}\mu^{\pi}(s) \left [ \left ( V^{\pi}(s) - \hat{V_{w}}(s) \right) \bigtriangledown \hat{V_{w}}(s) \right ]$&lt;/li&gt;
      &lt;li&gt;weight update : $ w_{t+1} = w_{t} + \alpha \sum_{s}^{}\mu^{\pi}(s) \left [ \left ( V^{\pi}(s) - \hat{V_{w}}(s) \right) \bigtriangledown \hat{V_{w}}(s) \right ] $&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Sampling the Gradient: ì´í›„ ìƒ˜í”Œì„ í†µí•´ stochastic gradient ë°©ë²•ìœ¼ë¡œ true gradientë¥¼ ì¶”ì •í•œë‹¤. ì´ëŸ° ë°©ì‹ì„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sample the gradient&lt;/code&gt; ë¼ê³  í•œë‹¤. 2ë²ˆì—ì„œ True expectation $\sum_{s\in S}^{}\mu^{\pi}(s)$ ì´ &lt;strong&gt;$\mu^{\pi}(s)$ ë¡œ ë¶€í„° ìƒì„±ëœ í•˜ë‚˜ì˜ ìƒ˜í”Œ $s_{t}$ ë¡œ ê³„ì‚°í•œ sample mean&lt;/strong&gt; ìœ¼ë¡œ ëŒ€ì²´ëœë‹¤.
    &lt;ul&gt;
      &lt;li&gt;Stochastic gradient : $\left [ \left ( V^{\pi}(s_{t}) - \hat{V_{w}}(s_{t}) \right) \bigtriangledown \hat{V_{w}}(s_{t}) \right ]$&lt;/li&gt;
      &lt;li&gt;weight update : $ w_{t+1} = w_{t} + \alpha \left ( V^{\pi}(s_{t}) - \hat{V_{w}}(s_{t}) \right) \bigtriangledown \hat{V_{w}}(s_{t}) $&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;$\mu^{\pi}(s)$ë¡œ ë¶€í„° ìƒ˜í”Œì„ ì¶©ë¶„íˆ ë§ì´ ì¶”ì¶œí•œë‹¤ë©´, sample-based SGëŠ” true gradient ë¡œ ìˆ˜ë ´í•œë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;on-policy-mc-td-learning&quot;&gt;On-Policy MC, TD Learning&lt;/h3&gt;
&lt;p&gt;gradientë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ì„œ, $s_{t}, V^{\pi}(s_{t})$ ì˜ true valueê°€ í•„ìš”í•˜ì§€ë§Œ ì´ ê°’ì€ ì•Œê¸° í˜ë“¤ë‹¤. ë”°ë¼ì„œ $V^{\pi}(s_{t})$ ë¥¼ ì¶”ì •ì¹˜ì¸ MC, TD or TD( $\lambda$ ) ì¶”ì²­ê°’ìœ¼ë¡œ ëŒ€ì²´í•œë‹¤. ê°ê°ì˜ ì¶”ì •ì¹˜ë¡œ ëŒ€ì²´í•˜ë©´,&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Gradient MC for Value Function Estimation: $ w_{t+1} = w_{t} + \alpha \left ( G_{t} - \hat{V_{w}}(s_{t}) \right) \bigtriangledown \hat{V_{w}}(s_{t}) $&lt;/li&gt;
  &lt;li&gt;Semi-Gradient TD for Value Function Estimation: $ w_{t+1} = w_{t} + \alpha \left ( r_{t+1} + \gamma \hat{V_{w}}(s_{t+1}) - \hat{V_{w}}(s_{t}) \right) \bigtriangledown \hat{V_{w}}(s_{t}) $&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;on-policy-control-with-function-approximation&quot;&gt;On-Policy Control with Function Approximation&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;h3 id=&quot;prediction-vs-control&quot;&gt;Prediction vs Control&lt;/h3&gt;
&lt;p&gt;On-Policy Controlì„ ë‹¤ë£¨ê¸°ì— ì•ì„œ Predictionê³¼ Controlì˜ ì°¨ì´ë¥¼ ë³µìŠµí•´ë³´ì. Perdictionê³¼ Controlì˜ ì°¨ì´ëŠ” policyì— ëŒ€í•œ ëª©í‘œì™€ ê´€ë ¨ì´ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë¨¼ì € RLì—ì„œ prediction taskëŠ” policyê°€ ì£¼ì–´ì§„ ìƒí™©ì—ì„œ ì´ policyê°€ ì–¼ë§ˆë‚˜ ì˜ ë™ì‘í•˜ëŠ” ì§€ë¥¼ ì¸¡ì •í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•œë‹¤. ë”°ë¼ì„œ, ì£¼ì–´ì‹  stateì—ì„œ total rewardë¥¼ ì˜ˆì¸¡í•˜ê¸° ìœ„í•´ì„œ $\pi(\left.\begin{matrix}
a\end{matrix}\right|s)$ ê°€ ê³ ì •ë˜ì–´ ìˆë‹¤.
ë°˜ë©´ì— control taskëŠ” policyê°€ ê³ ì •ë˜ì–´ ìˆì§€ ì•Šìœ¼ë©° ìµœì  policyë¥¼ ì°¾ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•œë‹¤. ì¦‰, ì„ì˜ì˜ ì£¼ì–´ì§„ ìƒíƒœì—ì„œ total rewardì˜ ì˜ˆì¸¡ê°’ì„ ê°€ì¥ í¬ê²Œ í•˜ëŠ” policy $\pi(\left.\begin{matrix}
a\end{matrix}\right|s)$ ë¥¼ ì°¾ëŠ”ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;control-with-value-function-approximation&quot;&gt;Control with Value Function Approximation&lt;/h3&gt;
&lt;p&gt;Control ê³¼ì •ì€ ë‹¤ì‹œ Policy evaluation ê³¼ì •ê³¼ Policy improvement ê³¼ì •ìœ¼ë¡œ ë‚˜ë‰œë‹¤. ì´ ë•Œ, model-freeë¥¼ ìœ„í•´ì„œ action-value functionì„ ì‚¬ìš©í•œë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/function_approx1.jpeg&quot; width=&quot;80%&quot; /&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;Policy evaluation : $\hat{Q}_{w}$ ë¥¼ $Q^{\pi}$ë¡œ ì¶”ì •&lt;/li&gt;
  &lt;li&gt;Policy improvement : action value functionì— $ \epsilon - greedy $ í•œ actionì„ ì·¨í•¨ìœ¼ë¡œì¨ improve ì§„í–‰&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;loss-function-mean-square-value-errormsve-1&quot;&gt;Loss Function: Mean-Square Value Error(MSVE)&lt;/h3&gt;
&lt;p&gt;Prediction ë•Œì™€ ë˜‘ê°™ì´ MSVEë¥¼ êµ¬í•´ë³´ë©´,&lt;/p&gt;

\[J(w) = MSE(w) = E_{\pi} = \left [ Q^{\pi}(s) - \hat{Q}_{w}(s) \right ]^{2} \\ = \sum_{s, a}^{}\mu^{\pi}(s, a)\left [ Q^{\pi}(s, a) - \hat{Q}_{w}(s, a) \right ]^{2}\]

\[- \frac{1}{2} \bigtriangledown  J(w) = \sum_{s, a}^{}\mu^{\pi}(s, a)\left ( Q^{\pi}(s, a) - \hat{Q}_{w}(s, a) \right ) \bigtriangledown \hat{Q}_{w}(s, a)\]

&lt;h3 id=&quot;stochastic-gradient-descent-1&quot;&gt;Stochastic Gradient Descent&lt;/h3&gt;
&lt;p&gt;policy $\pi$ ì—ì„œ ìƒ˜í”Œë§í•œ $(s_{t}, a_{t})$ì— ëŒ€í•˜ì—¬ MSVE ê°’ì„ ì´ìš©í•´ì„œ stochastic gradient descent or semi-gradientë¥¼ ìˆ˜í–‰í•œë‹¤.&lt;/p&gt;

\[\Delta w =  - \hat{\frac{1}{2}\bigtriangledown J(w)} = (Q^{\pi}(s_{t}, a_{t}) - \hat{Q}_{w_{t}}(s_t, a_{t})) \bigtriangledown \hat{Q}_{w_{t}}(s_t, a_{t})\]

&lt;p&gt;ë˜í•œ, Prediction ë§ˆì°¬ê°€ì§€ë¡œ true action value function $ Q^{\pi}(s_{t}, a_{t}) $ ì„ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— MC, TD targetì„ ì‚¬ìš©í•œë‹¤.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;For gradient MC:
 $ w_{t+1} = w_{t} + \alpha \left ( G_{t} - \hat{Q_{w}}(s_{t}, a_{t}) \right) \bigtriangledown \hat{Q_{w}}(s_{t}, a_{t}) $&lt;/li&gt;
  &lt;li&gt;For semi-gradient TD:
 $ w_{t+1} = w_{t} + \alpha \left ( r_{t+1} + \gamma \hat{Q_{w}}(s_{t+1}, a_{t+1}) - \hat{Q_{w}}(s_{t}, a_{t+1}) \right) \bigtriangledown \hat{Q_{w}}(s_{t}, a_{t+1}) $&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;off-policy-prediction-and-control-with-function-approximation&quot;&gt;Off-Policy Prediction and Control with Function Approximation&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;h3 id=&quot;off-policy-td-prediction-vpis-importance-sampling&quot;&gt;Off-Policy TD Prediction ($V^{\pi}$(s)): Importance Sampling&lt;/h3&gt;
&lt;p&gt;Target policy $\pi$, Behavior policy $\beta$ ì— ëŒ€í•˜ì—¬ ë¨¼ì € Tabular caseë¥¼ ë‹¤ì‹œ ì‚´í´ë³´ì.&lt;/p&gt;

\[V(s_{t}) \leftarrow V(s_{t}) + \alpha \left (  \frac{\left.\begin{matrix} \pi(a_{t}\end{matrix}\right|s_{t})}{\left.\begin{matrix} \beta(a_{t}\end{matrix}\right|s_{t})} (r_{t+1} + \gamma V(s_{t+1})) - V(s_{t}) \right )\]

\[V(s_{t}) \leftarrow V(s_{t}) + \alpha  \frac{\left.\begin{matrix} \pi(a_{t}\end{matrix}\right|s_{t})}{\left.\begin{matrix} \beta(a_{t}\end{matrix}\right|s_{t})} (r_{t+1} + \gamma V(s_{t+1}) - V(s_{t}))\]

&lt;p&gt;ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì´ì „ê³¼ ë¹„ìŠ·í•œ ë°©ì‹ìœ¼ë¡œ Stochastic Gradient Descentì„ ì ìš©í•´ weight update ì‹ì„ êµ¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;

\[w_{t+1} = w_{t} + \alpha \left (  \frac{\left.\begin{matrix} \pi(a_{t}\end{matrix}\right|s_{t})}{\left.\begin{matrix} \beta(a_{t}\end{matrix}\right|s_{t})} (r_{t+1} + \gamma \hat{V}_{w_{t}}(s_{t+1})) - \hat{V}_{w_{t}}(s_{t}) \right ) \bigtriangledown \hat{V}_{w_{t}}(s_{t})\]

\[w_{t+1} = w_{t} + \alpha  \frac{\left.\begin{matrix} \pi(a_{t}\end{matrix}\right|s_{t})}{\left.\begin{matrix} \beta(a_{t}\end{matrix}\right|s_{t})} (r_{t+1} + \gamma \hat{V}_{w_{t}}(s_{t+1}) - \hat{V}_{w_{t}}(s_{t})) \bigtriangledown  \hat{V}_{w_{t}}(s_{t})\]

&lt;p&gt;Â &lt;/p&gt;
&lt;h3 id=&quot;off-policy-td-control-action-value-function&quot;&gt;Off-Policy TD Control (Action-Value Function)&lt;/h3&gt;
&lt;p&gt;Controlì˜ ê²½ìš°ì—ë„ Tabular caseë¥¼ ë‹¤ì‹œ ì‚´í´ë³´ë©´,&lt;/p&gt;

\[Q(s_{t}, a_{t}) \leftarrow Q(s_{t}, a_{t}) + \alpha\left ( r_{t+1} + \gamma \sum_{a}^{} \pi(\left.\begin{matrix}
a\end{matrix}\right|s_{t+1})Q(s_{t+1}, a) - Q(s_{t}, a_{t}) \right )\]

&lt;p&gt;Function approximatationì˜ ê²½ìš°ë¡œ ë°œì „ì‹œí‚¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ëœë‹¤.&lt;/p&gt;

\[w_{t+1} = w_{t} + \alpha\left ( r_{t+1} + \gamma \sum_{a}^{} \pi(\left.\begin{matrix}
a\end{matrix}\right|s_{t+1}) \hat{Q}_{w_{t}}(s_{t+1}, a) - \hat{Q}_{w_{t}}(s_{t}, a_{t}) \right ) \bigtriangledown  \hat{Q}_{w_{t}}(s_{t}, a_{t})\]

&lt;p&gt;Â 
&lt;br /&gt;
Â &lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;ì°¸ê³  ë‚´ìš© ì¶œì²˜ :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;KAIST EE619 Mathmatical Foundations of Reinforcement Learning&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://stats.stackexchange.com/questions/340462/what-is-predicted-and-controlled-in-reinforcement-learning&quot;&gt;https://stats.stackexchange.com/questions/340462/what-is-predicted-and-controlled-in-reinforcement-learning&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="RL" />
      

      
        <summary type="html">ì´ë²ˆ ê¸€ì—ì„œëŠ” ê°•í™”í•™ìŠµ ê¸°ë³¸ ê°œë… ì¤‘ Value function approximationì— ëŒ€í•´ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Q-learning &amp;amp; Double Q-learning êµ¬í˜„</title>
      <link href="http://localhost:4000/Implement-Q-learning-&-Double-Q-learning" rel="alternate" type="text/html" title="Q-learning &amp; Double Q-learning êµ¬í˜„" />
      <published>2022-05-12T13:23:00+09:00</published>
      <updated>2022-05-12T13:23:00+09:00</updated>
      <id>http://localhost:4000/Implement%20Q-learning%20&amp;%20Double%20Q-learning</id>
      <content type="html" xml:base="http://localhost:4000/Implement-Q-learning-&amp;-Double-Q-learning">&lt;h2 id=&quot;q-learningê³¼-double-q-learning&quot;&gt;Q-learningê³¼ Double Q-learning&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;h3 id=&quot;q-learning&quot;&gt;Q-learning&lt;/h3&gt;
&lt;p&gt;Q-learning ì€ Off-policy learning ì•Œê³ ë¦¬ì¦˜ ì¤‘ í•˜ë‚˜ì´ë©° Off-policy learning ì•Œê³ ë¦¬ì¦˜ ì¤‘ì—ì„œë„ TD Control Off-policy ë°©ì‹ì´ë‹¤. Off-policy learning ì•Œê³ ë¦¬ì¦˜ ì¤‘ Off-policy MCì™€ Off-policy TDê°€ ìˆì§€ë§Œ Importance sampling ë¬¸ì œ ë•Œë¬¸ì— ì‚¬ìš©ì´ ì–´ë µë‹¤. Q-learningëŠ” Importance samplingì´ í•„ìš”ì—†ëŠ” ë°©ë²•ìœ¼ë¡œ ë³´ë‹¤ ìœ ìš©í•˜ë‹¤. Q-learningì´ ìœ ì¼í•œ TD Control Off-policy ë°©ì‹ì€ ì•„ë‹ˆì§€ë§Œ ìœ ëª…í•˜ê³  ì˜ ì•Œë ¤ì ¸ ìˆëŠ” ì´ìœ ëŠ” êµ¬í˜„ì´ ë§¤ìš° ì‰½ê¸° ë•Œë¬¸ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;Q-learningì€ Bellman optimality backup operationì„ ìƒ˜í”Œ ê¸°ë°˜ìœ¼ë¡œ ì¶”ì‚°í•˜ì—¬ optimal action-value function Q(s, a)ë¥¼ ì°¾ì•„ê°„ë‹¤. ê·¸ë¦¬ê³  ì´ ì¶”ì‚°ì¹˜ëŠ” ì•„ë˜ ìˆ˜ì‹ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´, behavior policyê³¼ target policyì˜ ì˜í–¥ì„ ë°›ì§€ ì•Šê³  ë‹¨ì§€ action-value functionì—ë§Œ ì˜í–¥ì„ ë°›ëŠ”ë‹¤.&lt;/p&gt;

\[Q(s, a) \leftarrow  Q(s, a) +  (r + max Q(s&apos;, a&apos;)-Q(s,a))\]

&lt;p&gt;ë”°ë¼ì„œ Importance sampling(behavior policyê³¼ target policy ì‚¬ì´ì˜ ìƒê´€ê´€ê³„ë¥¼ ì§€ì›Œì£¼ê¸° ìœ„í•´ì„œ ì‚¬ìš©)ì„ í•  ì´ìœ  ìì²´ê°€ ì‚¬ë¼ì§„ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;double-q-learning&quot;&gt;Double Q-learning&lt;/h3&gt;
&lt;p&gt;ì–¸ëœ»ë³´ë©´ On-policy TD Controlì¸ SARSAë‚˜ ë‹¤ë¥¸ Off-policy learning ì•Œê³ ë¦¬ì¦˜ì— ë¹„í•´ì„œ ì¥ì ë§Œ ìˆì–´ ë³´ì´ì§€ë§Œ, Maximization biasë¼ëŠ” ë‹¨ì ì´ ì¡´ì¬í•œë‹¤. Maximization biasëŠ” Q-Learnerê°€ ê°€ì¹˜í•¨ìˆ˜ Q(s, a)ë¥¼ ì‹¤ì œ ê°’ë³´ë‹¤ ë†’ê²Œ í‰ê°€í•˜ëŠ” ë¬¸ì œì´ë‹¤. ì´ëŠ” MDPì˜ stochasticity ë•Œë¬¸ì— ë°œìƒí•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ëŸ° Maximization biasë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•œ ë°©ë²•ë“¤ë„ ì—¬ëŸ¬ê°€ì§€ê°€ ê°œë°œì´ ë˜ì—ˆëŠ” ë° ê·¸ ì¤‘ í•˜ë‚˜ê°€ Double Q-learningì´ë‹¤. Double Q-learningì€ Maximization biasë¥¼ single estimatorì˜ ë¬¸ì œì ìœ¼ë¡œ ê·œì •í•˜ê³ , ì´ì— ëŒ€í•œ ëŒ€ì•ˆìœ¼ë¡œ double estimatorë¥¼ ì œì•ˆí•œë‹¤.&lt;/p&gt;

&lt;p&gt;Double Q-learningì€ ì„œë¡œ ë…ë¦½ëœ ë‘ê°œì˜ Q-functions Q1(s, a)ì™€ Q2(s, a)ë¥¼ ë§Œë“¤ê³  ê°ê° 1/2ì˜ í™•ë¥ ë¡œ ì—…ë°ì´íŠ¸ë¥¼ í•´ì¤€ë‹¤. ì´ëŸ° ë°©ì‹ìœ¼ë¡œ ì•Œê³ ë¦¬ì¦˜ì´ ë™ì‘í•˜ë©´ Maximization biasê°€ ì–´ëŠ ì •ë„ í•´ê²°ë¨ì´ ì•Œë ¤ì ¸ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;q-learningê³¼-double-q-learning-êµ¬í˜„&quot;&gt;Q-learningê³¼ Double Q-learning êµ¬í˜„&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;ë³¸ê²©ì ìœ¼ë¡œ Q-learningê³¼ Double Q-learningì„ êµ¬í˜„í•´ë³´ì. êµ¬í˜„ì€ ì œê³µë°›ì€ Gridworld Classì™€ Q-learning, Deep Q-learning classì˜ skeletonì„ í™œìš©í•˜ì—¬, Q-learning, Deep Q-learning classì˜ methodì™€ Gridworld ë° policyë¥¼ visualization í•˜ëŠ” í•¨ìˆ˜ë¥¼ êµ¬í˜„í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;gridworld-visualization&quot;&gt;Gridworld visualization&lt;/h3&gt;
&lt;p&gt;í•™ìŠµì„ ëŒë¦° Grid worldì˜ í™˜ê²½ì„ í™•ì¸í•˜ê¸° ìœ„í•˜ì—¬ Grid world ì¸ìŠ¤í„´ìŠ¤ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;paint_maps()&lt;/code&gt; í•¨ìˆ˜ë¥¼ ë¨¼ì € êµ¬í˜„í•´ì£¼ì—ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;paint_maps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;savefig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;Grid World&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;c1&quot;&gt;# Placing the initial state on a grid for illustration
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;initials&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;initials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

   &lt;span class=&quot;c1&quot;&gt;# Placing the trap states on a grid for illustration
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;traps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;terminal_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;traps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

   &lt;span class=&quot;c1&quot;&gt;# Placing the terminal state on a grid for illustration
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;terminals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;terminals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;

   &lt;span class=&quot;c1&quot;&gt;# Make a discrete color bar with labels
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;States&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Initial&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;State&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Trap&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;States&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Terminal&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;State&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#F9FFA4&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#B4FF9F&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#FFA1A1&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#FFD59E&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ListedColormap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;insert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;## Make normalizer and formatter
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;matplotlib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BoundaryNorm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;matplotlib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ticker&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FuncFormatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;diff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;tickz&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm_bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;diff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initials&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;traps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;terminals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colorbar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ticks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tickz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;k&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;terminal_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;X&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;center&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;va&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;center&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;O&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;center&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;va&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;center&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;savefig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savefig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;./gridworld.png&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì½”ë“œ ì‹¤í–‰ ê²°ê³¼ë¡œ í™•ì¸í•œ GridworldëŠ” ë‹¤ìŒê³¼ ê°™ì´ ìƒê²¼ë‹¤.&lt;/p&gt;
&lt;div style=&quot;text-align: left&quot; width=&quot;100%&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/gridworld.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;h3 id=&quot;q-learning-êµ¬í˜„&quot;&gt;Q-learning êµ¬í˜„&lt;/h3&gt;
&lt;p&gt;ë‹¤ìŒìœ¼ë¡œ Q-learningì˜ ê° methodë¥¼ êµ¬í˜„í•˜ì˜€ë‹¤. êµ¬í˜„ ìƒì„¸ ë‚´ìš©ì€ ì½”ë“œ ë‚´ ì£¼ì„ì„ í†µí•´ ë‚˜íƒ€ë‚´ì—ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Q_learning&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uniform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# epsilonì˜ í™•ë¥ ë¡œ randomí•˜ê²Œ actionì„ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;action_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# 1-epsilonì˜ í™•ë¥ ë¡œ í•´ë‹¹ stateì—ì„œ ê°€ì¥ ë†’ì€ Qê°’ì„ ì¶”ì‚°í•˜ê³  ìˆëŠ” actionì„ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;action_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# actionì˜ list indexë¥¼ ê³„ì‚°
&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# Q-Learning target : reward + gamma * (ë‹¤ìŒ stateì—ì„œ ì¶”ì‚°í•˜ê³  ìˆëŠ” ê°€ì¥ ë†’ì€ Qê°’)
&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;td_target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# update : Q-Learning targetì—ì„œ Q(s, a)ë¥¼ ëº€ê°’ì„ ì—…ë°ì´íŠ¸ í•´ì¤€ë‹¤.
&lt;/span&gt;       &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;td_target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_max_Q_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;max_Q_table&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# ê°€ëŠ¥í•œ ëª¨ë“  stateë¥¼ ëŒë©´ì„œ ìµœëŒ€ Qê°’ì„ ì°¾ì•„ max_Q_tableì— ì—…ë°ì´íŠ¸ í•´ì¤€ë‹¤.
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
           &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
               &lt;span class=&quot;n&quot;&gt;max_Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)].&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_Q_table&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Q-learning í•™ìŠµì´ ì˜ ë˜ì—ˆëŠ” ì§€ ì§ê´€ì ìœ¼ë¡œ í™•ì¸í•˜ê¸° ìœ„í•˜ì—¬ 10000ë²ˆ ì—í”¼ì†Œë“œ ë§ˆë‹¤ì˜ í•™ìŠµëœ policyë¥¼ ë„ì‹í™”í•´ë³´ì•˜ë‹¤. ì ì  ë” ë‚˜ì€ policyë¡œ ì˜ ê°€ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot; width=&quot;100%&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/q_learning_policy.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;ì´ policyë¥¼ ê·¸ë¦¬ê¸° ìœ„í•´ êµ¬í˜„í•œ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;plot_policy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;d_symbols&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;â†‘&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;â†’&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;â†“&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;â†&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#F9FFA4&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#B4FF9F&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#FFA1A1&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;#FFD59E&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;# Placing the initial state on a grid for illustration
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;initials&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;initials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

   &lt;span class=&quot;c1&quot;&gt;# Placing the trap states on a grid for illustration
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;traps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;terminal_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;traps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

   &lt;span class=&quot;c1&quot;&gt;# Placing the terminal state on a grid for illustration
&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;terminals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;terminals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ListedColormap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initials&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;traps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;terminals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interpolation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;nearest&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_yticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;edge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spine&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;spine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_visible&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xticklabels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_yticklabels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tick_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;x&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;w&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tick_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;y&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;w&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;which&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;minor&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;w&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;linestyle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;-&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;linewidth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tick_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;which&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;minor&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;direction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;direction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_symbols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;direction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;direction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;center&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;va&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;center&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;black&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;double-q-learning-êµ¬í˜„&quot;&gt;Double Q-learning êµ¬í˜„&lt;/h3&gt;
&lt;p&gt;ë§ˆì°¬ê°€ì§€ë¡œ Double Q-learningì˜ ê° methodë¥¼ êµ¬í˜„í•˜ì˜€ë‹¤. êµ¬í˜„ ìƒì„¸ ë‚´ìš©ì€ ì½”ë“œ ë‚´ ì£¼ì„ì„ í†µí•´ ë‚˜íƒ€ë‚´ì—ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Double_Q_learning&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uniform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# epsilonì˜ í™•ë¥ ë¡œ randomí•˜ê²Œ actionì„ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;action_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# 1-epsilonì˜ í™•ë¥ ë¡œ í•´ë‹¹ stateì—ì„œ ê°€ì¥ ë†’ì€ Qê°’ì„ ì¶”ì‚°í•˜ê³  ìˆëŠ” actionì„ ì„ íƒ
&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;# ì´ ë•Œ ê¸°ì¤€ì´ ë˜ëŠ” Qê°’ì€ Q1, Q2ê°’ì˜ í•©
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;action_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_state&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# 0.5ì˜ í™•ë¥ ë¡œ Q1ì„ ì—…ë°ì´íŠ¸
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;c1&quot;&gt;# actionì˜ list indexë¥¼ ê³„ì‚°
&lt;/span&gt;           &lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
           &lt;span class=&quot;c1&quot;&gt;# Q1 tableì—ì„œ next stateì—ì„œ ê°€ì¥ í° Qê°’ì„ ê°€ì§€ê³  ìˆëŠ” actionì˜ indexë¥¼ ê³„ì‚°
&lt;/span&gt;           &lt;span class=&quot;n&quot;&gt;q1_a_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
           &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q1_a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# ë‚˜ë¨¸ì§€ 0.5ì˜ í™•ë¥ ë¡œ Q2ë¥¼ ì—…ë°ì´íŠ¸
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
           &lt;span class=&quot;c1&quot;&gt;# actionì˜ list indexë¥¼ ê³„ì‚°
&lt;/span&gt;           &lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;actions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
           &lt;span class=&quot;c1&quot;&gt;# Q2 tableì—ì„œ next stateì—ì„œ ê°€ì¥ í° Qê°’ì„ ê°€ì§€ê³  ìˆëŠ” actionì˜ indexë¥¼ ê³„ì‚°
&lt;/span&gt;           &lt;span class=&quot;n&quot;&gt;q2_a_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
           &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q2_a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_max_Q_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;max_Q_table&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;# ê°€ëŠ¥í•œ ëª¨ë“  stateë¥¼ ëŒë©´ì„œ ìµœëŒ€ Qê°’ì„ ì°¾ì•„ max_Q_tableì— ì—…ë°ì´íŠ¸ í•´ì¤€ë‹¤. ì´ ë•Œ, Q1, Q2 ì¤‘ Q2ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ í•˜ì˜€ë‹¤.
&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_row_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
           &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_col_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
               &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                   &lt;span class=&quot;n&quot;&gt;max_Q_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)].&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_Q_table&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë§ˆì°¬ê°€ì§€ë¡œ Double Q-learning í•™ìŠµì´ ì˜ ë˜ì—ˆëŠ” ì§€ ì§ê´€ì ìœ¼ë¡œ í™•ì¸í•˜ê¸° ìœ„í•˜ì—¬ 10000 ì—í”¼ì†Œë“œë§ˆë‹¤ policyë¥¼ ê·¸ë ¤ë³´ì•˜ë‹¤. Double Q-learning policyë¥¼ ê·¸ë¦¬ëŠ” ë° Q-learning policyë¥¼ ê·¸ë¦´ ë•Œì™€ ê°™ì€ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot; width=&quot;100%&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/double_q_learning_policy.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;êµ¬í˜„-ê²°ê³¼-í™•ì¸&quot;&gt;êµ¬í˜„ ê²°ê³¼ í™•ì¸&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;êµ¬í˜„ì„ ì™„ë£Œí•œ ì´í›„ í•™ìŠµëœ ë‘ ëª¨ë¸ì˜ max Q-functionì„ ë½‘ì•„ plot í•´ë³´ì•˜ë‹¤. ì´ ê²°ê³¼ë¥¼ plotí•˜ëŠ” ë°ì—ëŠ” ì œê³µë°›ì€ í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì˜€ë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot; width=&quot;100%&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/q-learning.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;ì´ ê·¸ë˜í”„ë¥¼ ì‚´í´ë³´ë©´ Q-learningì˜ max Q valueê³¼ Double Q-learningì˜ ê°’ì´ ìµœëŒ€ 50ì •ë„ê¹Œì§€ ì°¨ì´ê°€ ë‚œë‹¤. ì „ë°˜ì ìœ¼ë¡œ Q-learningì—ì„œ Q valueê°’ì´ Double Q-learningì—ì„œì˜ ê°’ë³´ë‹¤ overestimate ë˜ì—ˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="RL" />
      
        <category term="coding" />
      

      
        <summary type="html">Q-learningê³¼ Double Q-learning Â </summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Dropout (Mathmatical approach)</title>
      <link href="http://localhost:4000/Dropout" rel="alternate" type="text/html" title="Dropout (Mathmatical approach)" />
      <published>2022-05-07T17:32:00+09:00</published>
      <updated>2022-05-07T17:32:00+09:00</updated>
      <id>http://localhost:4000/Dropout</id>
      <content type="html" xml:base="http://localhost:4000/Dropout">&lt;p&gt;Dropoutì€ &lt;a href=&quot;&quot;&gt;Prevent Multi layer perceptron Overfitting&lt;/a&gt;ì—ì„œì™€ ê°™ì´ ë”¥ëŸ¬ë‹ í•™ìŠµì—ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œì¸ Overfittingì„ í•´ì†Œí•˜ê¸° ìœ„í•œ ë°©ë²• ì¤‘ í•˜ë‚˜ì´ë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;solution-of-overfitting&quot;&gt;Solution of Overfitting&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;ì¼ë°˜ì ìœ¼ë¡œ ë¨¸ì‹  ëŸ¬ë‹ì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;the curse of dimensionality&lt;/code&gt;ë¼ëŠ” ì´ì•¼ê¸°ë¥¼ í•œë‹¤. ìš”ì•½í•˜ë©´ â€˜ë” ë§ì€ íŒŒë¼ë¯¸í„°â€™, â€˜ë” ë³µì¡í•œ ëª¨ë¸â€™ì€ ë°ì´í„°ì˜ ìˆ˜ê°€ ì ì„ ê²½ìš° ê±°ì˜ ì•”ê¸°í•´ë²„ë¦¬ê¸° ë•Œë¬¸ì— ë¬¸ì œê°€ ëœë‹¤ëŠ” ì–˜ê¸°ì´ë‹¤.
ì´ëŸ° ê²½ìš°ê°€ Overfittingì´ë¼ê³  ë¶ˆë¦¬ë©°, ì´ëŸ¬í•œ Overfittingì„ ë°©ì§€í•˜ê¸° ìœ„í•œ ë°©ë²•ì€ í¬ê²Œ ì•„ë˜ ë‘ê°€ì§€ ë°©ë²•ì´ ìˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ë°ì´í„° ìˆ˜ ëŠ˜ë ¤ì£¼ê¸°&lt;/p&gt;

    &lt;p&gt;Overfittingì˜ ì›ì¸ ì¤‘ í•˜ë‚˜ëŠ” ë°ì´í„°ì˜ ì–‘ì´ ì¶©ë¶„í•˜ì§€ ì•Šì€ ê²ƒì´ë‹¤. ë°ì´í„°ì˜ ìˆ˜ê°€ ë¶€ì¡±í•˜ë¯€ë¡œ ë³´í¸ì ì¸ ë¶„ë¥˜ë¥¼ í•˜ì§€ ëª»í•˜ê³  í›ˆë ¨ë°ì´í„°ì— ë„ˆë¬´ ë§ì€ ì˜í–¥ì„ ë°›ê²Œ ëœë‹¤. ë”°ë¼ì„œ ë” ë§ì€ ë°ì´í„°ë¡œ í•™ìŠµì„ ëŒë ¤ì£¼ë©´ Overfittingì„ ì–´ëŠ ì •ë„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ë³´í†µì˜ ê²½ìš° ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ê²ƒì´ ë§¤ìš° ë¹„ì‹¼ ê³¼ì •ì´ê¸° ë•Œë¬¸ì— ì´ ë°©ë²•ì€ ì‚¬ìš©í•˜ê¸° ì–´ë µë‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Regularization&lt;/p&gt;

    &lt;p&gt;ë‹¤ìŒìœ¼ë¡œ regulariztionì„ ì‚¬ìš©í•˜ì—¬ Overfittingì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤. &lt;a href=&quot;&quot;&gt;Prevent Multi layer perceptron Overfitting&lt;/a&gt;ì—ì„œ ì†Œê°œí•œ weight decayë„ ì´ regularization ê¸°ë²•ì— í¬í•¨ëœë‹¤. Regularizationì€ ëª¨ë¸ì´ í•™ìŠµ ë°ì´í„°ì— ì§€ë‚˜ì¹˜ê²Œ ì˜ì¡´í•˜ì§€ ì•Šë„ë¡ paneltyë¥¼ ë¶€ê³¼í•˜ëŠ” ê²ƒì´ë‹¤. ê¹Šì€(deep) ëª¨ë¸ ì¼ ìˆ˜ë¡ representation ëŠ¥ë ¥ì´ ë„ˆë¬´ ì¢‹ì•„ ì‰½ê²Œ Overfittingì´ ë  ìˆ˜ ìˆë‹¤. ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ regularization ê¸°ë²•ë“¤ì€ ì¼ë¶€ëŸ¬ representation ì„±ëŠ¥ì— ì œí•œì„ ì£¼ëŠ” ê²ƒì´ë‹¤. ì´ ê¸€ì˜ í† í”½ì¸ Dropoutë„ regularization ë°©ë²• ì¤‘ í•˜ë‚˜ì´ë‹¤.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;committee-machine&quot;&gt;Committee Machine&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;
Â &lt;/p&gt;
&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/dropout3.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;
&lt;p&gt;Committee Machineì€ ê·¸ë¦¼ê³¼ ê°™ì´ ì„œë¡œ ë‹¤ë¥¸ network ì§‘ë‹¨ì„ ë§Œë“  ë‹¤ìŒì— ê°ê° ë…ë¦½ì ìœ¼ë¡œ í•™ìŠµì‹œí‚¨ ë’¤, ë§ˆì§€ë§‰ì— í•©ì³ì„œ ê²°ê³¼ë¥¼ ë‚´ëŠ” ë°©ë²•ì´ë‹¤. ì´ëŸ° ë°©ì‹ì„ Ensemble averageë¼ê³  í•œë‹¤. ë§ˆì¹˜, ì „ë¬´ê°€ í•œ ëª…ì—ê²Œ ë¬¼ì–´ë³´ëŠ” ê²ƒë³´ë‹¤ ì „ë¬¸ê°€ ì—¬ëŸ¬ëª…ì—ê²Œ ë¬¼ì–´ë³¸ í›„ ê²°ê³¼ë¥¼ ì·¨í•©í•˜ë©´ ì˜ˆìƒì¹˜ ëª»í•œ biasë‚˜ ì˜¤ë¥˜ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆëŠ” ê²»ê³¼ ê°™ë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;dropout&quot;&gt;Dropout&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;
Â 
Committe Machineì˜ ì˜ˆì²˜ëŸ¼ í•™ìŠµì„ í•  ë•Œ, ì„œë¡œ ë‹¤ë¥¸ í•™ìŠµë°ì´í„°ë¥¼ í†µí•´ ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ê±°ë‚˜ ëª¨ë¸ì´ ì„œë¡œ ë‹¤ë¥¸ êµ¬ì¡°ë¥¼ ê°€ì§€ë©´ í•™ìŠµ ì„±ëŠ¥ì„ ê°œì„ í•  ìˆ˜ ìˆë‹¤. ì´ëŸ° ë°©ë²•ì„ Model Combinationì´ë¼ê³  í•œë‹¤.
í•˜ì§€ë§Œ ëª¨ë¸ì´ ë³µì¡í•œ ê²½ìš° í•˜ë‚˜ì˜ ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¤ëŠ” ê²ƒë„ ì–´ë ¤ìš´ë° ì—¬ëŸ¬ê°œì˜ ë„¤íŠ¸ì›Œí¬ë¥¼ í›ˆë ¨ì‹œí‚¤ëŠ” ê²ƒì€ ë§¤ìš° ì–´ë µë‹¤. ë˜í•œ ì´ë ‡ê²Œ í•™ìŠµì„ ì‹œì¼°ë‹¤ê³  í•´ë„ ì´ë ‡ê²Œ í•™ìŠµëœ ëª¨ë¸ì„ ì‹¤í–‰í•  ë•Œë„ ì—°ì‚° ì‹œê°„ì´ ì˜¤ë˜ê±¸ë¦°ë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ Dropout ê¸°ë²•ì€ ëª¨ë¸ì„ ì—¬ëŸ¬ê°œ ë§Œë“¤ ì§€ ì•Šê³  ëª¨ë¸ ê²°í•©ì´ ì—¬ëŸ¬ í˜•íƒœë¥¼ ê°€ì§€ê²Œ í•˜ì—¬ Model Combinationê³¼ ë¹„ìŠ·í•œ íš¨ê³¼ë¥¼ ë‚´ê²Œ í•œë‹¤. ë„¤íŠ¸ì›Œí¬ë¥¼ í•™ìŠµí•˜ëŠ” ë™ì•ˆ ëœë¤í•˜ê²Œ ì¼ë¶€ ë‰´ëŸ°ì„ ìƒëµí•´ë²„ë¦¬ë©´, ë‰´ëŸ°ì˜ ì¡°í•©ì˜ ì§€ìˆ˜í•¨ìˆ˜ ë§Œí¼ ë‹¤ì–‘í•œ ëª¨ë¸ì„ í•™ìŠµ ì‹œí‚¤ëŠ” ê²ƒê³¼ ë¹„ìŠ·í•´ì§„ë‹¤. nê°œì˜ ë‰´ëŸ°ì´ ìˆë‹¤ê³  í•˜ë©´ $2^{n}$ê°œì˜ ì„œë¡œ ë‹¤ë¥¸ ëª¨ë¸ì´ ìƒì„±ëœë‹¤.&lt;/p&gt;

&lt;p&gt;í•™ìŠµì€ ì´ë ‡ê²Œ ì‹œì¼°ë”ë¼ë„, ì´ë ‡ê²Œ í•™ìŠµëœ ëª¨ë¸ì„ ì‹¤í–‰ ì‹œí‚¬ ë•Œ ìƒì„±ëœ $2^{n}$ê°œì˜ ì„œë¡œ ë‹¤ë¥¸ ëª¨ë¸ì„ ë”°ë¡œ ì‹¤í–‰ì‹œí‚¤ë©´ ë˜‘ê°™ì´ ì—°ì‚° ì‹œê°„ì´ ë§¤ìš° ì˜¤ë˜ ê±¸ë¦¬ëŠ” ë¬¸ì œê°€ ìˆë‹¤. ë”°ë¼ì„œ ì´ë ‡ê²Œ ë§ì€ ëª¨ë¸ì„ ê°ê° ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì–´ì§œí”¼ ìƒëµëœ ëª¨ë¸ë“¤ì´ ëª¨ë‘ íŒŒë¼ë¯¸í„°ë¥¼ ê³µìœ í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ê°ê°ì˜ ë‰´ëŸ°ë“¤ì´ ëª¨ë¸ì—ì„œ ì¡´ì¬í•  (dropout í•˜ì§€ ì•Šì„) í™•ë¥ ì„ ê°ê°ì˜ ê°€ì¤‘ì¹˜ì— ê³±í•´ì£¼ëŠ” í˜•íƒœë¡œ í•œ ë²ˆë§Œ ì‹¤í–‰ì„ í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì •ë¦¬í•˜ë©´ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ í•™ìŠµ ì‹œì—ëŠ” ë‰´ëŸ°ì€ ì¡´ì¬í•  í™•ë¥  pë¡œ í•™ìŠµì„ ì§„í–‰í•˜ê³ , ì‹¤í–‰í•  ë•ŒëŠ” ê°ê°ì˜ networkì—ì„œ ì–»ì–´ì§„ ê°€ì¤‘ì¹˜ì— ì¡´ì¬ í™•ë¥  pë¥¼ ê³±í•´ì¤€ë‹¤.&lt;/p&gt;
&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/dropout1.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;
&lt;div style=&quot;text-align: left&quot;&gt;
   &lt;img src=&quot;/assets/img/post_images/dropout4.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h3 id=&quot;dropout-íš¨ê³¼&quot;&gt;Dropout íš¨ê³¼&lt;/h3&gt;
&lt;p&gt;Â 
ê·¸ë ‡ë‹¤ë©´ ì´ëŸ° ë°©ì‹ìœ¼ë¡œ ì–´ë–»ê²Œ regulation íš¨ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ” ê²ƒì¼ê¹Œ?&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;co-adaptation ë°©ì§€&lt;/p&gt;

    &lt;p&gt;ë¨¼ì € í•™ìŠµì„ ì‹œí‚¤ë‹¤ë³´ë©´, í•™ìŠµ ë°ì´í„°ì— ì˜í•´ ê°™ì€ ì¸µì˜ ê°ê°ì˜ weightë“¤ì´ ì„œë¡œ ê°™ì•„ì§€ëŠ” ê²½ìš°ê°€ ìƒê¸´ë‹¤. ì´ë ‡ê²Œ ë˜ë©´ ì´ ì´ìƒ í•™ìŠµì´ ì§„í–‰ë˜ì–´ë„ ì´ ë…¸ë“œë“¤ì€ ê°™ì€ ì¼ì„ ìˆ˜í–‰í•˜ê²Œ ë˜ì–´ ë¶ˆí•„ìš”í•œ ì¤‘ë³µì´ ìƒê²¨ ì»´í“¨íŒ… íŒŒì›Œ, ë©”ëª¨ë¦¬ ë‚­ë¹„ë¡œ ì´ì–´ì§„ë‹¤. ë“œë¡­ì•„ì›ƒì€ ì„ì˜ë¡œ ë…¸ë“œë“¤ì„ ìƒëµí•˜ëŠ” ë° ì´ë•Œ, ì´ëŸ¬í•œ ìƒí˜¸ ì ì‘ ì¤‘ì¸ ë…¸ë“œë“¤ ì¤‘ ì¼ë¶€ëŠ” ìƒëµí•˜ê³  ì¼ë¶€ëŠ” ìƒëµí•˜ì§€ ì•Šê²Œ ë˜ë¯€ë¡œ í•™ìŠµ ì¤‘ ìƒí˜¸ ì ì‘ì´ ë°œìƒí•œ ë…¸ë“œë“¤ì´ ë¶„ë¦¬ë  ìˆ˜ ìˆì–´ì„œ ìƒí˜¸ ì ì‘ ë¬¸ì œë¥¼ íšŒí”¼í•  ìˆ˜ ìˆê²Œ ëœë‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;hidden neuronë“¤ì˜ activityê°€ ì¢€ ë” ë“œë¬¸ë“œë¬¸(sparsity) í•´ì§„ë‹¤.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;dropoutì˜-regularization-íš¨ê³¼ì˜-ìˆ˜í•™ì -ì¦ëª…-single-linear-unit&quot;&gt;Dropoutì˜ regularization íš¨ê³¼ì˜ ìˆ˜í•™ì  ì¦ëª… (single linear unit)&lt;/h3&gt;
&lt;p&gt;Â 
ë¨¼ì € non-linear functionì´ ì—†ëŠ” single linear unitì— ëŒ€í•˜ì—¬ dropoutì˜ regularization íš¨ê³¼ë¥¼ ì‚´í´ë³¼ ê²ƒì´ë‹¤. ì´í›„ non-linear functionì´ ìˆëŠ” ê²½ìš°ë¥¼ ì‚´í´ë³¼ ì˜ˆì •ì´ë‹¤. multilayer ë¡œì˜ í™•ì¥ë„ ë¹„ìŠ·í•œ ë°©ì‹ìœ¼ë¡œ ì—¬ëŸ¬ layerì— ëŒ€í•˜ì—¬ ê³„ì‚°í•˜ì—¬ ì–»ì„ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;Dropoutì˜ regularization íš¨ê³¼ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•˜ì—¬ Ensemble averageë¥¼ ì‚¬ìš©í•˜ëŠ” test network errorì™€ trainingì—ì„œ ì‚¬ìš©ë˜ëŠ” $2^{n}$ê°œì˜ dropout network errorì„ ë¹„êµí•´ ë³¼ ê²ƒì´ë‹¤. ì¦‰,&lt;/p&gt;

\[\begin{cases}
 &amp;amp; E_{ENS} = \frac{1}{2}(t-O_{ENS})^{2} = \frac{1}{2}(t-\sum_{i=1}^{n}p_{i}w_{i}I_{i})^{2} \\
 &amp;amp; E_{D} = \frac{1}{2}(t-O_{D})^{2} = \frac{1}{2}(t-\sum_{i=1}^{n}\delta _{i}w_{i}I_{i})^{2}
\end{cases}\]

&lt;p&gt;ì„ ë¹„êµí•´ë³¸ë‹¤.
ë§Œì•½ test network errorì™€ dropout network errorê°€ ê±°ì˜ ê°™ë‹¤ë©´ êµ³ì´ dropout networkì„ ì“¸ ì´ìœ ê°€ ì—†ì–´ì§„ë‹¤. í•˜ë‚˜ì˜ í•™ìŠµë§Œ ì§„í–‰í•˜ëŠ” test network ë³´ë‹¤ í•™ìŠµì— í›¨ì”¬ ë” ë§ì€ ì‹œê°„ì´ ì†Œìš”ë˜ê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ, ì´ ë‘ ë„¤íŠ¸ì›Œí¬ì˜ ì—ëŸ¬ë¥¼ ë¹„êµí•´ë³´ëŠ” ê²ƒì´ dropoutì˜ í•„ìš”ì„± ë° ì •ê·œí™” íš¨ê³¼ë¥¼ í™•ì¸í•´ë³¼ ìˆ˜ ìˆëŠ” ì¢‹ì€ ë°©ë²•ì´ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ë‘ ë„¤íŠ¸ì›Œí¬ì˜ í•™ìŠµ ê³¼ì •ì„ ë¹„êµí•´ë³´ê¸° ìœ„í•˜ì—¬ gradientë¥¼ êµ¬í•˜ì—¬ ë¹„êµí•˜ì˜€ë‹¤.&lt;/p&gt;

\[\begin{cases}
 &amp;amp; \frac{\partial E_{ENS}}{\partial W_{i}} = -(t-O_{ENS})p_{i}I_{i} \\
 &amp;amp; \frac{\partial E_{D}}{\partial W_{i}} = -(t-O_{D})\delta _{i}I_{i} = -t\delta _{i}I_{i}+w_{i}\delta _{i}^{2}I_{i}^{2}+\sum_{j\neq i}^{}w_{j}\delta _{i}\delta _{j}I_{i}I_{j}
\end{cases}\]

&lt;p&gt;ì´ì œ, $E\left ( \frac{\partial E_{D}}{\partial w_{i}} \right )$ ì™€ $E\left ( \frac{\partial E_{ENS}}{\partial w_{i}} \right )$ ë¥¼ êµ¬í•´ë³´ì.
ë¨¼ì €, $E\left ( \frac{\partial E_{D}}{\partial w_{i}} \right )$ ëŠ”&lt;/p&gt;

\[E\left ( \frac{\partial E_{D}}{\partial w_{i}} \right ) = -(t-E(O_{D}|\delta _{i}=1) )p_{i}I_{i}\]

&lt;p&gt;ì´ ë•Œ,&lt;/p&gt;

\[E(\delta _{i}^{2}) = E(\delta _{i})=p_i ~(\because \delta _{i}=0, 1)\]

&lt;p&gt;ì´ë¯€ë¡œ,&lt;/p&gt;

\[E\left ( \frac{\partial E_{D}}{\partial w_{i}} \right ) = -tp_{i}I_{i}+w_{i}p_{i}I_{i}^{2}+\sum_{j\neq i}^{}w_{i}p_{i}p_{j}I_{i}I_{j}\]

&lt;p&gt;ë˜í•œ, $\sum w_{i}p_{i}p_{j}I_{i}I_{j}=\sum_{k=1}^{n}p_{k}w_{k}I_{k} \times p_{i}I_{i} - w_{i}I_{i}^{2}p_{i} = O_{ENS}P_{i}I_{i}-w_{i}I_{i}^{2}p_{i}$ ì´ë¯€ë¡œ&lt;/p&gt;

\[E\left ( \frac{\partial E_{D}}{\partial w_{i}} \right ) = -(t-O_{ENS})p_{i}I_{i} + w_{i}I_{i}^{2}(p_{i})(1-p_{i})
\\
= \frac{\partial E_{ENS}}{\partial w_{i}}+w_{i}I_{i}^{2}Var\delta _{i}=\frac{\partial E_{ENS}}{\partial W_{i}}+w_{i}Var\left ( \delta _{i}I_{i} \right )\]

\[\therefore  E_{D} = E_{ENS} + \frac{1}{2}\sum_{i=1}^{n}w_{i}^{2}I_{i}^{2}Var\delta _{i}\]

&lt;p&gt;ì´ ë•Œ, ì´ ì‹ì€ weight decayì—ì„œ $E=E_{0}+\alpha \left| w\right|^{2}$ ì™€ ê°™ì´ generalization capabilityë¥¼ ë†’ì´ê¸° ìœ„í•˜ì—¬ ì¶”ê°€ loss term ì„ ë”í•´ì¤€ ê²ƒê³¼ ê°™ì€ í˜•íƒœì´ë‹¤. ë”°ë¼ì„œ Single linear unitì—ì„œ, dropout networkëŠ” inference network(Ensemble average network)ì— weight decay termì„ ì¶”ê°€í•œ ê²ƒê³¼ ê°™ë‹¤. ë”°ë¼ì„œ weight decay termì„ ì¶”ê°€í•˜ëŠ” ê²ƒê³¼ ë™ì¼í•˜ê²Œ generalization íš¨ê³¼ê°€ ìƒê¸´ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;dropout-regularization-íš¨ê³¼ì˜-ìˆ˜í•™ì -ì¦ëª…-single-sigmoidal-unit&quot;&gt;Dropout regularization íš¨ê³¼ì˜ ìˆ˜í•™ì  ì¦ëª… (single sigmoidal unit)&lt;/h3&gt;
&lt;p&gt;Â 
ë¹„ìŠ·í•œ ë°©ì‹ìœ¼ë¡œ, ì´ë²ˆì—ëŠ” non-linear functionì´ ìˆëŠ” ê²½ìš°ë¥¼ ì‚´í´ë³´ì.  non-linear functionì´ ì—†ëŠ” ê²½ìš°ì™€ ë§ˆì°¬ê°€ì§€ë¡œ $\frac{\partial E_{ENS}}{\partial w_{i}}$ ì™€ $\frac{\partial E_{D}}{\partial w_{i}}$ ë¥¼ ë¹„êµí•´ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ë•Œ, ErrorëŠ” cross entropy loss functionì„ ì´ìš©í•˜ì˜€ê³ , ë”°ë¼ì„œ ë‹¤ìŒì˜ ì—ëŸ¬ í…€ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

\[E = -(t-logO + (1-t)log(1-O)), ~~O=\sigma(s)=\frac{1}{(1+ce^{-\lambda s})}\]

&lt;p&gt;ì´ ë•Œ, $ \frac{\partial E}{\partial w} = \frac{\partial E}{\partial O} \frac{\partial O}{\partial S} \frac{\partial S}{\partial w} $ ì´ê³ ,&lt;/p&gt;

&lt;p&gt;$ \frac{\partial E}{\partial O} = -t \frac{1}{O} + (1-t) \frac{1}{1-O}, ~~\frac{\partial O}{\partial S} = \lambda O (1-O) $ ì´ë¯€ë¡œ,&lt;/p&gt;

&lt;p&gt;$ \frac{\partial E}{\partial w} = -\lambda(t-O)\frac{\partial S}{\partial w} $ ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ ë‘ gradientëŠ”,&lt;/p&gt;

\[\begin{cases}
 &amp;amp; \frac{\partial E_{ENS}}{\partial w_{i}} = \lambda(t-\sigma(U))p_{i}I_{i} = - \lambda  \left ( t-\sigma \left ( \sum_{j}^{}w_{j}p_{j}I_{j} \right ) \right )p_{i}I_{i} \\
 &amp;amp; \frac{\partial E_{D}}{\partial w_{i}}  = \lambda(t- O)\delta _{i}I_{i} = - \lambda  \left ( t-\sigma \left ( \sum_{j}^{}w_{j}\delta _{j}I_{j} \right ) \right )\delta _{i}I_{i}
\end{cases}\]

&lt;p&gt;ì´ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ë§ˆì§€ë§‰ìœ¼ë¡œ $E\left ( \frac{\partial E_{D}}{\partial w_{i}} \right )$ ì„ ê³„ì‚°í•˜ë©´,&lt;/p&gt;

\[E\left ( \frac{\partial E_{D}}{\partial w_{i}} \right ) = -\lambda \left ( t - E \left [ \sigma \left ( \sum_{j}^{} w_{j}\delta _{j} I_{j} | \delta_{i} = 1 \right ) \right ] \right )p_{i}I_{i}
\\
\approx -\lambda\left ( t-\sigma \left ( \sum_{j}^{} w_{j}p_{j}I_{j} - w_{i}p_{i}I_{i} + w_{i}I_{i}\right ) \right )p_{i}I_{i}
\\
\approx -\lambda \left ( t-\sigma(S_{ENS}) - \sigma^{&apos;}(S_{ENS})I_{i}w_{i}(1-p_{i}) \right )p_{i}I_{i}
\\
= \frac{\partial E_{ENS}}{\partial w_{i}}+\lambda \sigma ^{&apos;}(U)w_{i}Var(\delta _{i}I_{i}))\]

\[\therefore  E_{D} = E_{ENS} + \frac{1}{2} \lambda \sigma ^{&apos;}(U)\sum_{i=1}^{n}w_{i}^{2}I_{i}^{2}Var\left ( \delta _{i} \right )\]

&lt;p&gt;ë”°ë¼ì„œ, ì´ ê²½ìš°ë„ ë§Œì°¬ê°€ì§€ë¡œ Ensemble average networkì— weight decay termì„ ì‚¬ìš©í•œ ê²ƒê³¼ í˜•íƒœê°€ ê°™ê³ , ë”°ë¼ì„œ ì •ê·œí™” ì—­í• ì„ í•œë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
Â 
ì°¸ê³  ë‚´ìš© ì¶œì²˜ :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;KAIST EE538 Neural Networks lecture&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&amp;amp;blogId=laonple&amp;amp;logNo=220818841217&quot;&gt;https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&amp;amp;blogId=laonple&amp;amp;logNo=220818841217&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://hyeonnii.tistory.com/254&quot;&gt;https://hyeonnii.tistory.com/254&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="AI" />
      

      
        <summary type="html">Dropoutì€ Prevent Multi layer perceptron Overfittingì—ì„œì™€ ê°™ì´ ë”¥ëŸ¬ë‹ í•™ìŠµì—ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œì¸ Overfittingì„ í•´ì†Œí•˜ê¸° ìœ„í•œ ë°©ë²• ì¤‘ í•˜ë‚˜ì´ë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Matrix Factorization(MF) ê¸°ë°˜ ì¶”ì²œì‹œìŠ¤í…œ</title>
      <link href="http://localhost:4000/RecSys-based-on-MF" rel="alternate" type="text/html" title="Matrix Factorization(MF) ê¸°ë°˜ ì¶”ì²œì‹œìŠ¤í…œ" />
      <published>2022-05-07T17:32:00+09:00</published>
      <updated>2022-05-07T17:32:00+09:00</updated>
      <id>http://localhost:4000/RecSys%20based%20on%20MF</id>
      <content type="html" xml:base="http://localhost:4000/RecSys-based-on-MF">&lt;p&gt;ì¶”ì²œì‹œìŠ¤í…œì˜ ê¸°ì´ˆì ì¸ ë‚´ìš©ì„ ì˜ ì•Œì§€ ëª»í•œì±„ë¡œ ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•˜ëŠ” ë…¼ë¬¸ë“¤ì„ ëª‡ê°œ ì½ë‹¤ë³´ë‹ˆ êµ¬í˜„ì˜ ê¸°ë°˜ì´ ë˜ëŠ” ì¤‘ìš”í•œ ì›ë¦¬ë¥¼ ê³„ì† ë†“ì¹˜ê³  ìˆëŠ” ë“¯í•œ ê¸°ë¶„ì´ ë“¤ì—ˆë‹¤. ê·¸ë˜ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Pythonì„ ì´ìš©í•œ ê°œì¸í™” ì¶”ì²œì‹œìŠ¤í…œ&lt;/code&gt; ì±…ì„ ì‚¬ì„œ ì½ê³ , ë˜ ë‹¤ì–‘í•œ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ ë³´ë©° ì¶”ì²œì‹œìŠ¤í…œì— ëŒ€í•œ ê³µë¶€ë¥¼ ë” ê¹Šì´ í•´ë³´ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;ê³µë¶€ë¥¼ í•˜ë‹¤ ë³´ë‹ˆ ì¶”ì²œì‹œìŠ¤í…œì—ì„œ &lt;strong&gt;Matrix Factorization&lt;/strong&gt;ì´ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤ëŠ” ê²ƒì„ ëŠê¼ˆë‹¤. MFëŠ” Collaborative Filteringì˜ í•œ ì¢…ë¥˜ë¡œ, Netflix Prizeì—ì„œ ì²˜ìŒ ë“±ì¥í•˜ì—¬ ì—„ì²­ë‚œ ì„±ëŠ¥ í–¥ìƒì„ ë³´ì„ìœ¼ë¡œì¨ ì¶”ì²œ ì‹œìŠ¤í…œ ë¶„ì•¼ì˜ í˜ì‹ ì„ ì¼ìœ¼ì¼°ë‹¤ê³  í•œë‹¤. ê¸°ì¡´ì— ë§ì´ ì‚¬ìš©ë˜ì—ˆë˜ ì»¨í…ì¸  ê¸°ë°˜ ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ì€ Data Sparsityì™€ Scalibilityì— ì·¨ì•½í–ˆë‹¤.(ì‚¬ìš©ìë‚˜ ì•„ì´í…œì´ ëŠ˜ì–´ë‚ ìˆ˜ë¡ Sparsityê°€ ì¦ê°€í•˜ê²Œ ë˜ëŠ”ë°, CFëŠ” ê²°ì¸¡ê°’ì„ ì„ì˜ë¡œ ì±„ì›Œì„œ ì¶”ì²œí•˜ë‹¤ë³´ë‹ˆ ì„±ëŠ¥ì´ ë–¨ì–´ì§„ë‹¤. ë°˜ë©´ MFëŠ” ê²°ì¸¡ê°’ì„ ì•„ì˜ˆ ì‚¬ìš©í•˜ì§€ ì•Šì•„ ì„±ëŠ¥ì„ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.)&lt;/p&gt;

&lt;p&gt;MFëŠ” ì´ëŸ° í•œê³„ì ì„ ê·¹ë³µí•˜ë©´ì„œë„ ì¶”ì²œ ì†ë„ê°€ ë¹¨ë¼ í˜„ì‹¤ ì„¸ê³„ì—ì„œëŠ” ê°€ì¥ ë§ì´ ì“°ì¸ë‹¤. ë”¥ëŸ¬ë‹ì´ ê¸‰ë¶€ìƒí•œ ìš”ì¦˜ì—ëŠ” MFì˜ ì›ë¦¬ë¥¼ ë”¥ëŸ¬ë‹ì— ì‘ìš©í•˜ì—¬ ì„±ëŠ¥ì„ í•œì¸µ ë” ë†’ì˜€ë‹¤ê³  í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë˜ì„œ ì´ë²ˆ ê¸€ì—ì„œëŠ” Matrix Factorization ê¸°ë°˜ì˜ ì¶”ì²œì‹œìŠ¤í…œì„ ìì„¸íˆ ì •ë¦¬í•´ë³´ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;ì¶”ì²œ-ì•Œê³ ë¦¬ì¦˜-ë¶„ë¥˜&quot;&gt;ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ ë¶„ë¥˜&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;
Â 
ë¨¼ì €, MFëŠ” ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ì˜ í•œ ì¢…ë¥˜ì¸ë°, ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ ì¤‘ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ëª¨ë²¨ ê¸°ë°˜ ì•Œê³ ë¦¬ì¦˜&lt;/code&gt;ì— ì†í•œë‹¤. ì´ ëª¨ë¸ ê¸°ë°˜ì˜ ì•Œê³ ë¦¬ì¦˜ ì´ì™¸ì—ë„ ë©”ëª¨ë¦¬ ê¸°ë°˜ì˜ ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ë„ ìˆë‹¤. ì´ ë‘˜ì˜ ì°¨ì´ì ì„ ê°„ë‹¨íˆ ì •ë¦¬í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ë©”ëª¨ë¦¬-ê¸°ë°˜-ì¶”ì²œ-ì•Œê³ ë¦¬ì¦˜-memory-based-rs&quot;&gt;ë©”ëª¨ë¦¬ ê¸°ë°˜ ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ (memory-based RS)&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;ì¶”ì²œì„ ìœ„í•œ ë°ì´í„°ë¥¼ ëª¨ë‘ ë©”ëª¨ë¦¬ì— ê°€ì§€ê³  ìˆìœ¼ë©´ì„œ ì¶”ì²œì´ í•„ìš”í•  ë•Œë§ˆê°€ ì´ ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ì„œ ê³„ì‚°ì„ í•´ì„œ ì¶”ì²œí•˜ëŠ” ë°©ì‹&lt;/li&gt;
  &lt;li&gt;ëŒ€í‘œì ìœ¼ë¡œ í˜‘ì—… í•„í„°ë§(Collaborative Filtering: CF) ê¸°ë°˜ ì•Œê³ ë¦¬ì¦˜ì„ ë“¤ ìˆ˜ ìˆë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ëª¨ë¸-ê¸°ë°˜-ì¶”ì²œ-ì•Œê³ ë¦¬ì¦˜-model-based-rs&quot;&gt;ëª¨ë¸ ê¸°ë°˜ ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ (model-based RS)&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;ë°ì´í„°ë¡œë¶€í„° ì¶”ì²œì„ ìœ„í•œ ëª¨ë¸ì„ êµ¬ì„±í•œ í›„ì— ì´ ëª¨ë¸ë§Œ ì €ì¥í•˜ê³ , ì‹¤ì œ ì¶”ì²œì„ í•  ë•Œì—ëŠ” ì´ ëª¨ë¸ì„ ì‚¬ìš©í•´ì„œ ì¶”ì²œì„ í•˜ëŠ” ë°©ì‹&lt;/li&gt;
  &lt;li&gt;ëª¨ë¸ì„ ìƒì„±í•  ë•ŒëŠ” ë§ì€ ê³„ì‚°ì´ ìš”êµ¬ë˜ì§€ë§Œ í•œ ë²ˆ ëª¨ë¸ì„ ìƒì„±í•´ë‘ë©´ ì´í›„ë¶€í„°ëŠ” ë” ë¹ ë¥¸ ì¶”ì²œì„ ì œê³µí•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;
  &lt;li&gt;ì´ë²ˆ ê¸€ì—ì„œ ë‹¤ë£¨ëŠ” MF ë°©ì‹, Deep-Learning ê¸°ë°˜ì˜ ë°©ì‹ì´ ëŒ€í‘œì ì´ë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;matrix-factorizationmf-ì•Œê³ ë¦¬ì¦˜-ì›ë¦¬&quot;&gt;Matrix Factorization(MF) ì•Œê³ ë¦¬ì¦˜ ì›ë¦¬&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;
Â 
MF ì•Œê³ ë¦¬ì¦˜ì€ ìœ ì €ê°€ ì•„ì´í…œì— ëŒ€í•´ í‰ê°€í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” (user x item) ë°ì´í„° í–‰ë ¬ì„ (user x feature)ì˜ ìœ ì € í–‰ë ¬ê³¼ (item x freature)ì˜ ì•„ì´í…œ í–‰ë ¬ë¡œ ìª¼ê°œì„œ ë¶„ì„í•˜ëŠ” ë°©ì‹ì„ ì˜ë¯¸í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì¢€ ë” formalí•˜ê²ŒëŠ” R: [user x item] í˜•íƒœì˜ full-matrix(í‰ê°€ ë°ì´í„°)ë¥¼&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;P : [ user x feature ]&lt;/li&gt;
  &lt;li&gt;Q : [ item x feature ]
  ì˜ ë‘ í–‰ë ¬ë¡œ ìª¼ê°œì„œ ë¶„ì„í•˜ëŠ” ë°©ì‹ì´ë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/mf3.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
Â 
ì´ ë•Œ featureì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;latent factor&lt;/code&gt; ë¡œì„œ userì™€ itemì´ ê³µí†µìœ¼ë¡œ ê³µìœ í•˜ê³  ìˆëŠ” íŠ¹ì„±ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;featureì„ ë” ì˜ ì´í•´í•˜ê¸° ìœ„í•´ì„œ ì˜ˆì‹œë¡œ ì˜í™” ì¶”ì²œì—ì„œ featureì˜ ê°œìˆ˜ê°€ 2ê°œì¸ ê²½ìš°ë¥¼ ìƒê°í•´ë³´ì. featureì˜ ê°œìˆ˜ê°€ 2ê°œì´ë¯€ë¡œ userì™€ itemì˜ íŠ¹ì§•ì„ 2ê°œì˜ ìš”ì¸ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë§Œì•½ ì´ ìš”ì¸ì´ ë¡œë§¨ìŠ¤-ë¯¸ìŠ¤í„°ë¦¬ ê³ ì „-íŒíƒ€ì§€ì´ê³  ê°’ì´ -1.0 ~ 1.0 ì‚¬ì´ë¼ê³  í•˜ë©´,&lt;/p&gt;

&lt;p&gt;user í–‰ë ¬ Pì™€ item í–‰ë ¬ QëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[ user í–‰ë ¬ P ]&lt;/strong&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ì‚¬ìš©ì \ ì ì¬ìš”ì¸&lt;/th&gt;
      &lt;th&gt;ë¡œë§¨ìŠ¤-ë¯¸ìŠ¤í„°ë¦¬&lt;/th&gt;
      &lt;th&gt;ê³ ì „-íŒíƒ€ì§€&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;user A&lt;/td&gt;
      &lt;td&gt;0.63&lt;/td&gt;
      &lt;td&gt;0.23&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;user B&lt;/td&gt;
      &lt;td&gt;0.35&lt;/td&gt;
      &lt;td&gt;0.77&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;[ item í–‰ë ¬ P ]&lt;/strong&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ì˜í™” \ ì ì¬ìš”ì¸&lt;/th&gt;
      &lt;th&gt;ë¡œë§¨ìŠ¤-ë¯¸ìŠ¤í„°ë¦¬&lt;/th&gt;
      &lt;th&gt;ê³ ì „-íŒíƒ€ì§€&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;movie A&lt;/td&gt;
      &lt;td&gt;0.12&lt;/td&gt;
      &lt;td&gt;0.82&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;movie B&lt;/td&gt;
      &lt;td&gt;0.45&lt;/td&gt;
      &lt;td&gt;0.34&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ì´ í‘œë¥¼ í™•ì¸í•´ë³´ë©´ user AëŠ” ë¡œë§¨ìŠ¤ë³´ë‹¤ëŠ” ë¯¸ìŠ¤í„°ë¦¬ë¥¼, íŒíƒ€ì§€ ë³´ë‹¤ëŠ” ê³ ì „ì„ ì¢‹ì•„í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤. ë˜í•œ movie BëŠ” ë¡œë§¨ìŠ¤ì™€ ë¯¸ìŠ¤í„°ë¦¬ íŠ¹ì„±ì„ ë°˜ë°˜ì”© ê°€ì§€ê³  ìˆìœ¼ë©° ê³ ì „ì˜ íŠ¹ì„±ì„ ì¡°ê¸ˆ ë” ë„ê³  ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ì²˜ëŸ¼ ì˜í™”ì˜ íŠ¹ì„±ê³¼ userì˜ íŠ¹ì •ì´ ê°ê° 2ê°œì˜ ì ì¬ ìš”ì¸ìœ¼ë¡œ ë¶„ë¦¬ë˜ì—ˆë‹¤. ê·¸ë¦¬ê³  ì´ ì ì¬ìš”ì¸ì„ í†µí•´ ì–´ë–¤ ì˜í™”ê°€ ì–´ë–¤ userì˜ ê´€ì‹¬ì„ ëŒ ì§€ ì˜ˆìƒí•´ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;mf-ê¸°ë°˜-ì¶”ì²œ-ì•Œê³ ë¦¬ì¦˜-ê³¼ì •&quot;&gt;MF ê¸°ë°˜ ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ ê³¼ì •&lt;/h2&gt;
&lt;p&gt;Â &lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ ì£¼ì–´ì§„ user, itemì˜ ê´€ê³„ë¥¼ P, Që¡œ ì–´ë–»ê²Œ ë¶„í•´í•  ìˆ˜ ìˆì„ê¹Œ? Rì„ P, Që¡œ ë¶„í•´í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì„ ê°„ë‹¨íˆ ë‚˜íƒ€ë‚´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ì ì¬ìš”ì¸ ê°œìˆ˜ Kë¥¼ ì •í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ì£¼ì–´ì§„ Kì— ë”°ë¼ ì„ì˜ì˜ ìˆ˜ë¡œ ì´ˆê¸°í™”ëœ ë‘ í–‰ë ¬ P(m x k), Q(n x k)ë¥¼ ìƒì„±í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;P, Q í–‰ë ¬ì„ í†µí•´ ì˜ˆì¸¡ê°’ $R(=P x Q^{T})$ì„ êµ¬í•˜ê³  ì‹¤ì œ ê°’ê³¼ ë¹„êµí•˜ì—¬ ì˜¤ì°¨ë¥¼ ì¤„ì´ê¸° ìœ„í•´ P, Q ê°’ì„ ìˆ˜ì •í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ê¸°ì¤€ì— ë„ë‹¬í•  ë•Œê¹Œì§€ 3ì„ ë°˜ë³µí•œë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ì—¬ê¸°ì„œ ì˜¤ì°¨ë¥¼ ì¤„ì´ê¸° ìœ„í•´ì„œ P, Që¥¼ ìˆ˜ì •í•  ë•Œ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ í•˜ëŠ” ê°€ê°€ ì¤‘ìš”í•œ ì´ìŠˆì´ë‹¤. ì¼ë°˜ì ìœ¼ë¡œëŠ” ê¸°ê³„í•™ìŠµì—ì„œ ë§ì´ ì‚¬ìš©ë˜ëŠ” SGD(Stochastic Gradient Decent) ë°©ë²•ì„ ì ìš©í•œë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;sgdstochastic-gradient-decentë¥¼-ì‚¬ìš©í•œ-mf-ì•Œê³ ë¦¬ì¦˜&quot;&gt;SGD(Stochastic Gradient Decent)ë¥¼ ì‚¬ìš©í•œ MF ì•Œê³ ë¦¬ì¦˜&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;
Â 
SGD ë°©ë²•ì„ ì ìš©í•´ì„œ P, Q í–‰ë ¬ì„ ìµœì í™”í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì&lt;/p&gt;

&lt;h3 id=&quot;objective-function&quot;&gt;Objective Function&lt;/h3&gt;
&lt;p&gt;P, Që¥¼ í•™ìŠµí•  ë•Œ ì‚¬ìš©ë˜ëŠ” ëª©ì í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ì´ ëª©ì  í•¨ìˆ˜ëŠ” ë‘ê°€ì§€ í…€ìœ¼ë¡œ ë‚˜ë‰œë‹¤.&lt;/p&gt;
&lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/mf4.png&quot; /&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;ì˜¤ì°¨ ì œê³± í•©
    &lt;ul&gt;
      &lt;li&gt;ê¸°ì¤€ìœ¼ë¡œ ì•ì˜ í…€ì€ Squared Errorì´ë‹¤. ì‹¤ì œ í‰ì ê°’ê³¼ ì˜ˆì¸¡ í‰ì  ê°’ì˜ ì°¨ì´ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ì´ ë•Œ, &lt;strong&gt;í•™ìŠµ ë°ì´í„°ì—ì„œ ì‹¤ì œ í‰ì ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ ì˜¤ì°¨ë¥¼ ê³„ì‚°í•œë‹¤.&lt;/strong&gt; ì´ëŠ” SVDì™€ ë‹¤ë¥¸ ë¶€ë¶„ì¸ë° ë’¤ì— MF vs SVDì—ì„œ ì¢€ ë” ìì„¸íˆ ë‹¤ë£° ê²ƒì´ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ì •ê·œí™”
    &lt;ul&gt;
      &lt;li&gt;ë’¤ì˜ termì€ ê³¼ì í•©ì„ ë°©ì§€í•˜ëŠ” ì •ê·œí™” í…€ì´ë‹¤. ë‹¤ë¥¸ ê¸°ê³„í•™ìŠµê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ëª¨ë¸ì´ í•™ìŠµí•¨ì— ë”°ë¼ íŒŒë¼ë¯¸í„°ì˜ ê°’(weight)ì´ ì ì  ì»¤ì§€ëŠ” ë°, ì´ ê°’ì´ ë„ˆë¬´ ì»¤ì§€ê²Œ ë˜ë©´ í•™ìŠµ ë°ì´í„°ì— ê³¼ì í•©í•˜ê²Œ ëœë‹¤. ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•˜ì—¬, í•™ìŠµ íŒŒë¼ë¯¸í„°ì¸ p, qê°€ ë„ˆë¬´ ì»¤ì§€ì§€ ì•Šë„ë¡ ê·œì œë¥¼ í•´ì£¼ì–´ì•¼ í•œë‹¤. ì—¬ê¸°ì„œëŠ” L2 ì •ê·œí™”ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤. ëŒë‹¤ëŠ” ëª©ì  í•¨ìˆ˜ì— ì •ê·œí™” í…€ì˜ ì˜í–¥ë ¥ì„ ì–´ëŠ ì •ë„ë¡œ ì¤„ ê²ƒì¸ì§€ ì •í•˜ëŠ” í•˜ì´í¼ íŒŒë¼ë¯¸í„°ì´ë‹¤. ëŒë‹¤ê°€ ë„ˆë¬´ ì‘ìœ¼ë©´ ì •ê·œí™” íš¨ê³¼ê°€ ì ê³ , ë„ˆë¬´ í¬ë©´ íŒŒë¼ë¯¸í„°ê°€ ì œëŒ€ë¡œ í•™ìŠµë˜ì§€ ì•Šì•„ì„œ ì–¸ë”í”¼íŒ…(Underfitting)ì´ ë°œìƒí•œë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;optimazation-sgd&quot;&gt;Optimazation (SGD)&lt;/h3&gt;
&lt;p&gt;ë‹¤ë¦„ìœ¼ë¡œ ëª©ì í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” ìµœì í™” ê¸°ë²•ìœ¼ë¡œ SGD(Stochastic Gradient Descent)ì„ ì‚¬ìš©í•œë‹¤. SGDì—ì„œëŠ” íŒŒë¼ë¯¸í„° ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ëª©ì í•¨ìˆ˜ë¥¼ pì™€ që¡œ í¸ë¯¸ë¶„í•œë‹¤. ì•„ë˜ëŠ” í¸ë¯¸ë¶„ í•˜ëŠ” ìˆ˜ì‹ì„ ë³´ì—¬ì£¼ê³  ìˆê³ , ì´ë ‡ê²Œ ë„ì¶œëœ Gradientë¥¼ í˜„ì¬ íŒŒë¼ë¯¸í„° ê°’ì—ì„œ ë¹¼ì¤Œìœ¼ë¡œì¨ í•™ìŠµì„ ì§„í–‰í•˜ê²Œ ëœë‹¤.&lt;/p&gt;

&lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/mf6.png&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;mf-ìµœì -íŒŒë¼ë¯¸í„°-ì°¾ê¸°&quot;&gt;MF ìµœì  íŒŒë¼ë¯¸í„° ì°¾ê¸°&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;
Â 
ì‰½ê²Œ ì˜ˆìƒí•  ìˆ˜ ìˆë“¯ì´ ì ì¬ìš”ì¸ìˆ˜ Kì™€ iterationì— ë”°ë¼ ì˜ˆì¸¡ì˜ ì •í™•ë„ê°€ ë‹¬ë¼ì§ˆ ê²ƒì´ë‹¤. ìµœì ì˜ Kì™€ iterationì€ ë‹¤ìŒì˜ ë°©ë²•ìœ¼ë¡œ êµ¬í•´ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Kë¥¼ 50~260ê¹Œì§€ ë„“ì€ ë²”ìœ„ì—ì„œ 10ê°„ê²©ìœ¼ë¡œ RMSEë¥¼ ê³„ì‚°í•´ ìµœì ê°’ì„ ì°¾ëŠ”ë‹¤. ì´ ë•Œ, iterationìœ¼ë¡œ ì¶©ë¶„íˆ í° ìˆ˜ë¥¼ ì¤€ë‹¤.&lt;/li&gt;
  &lt;li&gt;ì°¾ì€ ìµœì ê°’ Kë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì´ ìˆ«ì ì „í›„ +- 10ê°’ì— ëŒ€í•˜ì—¬ ë” ì‘ì€ 1ì˜ ê°„ê²©ìœ¼ë¡œ ë‹¤ì‹œ RMSEê°’ì„ ê³„ì‚°í•´ Kì˜ ìµœì ê°’ì„ ì°¾ëŠ”ë‹¤.&lt;/li&gt;
  &lt;li&gt;Kë¥¼ ì°¾ì€ ìµœì ê°’ìœ¼ë¡œ ê³ ì • í›„ iterationsì˜ 1~300 ë²”ìœ„ì—ì„œ ì„¤ì •, ë°˜ë³µí•˜ì—¬ iterations ìµœì ê°’ì„ ì°¾ëŠ”ë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ì´ ë•Œ, train/test set ë¶„ë¦¬ì™€, SGD ì‹¤í–‰ ì‹œ ì ìš©ë˜ëŠ” ë‚œìˆ˜ì— ë”°ë¼ ê³„ì‚°ê°’ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì½”ë“œë¥¼ ì—¬ëŸ¬ë²ˆ ë°˜ë³µ ì‹¤í–‰ í›„ í‰ê· ê°’ìœ¼ë¡œ ìµœì ê°’ì„ ì„¤ì •í•´ì•¼ í•œë‹¤.&lt;/p&gt;

&lt;p&gt;Â &lt;/p&gt;
&lt;h2 id=&quot;mf-vs-svd&quot;&gt;MF vs SVD&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;
Â 
MFì™€ SVDëŠ” ëª¨ë‘ ë°ì´í„° ë¶„ì„ê³¼ ê¸°ê³„í•™ìŠµì— ë„ë¦¬ ì‚¬ìš©ë˜ê³  ìˆê³ , ìœ ì‚¬í•œ ì ì´ ë§ì•„ ì¶”ì²œì‹œìŠ¤í…œ ìš©ì–´ë¡œ ê°™ì€ ì˜ë¯¸ë¡œ ì‚¬ìš©ì´ ë˜ê³¤ í•œë‹¤.
ê²°ë¡ ë¶€í„° ë§í•˜ìë©´ ëª…ë°±íˆ ë‘˜ì€ ë‹¤ë¥¸ ê¸°ë²•ì´ê³ , ì‹¤ì œë¡œ SVDê¸°ë²•ì€ ì¶”ì²œì‹œìŠ¤í…œì—ì„œ ê±°ì˜ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.&lt;/p&gt;

&lt;p&gt;ë¨¼ì €, SVD ë°©ì‹ì—ì„œëŠ” í–‰ë ¬ì´ 3ê°œë¡œ ë¶„í• ë˜ì§€ë§Œ MF ë°©ì‹ì—ì„œëŠ” 2ê°œë¡œ ë¶„í•´ëœë‹¤.
ë˜í•œ, ì¶”ì²œì‹œìŠ¤í…œì˜ ë°ì´í„°ì…‹ì—ëŠ” ì‚¬ìš©ìê°€ í‰ê°€í•˜ì§€ ì•Šì€ null ê°’ì´ ë§ì´ ì¡´ì¬í•˜ëŠ”ë° MFì™€ SVDëŠ” ì´ nullê°’ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì—ì„œ ì°¨ì´ê°€ ë‚œë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;(3ê°œì˜ í–‰ë ¬ë¡œ ë¶„í•´ë˜ëŠ”) SVDë°©ì‹ì—ì„œëŠ” nullì„ ëŒ€ì²´í•œ 0ê°’ì´ í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ ì ìš©ë¼ì„œ í•™ìŠµ í›„ì—ë„ 0ì— ê·¼ì‚¬í•œ ì˜ˆì¸¡ê°’ì´ ë„ì¶œëœë‹¤.
ì¦‰, nullì— ëŒ€í•œ ì˜ˆì¸¡ì´ ì œëŒ€ë¡œ ì´ë£¨ì–´ì§€ì§€ ëª»í•œë‹¤.
    &lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/mf1.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;(2ê°œì˜ í–‰ë ¬ë¡œ ë¶„í•´ë˜ëŠ”) MFë°©ì‹ì€ ëª¨ë¸ì„ í•™ìŠµí•˜ëŠ” ê³¼ì •(SGD)ì—ì„œ null(0)ê°’ì„ ì œì™¸í•˜ê³  ê³„ì‚°í•˜ëŠ” êµ¬ì¡°ì´ë©°, ì´ë ‡ê²Œ í•™ìŠµëœ í–‰ë ¬ P,Që¥¼ í†µí•´ nullì— ëŒ€í•œ ì˜ˆì¸¡ë„ ì •í™•í•˜ê²Œ í•  ìˆ˜ ìˆë‹¤.
    &lt;div style=&quot;text-align: left&quot;&gt;
  &lt;img src=&quot;/assets/img/post_images/mf2.png&quot; width=&quot;100%&quot; /&gt;
&lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;
Â &lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;ì°¸ê³  ë‚´ìš© ì¶œì²˜ :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://sungkee-book.tistory.com/12&quot;&gt;https://sungkee-book.tistory.com/12&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;ì„ì¼, ã€Pythonì„ ì´ìš©í•œ ê°œì¸í™” ì¶”ì²œì‹œìŠ¤í…œã€, ì²­ëŒ(2020)&lt;/li&gt;
&lt;/ul&gt;</content>

      
      
      
      
      

      <author>
          <name>Beanie</name>
        
        
      </author>

      

      
        <category term="ì¶”ì²œì‹œìŠ¤í…œ" />
      

      
        <summary type="html">ì¶”ì²œì‹œìŠ¤í…œì˜ ê¸°ì´ˆì ì¸ ë‚´ìš©ì„ ì˜ ì•Œì§€ ëª»í•œì±„ë¡œ ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•˜ëŠ” ë…¼ë¬¸ë“¤ì„ ëª‡ê°œ ì½ë‹¤ë³´ë‹ˆ êµ¬í˜„ì˜ ê¸°ë°˜ì´ ë˜ëŠ” ì¤‘ìš”í•œ ì›ë¦¬ë¥¼ ê³„ì† ë†“ì¹˜ê³  ìˆëŠ” ë“¯í•œ ê¸°ë¶„ì´ ë“¤ì—ˆë‹¤. ê·¸ë˜ì„œ Pythonì„ ì´ìš©í•œ ê°œì¸í™” ì¶”ì²œì‹œìŠ¤í…œ ì±…ì„ ì‚¬ì„œ ì½ê³ , ë˜ ë‹¤ì–‘í•œ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ ë³´ë©° ì¶”ì²œì‹œìŠ¤í…œì— ëŒ€í•œ ê³µë¶€ë¥¼ ë” ê¹Šì´ í•´ë³´ì•˜ë‹¤.</summary>
      

      
      
    </entry>
  
</feed>
